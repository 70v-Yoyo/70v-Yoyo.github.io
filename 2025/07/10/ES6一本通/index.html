<!doctype html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    
    
    <title>ES6一本通 | Yoyo&#39;s blog</title>
    
    <link rel="alternative" href="/atom.xml" title="Yoyo&#39;s blog" type="application/atom+xml">
    
    
<link rel="stylesheet" href="/css/style.css">

    
    <link rel="stylesheet" href="/libs/fancybox/jquery.fancybox.css" charset="utf-8">
    
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
<!-- hexo injector head_end start --><script src="./func.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>
<body class="site">
    <!-- 遮罩层 -->
    <div id="mask-layer">
    </div>
    
    <header class="site-header">
        <h1 class="site-title"><a href="/">Yoyo&#39;s blog</a></h1>
        <nav class="site-nav">
            <ul class="nav">
                
                <li><a href="/">Home</a></li>
                
                <li><a href="/archives">Archives</a></li>
                
                
                <li><a href="/atom.xml" title="RSS Feed">rss</a></li>
                
                <li><a class="toggle-search" href="#search">search</a></li>
            </ul>
        </nav>
        <div class="site-search" id="search">
            <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="https://70v-yoyo.github.io"></form>
        </div>
        
            <div class="site-header-background" style="background-image:url('http://reumia.github.io/hexo-theme-zzoman2015/images/background-zzoman2015.jpg')"></div>
        
    </header>
    <div class="site-body">
        <div class="global-width">
    <article class="article" data-layout="post" data-slug="ES6一本通">
        <div class="article-content">
            
            
            <header class="article-header">
                <div class="article-meta">
                    <a href="/2025/07/10/ES6%E4%B8%80%E6%9C%AC%E9%80%9A/" class="article-date">
  <time datetime="2025-07-10T13:49:43.000Z">2025-07-10</time>
</a>
                    
                    
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/frontend/" rel="tag">frontend</a></li></ul>

                </div>
                
    <h1 class="article-title" itemprop="name">
      <a href="/2025/07/10/ES6%E4%B8%80%E6%9C%AC%E9%80%9A/">ES6一本通</a>
    </h1>

            </header>
            
            <div class="article-body">
                <meta name="referrer" content="no-referrer" />

<blockquote>
<p>版本：20250710</p>
</blockquote>
<ul>
<li>扩展<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41775119/article/details/147017825?fromshare=blogdetail&sharetype=blogdetail&sharerId=147017825&sharerefer=PC&sharesource=qq_41775119&sharefrom=from_link">ES6+（7～12）</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41775119/article/details/81843777?fromshare=blogdetail&sharetype=blogdetail&sharerId=81843777&sharerefer=PC&sharesource=qq_41775119&sharefrom=from_link">Math数字新增</a></li>
</ul>
<h1 id="变量声明（let、const、var）"><a href="#变量声明（let、const、var）" class="headerlink" title="变量声明（let、const、var）"></a>变量声明（let、const、var）</h1><ul>
<li>var 全局；let和const是块级作用域，仅在某一块有效。</li>
<li>const是常量不可改动其引用对象，既然是常量不能重新进行赋值，如果是基本数据类型，不能更改值，如果是复杂数据类型，不能更改地址值。const声明时必须赋值。</li>
<li>let 和 const 不存在变量提升，在赋值前不可访问-&gt;有“暂时性死区TDZ“<br><img src="/images/ES6%E4%B8%80%E6%9C%AC%E9%80%9A.assets/0828b2287c3442e589450bb4c3d95729.png" alt="在这里插入图片描述"></li>
</ul>
<h1 id="解构赋值Destructuring-Assignment"><a href="#解构赋值Destructuring-Assignment" class="headerlink" title="解构赋值Destructuring Assignment"></a>解构赋值Destructuring Assignment</h1><ul>
<li>如果解构不成功，变量跟数值个数不匹配的时候，变量的值为undefined。解构赋值解 undefined：数组解构允许、对象结构不允许、带默认值的解构允许</li>
<li>数组解构用中括号包裹，多个变量用逗号隔开，对象解构用花括号包裹，多个变量用逗号隔开</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [a, b = <span class="number">2</span>] = [<span class="number">1</span>]; <span class="comment">// a = 1, b = 2</span></span><br><span class="line"><span class="keyword">const</span> &#123; x, y &#125; = &#123; <span class="attr">x</span>: <span class="number">10</span>, <span class="attr">y</span>: <span class="number">20</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> x = <span class="number">1</span>, y = <span class="number">2</span>;</span><br><span class="line">[x, y] = [y, x]; <span class="comment">// 交换变量</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span>[a,b,c]=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> [, a, , b] = arr;</span><br><span class="line"></span><br><span class="line"><span class="comment">//JSON中的解构赋值 </span></span><br><span class="line"><span class="keyword">let</span> json=&#123;<span class="attr">name</span>:<span class="string">&#x27;a&#x27;</span>,<span class="attr">age</span>:<span class="number">18</span>&#125;; </span><br><span class="line"><span class="keyword">let</span> &#123;n,a&#125;=json;<span class="comment">//都是undefined </span></span><br><span class="line"><span class="keyword">let</span> &#123;name,age&#125;=json;<span class="comment">//必须名字对应上</span></span><br><span class="line"><span class="comment">//起别名</span></span><br><span class="line"> <span class="keyword">let</span> &#123;<span class="attr">name</span>: myName, <span class="attr">age</span>: myAge&#125; = json; <span class="comment">// myName myAge 属于别名</span></span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(myName); <span class="comment">// &#x27;a&#x27; </span></span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(myAge); <span class="comment">// 18</span></span><br><span class="line"><span class="comment">//对象解构</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">show</span>(<span class="params">&#123;x, y&#125;</span>) &#123;<span class="comment">//从传入的对象中提取 x 和 y 属性并将它们作为函数的局部变量使用</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(x, y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="模板字符串"><a href="#模板字符串" class="headerlink" title="模板字符串"></a>模板字符串</h1><ul>
<li>模板字符串和传统字符串拼接的区别？</li>
</ul>
<table>
<thead>
<tr>
<th>项目</th>
<th>传统字符串拼接</th>
<th>模板字符串</th>
</tr>
</thead>
<tbody><tr>
<td>引号</td>
<td>单引号 <code>&#39;</code> 或双引号 <code>&quot;</code></td>
<td>反引号</td>
</tr>
<tr>
<td>拼接方式</td>
<td>使用 <code>+</code> 拼接</td>
<td>使用 <code>$&#123;&#125;</code> 插值</td>
</tr>
<tr>
<td>多行字符串</td>
<td>需要手动加 <code>\n</code> 或 <code>+</code></td>
<td>支持直接换行</td>
</tr>
<tr>
<td>支持表达式</td>
<td>不直观</td>
<td>直接写表达式、函数、变量等<code>$&#123;func(a)&#125;</code></td>
</tr>
</tbody></table>
<h1 id="箭头函数（Arrow-Function）"><a href="#箭头函数（Arrow-Function）" class="headerlink" title="箭头函数（Arrow Function）"></a>箭头函数（Arrow Function）</h1><p>箭头函数属于表达式函数，因此不存在函数提升<br>箭头函数中没有 arguments，只能使用 … 动态获取实参<br>简化了函数表达式的写法，并且不绑定 this，即 this 始终指向定义时的上下文。<br>箭头函数不能当构造函数。</p>
<ul>
<li>箭头函数和普通函数有什么区别<br>箭头函数没有prototype，所以箭头函数本身没有this，使用new调用箭头函数会报错 <code>TypeError: fun is not a constructor</code>，不能当构造函数<br>箭头函数 没有自己的 this、arguments、super，箭头函数的this指向继承自外层，且不能通过 call&#x2F;bind&#x2F;apply 改变<br>不可以使用yield命令，因此箭头函数不能用作 Generator 函数。</li>
<li>call() 和 apply() 对箭头函数的影响<br>对于普通函数，call() 和 apply() 可以显式地改变 this 绑定。但对于箭头函数来说，不能改变</li>
<li>何时使用箭头函数<br>适用于回调函数，例如 setTimeout，避免 this 绑定错误<br>适用于类方法，防止 this 绑定丢失</li>
<li>优点<br>解决了this执行环境所造成的一些问题。比如：解决了匿名函数this指向的问题（匿名函数的执行环境具有全局性），包括setTimeout和setInterval中使用this所造成的问题<br>处理回调函数时特别有用，避免了this绑定问题。</li>
<li>箭头函数有两种格式。</li>
</ul>
<ol>
<li>只包含一个表达式，连{ … }和return都省略掉了。自动作为返回值被返回</li>
<li>可以包含多条语句，这时候就不能省略{ … }和return。如果参数不是一个，就需要用括号()括起来。</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">add</span> = (<span class="params">a, b</span>) =&gt; a + b;</span><br><span class="line"><span class="keyword">let</span> <span class="title function_">show</span>=(<span class="params">...args</span>)=&gt;&#123;</span><br><span class="line">    <span class="comment">//操作</span></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 两个参数:</span></span><br><span class="line">(x, y) =&gt; x * x + y * y</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 无参数:</span></span><br><span class="line">() =&gt; <span class="number">3.14</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// 可变参数:</span></span><br><span class="line">(x, y, ...rest) =&gt; &#123;</span><br><span class="line">    <span class="keyword">var</span> i, sum = x + y;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;rest.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        sum += [i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">如果要返回一个对象，就要注意，如果是单表达式，这么写的话会报错：</span><br><span class="line">x =&gt; &#123; <span class="attr">foo</span>: x &#125;</span><br><span class="line">正确写法：</span><br><span class="line">x =&gt; (&#123; <span class="attr">foo</span>: x &#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li>输出练习</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//例子1</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">    <span class="attr">value</span>: <span class="number">42</span>,</span><br><span class="line">    <span class="attr">getValue</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">obj.<span class="title function_">getValue</span>(); <span class="comment">// undefined，this 不是 obj，而是外层作用域的 this</span></span><br><span class="line">obj.<span class="property">getValue</span>.<span class="title function_">call</span>(&#123; <span class="attr">value</span>: <span class="number">100</span> &#125;); <span class="comment">// 仍然是 undefined，call() 无法改变 this</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//例子2</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">outer</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">arrowFunc</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>); <span class="comment">// 取决于 outer() 调用时的 this</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="title function_">arrowFunc</span>();</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> obj1 = &#123; <span class="attr">method</span>: outer &#125;;</span><br><span class="line">obj1.<span class="title function_">method</span>(); <span class="comment">// this 是 obj1</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> obj2 = &#123; <span class="attr">method</span>: outer.<span class="title function_">bind</span>(&#123; <span class="attr">x</span>: <span class="number">1</span> &#125;) &#125;;</span><br><span class="line">obj2.<span class="title function_">method</span>(); <span class="comment">// this 是 &#123; x: 1 &#125;，但箭头函数内的 this 仍然是 obj2.method() 调用时的 this</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//例子3</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1990</span>,</span><br><span class="line">    <span class="attr">getAge</span>: <span class="keyword">function</span> (<span class="params">year</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> b = <span class="variable language_">this</span>.<span class="property">birth</span>; <span class="comment">// 1990</span></span><br><span class="line">        <span class="keyword">var</span> <span class="title function_">fn</span> = (<span class="params">y</span>) =&gt; y - <span class="variable language_">this</span>.<span class="property">birth</span>; <span class="comment">// this.birth仍是1990</span></span><br><span class="line">        <span class="keyword">return</span> fn.<span class="title function_">call</span>(&#123;<span class="attr">birth</span>:<span class="number">2000</span>&#125;, year);<span class="comment">//2015-1990</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">obj.<span class="title function_">getAge</span>(<span class="number">2015</span>); <span class="comment">// 25</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//例子4</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">name</span>: <span class="string">&#x27;张三&#x27;</span>&#125; </span><br><span class="line"> <span class="keyword">function</span> <span class="title function_">fn</span> (<span class="params"></span>) &#123; </span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>);<span class="comment">//this 指向 是obj对象</span></span><br><span class="line">     <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123; </span><br><span class="line">         <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>);</span><br><span class="line"><span class="comment">//this 指向 的是箭头函数定义的位置，</span></span><br><span class="line"><span class="comment">//那么这个箭头函数定义在fn里面，而这个fn指向是的obj对象，所以这个this也指向是obj对象</span></span><br><span class="line">     &#125; </span><br><span class="line"> &#125; </span><br><span class="line"> <span class="keyword">const</span> resFn = fn.<span class="title function_">call</span>(obj); </span><br><span class="line"> <span class="title function_">resFn</span>();</span><br></pre></td></tr></table></figure>
<h1 id="默认参数-剩余参数-扩展运算符（…）"><a href="#默认参数-剩余参数-扩展运算符（…）" class="headerlink" title="默认参数 &amp; 剩余参数 &amp; 扩展运算符（…）"></a>默认参数 &amp; 剩余参数 &amp; 扩展运算符（…）</h1><p>ES6中，函数也可以给默认参数了</p>
<ul>
<li><code>...args</code> 是什么？与 arguments 区别？<br><code>...args </code>是 剩余参数（rest parameters） 的语法，是 ES6 引入的标准，用于收集函数的多余参数为一个数组。它与传统的 arguments 类似，但更强大、更灵活。</li>
</ul>
<table>
<thead>
<tr>
<th>对比点</th>
<th><code>...args</code></th>
<th><code>arguments</code></th>
</tr>
</thead>
<tbody><tr>
<td>类型</td>
<td>真正的数组 <code>Array</code></td>
<td>类数组对象（非真正数组）</td>
</tr>
<tr>
<td>是否可用于箭头函数</td>
<td>✅ 可用</td>
<td>❌ 不可用</td>
</tr>
<tr>
<td>是否支持解构、数组方法</td>
<td>✅ 支持（如 <code>map</code>, <code>reduce</code>）</td>
<td>❌ 不支持直接用数组方法</td>
</tr>
<tr>
<td>是否明确命名</td>
<td>✅ 参数名明确（如 args）</td>
<td>❌ 不明确，只有 <code>arguments</code></td>
</tr>
<tr>
<td>可读性</td>
<td>✅ 好</td>
<td>❌ 较差</td>
</tr>
</tbody></table>
<ul>
<li>扩展运算符Spread &amp; Rest<br>如果传入的参数连正常定义的参数都没填满，最后的扩展参数会接收一个空数组（注意不是undefined），但固定的参数如果没传会是undefined<ul>
<li>作用<br>合并、复制数组、传参数组<br>参数收集、解构<br>合并、复制对象<br>字符串展开为数组</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 扩展数组</span></span><br><span class="line"><span class="keyword">const</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line"><span class="keyword">const</span> arr2 = [...arr1, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 扩展对象</span></span><br><span class="line"><span class="keyword">const</span> obj1 = &#123; <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> obj2 = &#123; ...obj1, <span class="attr">age</span>: <span class="number">25</span> &#125;;<span class="comment">//添加属性</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> state = &#123; <span class="attr">count</span>: <span class="number">5</span>, <span class="attr">name</span>: <span class="string">&quot;Alice&quot;</span> &#125;;</span><br><span class="line">state= &#123; ...state, <span class="attr">count</span>: <span class="number">10</span> &#125;<span class="comment">//覆盖原同名属性</span></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="comment">// Rest 参数（收集函数的剩余参数）</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sum</span>(<span class="params">...numbers</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> numbers.<span class="title function_">reduce</span>(<span class="function">(<span class="params">acc, num</span>) =&gt;</span> acc + num, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">onload</span>=<span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">let</span> aLi = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;ul li&#x27;</span>);</span><br><span class="line">	<span class="keyword">let</span> arrLi = [...aLi];<span class="comment">//可以把ul li转变为数组</span></span><br><span class="line">	arrLi.<span class="title function_">pop</span>();</span><br><span class="line"> 	arrLi.<span class="title function_">push</span>(<span class="string">&#x27;asfasdf&#x27;</span>);</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(arrLi);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params">a, b, ...rest</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;a = &#x27;</span> + a);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;b = &#x27;</span> + b);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(rest);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="title function_">foo</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line"><span class="comment">// 结果:</span></span><br><span class="line"><span class="comment">// a = 1</span></span><br><span class="line"><span class="comment">// b = 2</span></span><br><span class="line"><span class="comment">// Array [ 3, 4, 5 ]</span></span><br><span class="line"> </span><br><span class="line"><span class="title function_">foo</span>(<span class="number">1</span>);</span><br><span class="line"><span class="comment">// 结果:</span></span><br><span class="line"><span class="comment">// a = 1</span></span><br><span class="line"><span class="comment">// b = undefined</span></span><br><span class="line"><span class="comment">// Array []</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> students = [<span class="string">&#x27;wangwu&#x27;</span>, <span class="string">&#x27;zhangsan&#x27;</span>, <span class="string">&#x27;lisi&#x27;</span>];</span><br><span class="line"><span class="keyword">let</span> [s1, ...s2] = students; </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s1);  <span class="comment">// &#x27;wangwu&#x27; </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s2);  <span class="comment">// [&#x27;zhangsan&#x27;, &#x27;lisi&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//扩展运算符可以将数组或者对象转为用逗号分隔的参数序列</span></span><br><span class="line"> <span class="keyword">let</span> ary = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"> ...ary  <span class="comment">// 1, 2, 3</span></span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(...ary);    <span class="comment">// 1 2 3,相当于下面的代码</span></span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">//扩展运算符可以应用于合并数组</span></span><br><span class="line"><span class="comment">// 方法一 </span></span><br><span class="line"> <span class="keyword">let</span> ary1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"> <span class="keyword">let</span> ary2 = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"> <span class="keyword">let</span> ary3 = [...ary1, ...ary2];</span><br><span class="line"> <span class="comment">// 方法二 </span></span><br><span class="line"> ary1.<span class="title function_">push</span>(...ary2);</span><br><span class="line"> </span><br><span class="line"><span class="comment">//将类数组或可遍历对象转换为真正的数组</span></span><br><span class="line"><span class="keyword">let</span> oDivs = <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;div&#x27;</span>); </span><br><span class="line">oDivs = [...oDivs];</span><br></pre></td></tr></table></figure>
<h1 id="对象字面量增强"><a href="#对象字面量增强" class="headerlink" title="对象字面量增强"></a>对象字面量增强</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> name = <span class="string">&#x27;Bob&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> person = &#123;</span><br><span class="line">  name,           <span class="comment">// 属性简写</span></span><br><span class="line">  <span class="title function_">greet</span>(<span class="params"></span>) &#123; ... &#125; <span class="comment">// 方法简写</span></span><br><span class="line">  <span class="comment">//只是省略了 function 关键字和冒号 :，更清爽。</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h1 id="Symbol"><a href="#Symbol" class="headerlink" title="Symbol"></a>Symbol</h1><ul>
<li>定义<br>原本数据类型有 number、string、boolean、null、undefined，增加symbol<br>Symbol 是一种新的原始数据类型，通常用于对象属性的唯一标识，避免命名冲突。symbol不可以new，symbol()返回的是一个唯一值。</li>
<li>作用<br>用作对象属性名，唯一性，防止属性冲突</li>
<li>Symbol 如何作为对象属性？</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> key = <span class="title class_">Symbol</span>(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> obj = &#123; [key]: <span class="number">123</span> &#125;;</span><br></pre></td></tr></table></figure>
<h1 id="Set-和-Map"><a href="#Set-和-Map" class="headerlink" title="Set 和 Map"></a>Set 和 Map</h1><p>Set 是一个无重复元素的集合，Map 是一个键值对集合（类似于Object）。</p>
<ul>
<li>Set 与 Array 区别？去重？</li>
</ul>
<table>
<thead>
<tr>
<th>特性</th>
<th><code>Array</code></th>
<th><code>Set</code></th>
</tr>
</thead>
<tbody><tr>
<td>是否允许重复值</td>
<td>✅ 允许</td>
<td>❌ 不允许</td>
</tr>
<tr>
<td>是否有顺序</td>
<td>✅ 有顺序（按插入顺序）</td>
<td>✅ 有顺序（按插入顺序）</td>
</tr>
<tr>
<td>支持索引访问</td>
<td>✅ <code>arr[0]</code> 可访问</td>
<td>❌ 不支持 <code>set[0]</code>     Set 没有索引</td>
</tr>
<tr>
<td>数据结构</td>
<td>有序列表</td>
<td>唯一集合</td>
</tr>
<tr>
<td>是否可遍历</td>
<td>✅ 支持</td>
<td>✅ 支持</td>
</tr>
<tr>
<td>去重能力</td>
<td>❌ 需要手动处理</td>
<td>✅ 自动去重</td>
</tr>
</tbody></table>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//set array互相转换</span></span><br><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">const</span> unique = [...<span class="keyword">new</span> <span class="title class_">Set</span>(arr)]; <span class="comment">// ✅ 数组去重</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(unique); <span class="comment">// [1, 2, 3]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> set = <span class="keyword">new</span> <span class="title class_">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</span><br><span class="line"><span class="keyword">const</span> backToArray = <span class="title class_">Array</span>.<span class="title function_">from</span>(set); <span class="comment">// ✅ Set 转数组</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Map 与 Object 有何不同？</li>
</ul>
<table>
<thead>
<tr>
<th>特性</th>
<th><code>Object</code></th>
<th><code>Map</code></th>
</tr>
</thead>
<tbody><tr>
<td>键的类型支持</td>
<td>只能是字符串或 Symbol</td>
<td>任意类型（对象、函数、数字等）</td>
</tr>
<tr>
<td>是否有原型链</td>
<td>有，默认继承自 <code>Object</code></td>
<td>没有原型，纯净键值对</td>
</tr>
<tr>
<td>键的顺序</td>
<td>无保障，按照插入顺序可能乱</td>
<td>✅ 按插入顺序保存</td>
</tr>
<tr>
<td>获取长度</td>
<td>需 <code>Object.keys().length</code></td>
<td><code>map.size</code></td>
</tr>
<tr>
<td>是否可迭代</td>
<td>❌ 不能直接 <code>for...of</code></td>
<td>✅ 可直接 <code>for...of</code></td>
</tr>
<tr>
<td>适合频繁增删</td>
<td>❌ 效率低</td>
<td>✅ 性能更优</td>
</tr>
<tr>
<td>是否用于 JSON 数据</td>
<td>✅ 常用于结构化数据</td>
<td>❌ 不能直接序列化</td>
</tr>
</tbody></table>
<ul>
<li>Map v.s. Set<br>它们好多方法都一样。除了set get</li>
</ul>
<table>
<thead>
<tr>
<th>特性</th>
<th><code>Map</code></th>
<th><code>Set</code></th>
</tr>
</thead>
<tbody><tr>
<td>结构</td>
<td>键值对（key &#x3D;&gt; value）</td>
<td>值的集合（value）</td>
</tr>
<tr>
<td>是否唯一</td>
<td>key 唯一</td>
<td>所有值唯一</td>
</tr>
<tr>
<td>是否可迭代</td>
<td>✅ 是（按插入顺序）</td>
<td>✅ 是（按插入顺序）</td>
</tr>
<tr>
<td>常见用途</td>
<td>存储需要<strong>键值对</strong>的数据</td>
<td>存储<strong>去重的值</strong></td>
</tr>
<tr>
<td>键的类型</td>
<td>任意类型（对象、函数都行）</td>
<td>值本身是唯一的，无键</td>
</tr>
<tr>
<td>方法</td>
<td><code>set()</code>, <code>get()</code>, <code>has()</code>, <code>delete()</code>, <code>clear()</code></td>
<td><code>add()</code>, <code>has()</code>, <code>delete()</code>, <code>clear()</code></td>
</tr>
</tbody></table>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> set = <span class="keyword">new</span> <span class="title class_">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>]);  <span class="comment">// &#123; 1, 2, 3 &#125; 重复的只显示一个</span></span><br><span class="line"><span class="comment">//set中的元素可以是任何可迭代对象 如数组、字符串、Map、Set</span></span><br><span class="line"><span class="keyword">let</span> str = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="title class_">Set</span>(str);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(set);  <span class="comment">// Set &#123; &#x27;h&#x27;, &#x27;e&#x27;, &#x27;l&#x27;, &#x27;o&#x27; &#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="title class_">Map</span>([</span><br><span class="line">  [<span class="string">&quot;a&quot;</span>, <span class="number">1</span>],</span><br><span class="line">  [<span class="string">&quot;b&quot;</span>, <span class="number">2</span>],</span><br><span class="line">  [<span class="string">&quot;c&quot;</span>, <span class="number">3</span>]</span><br><span class="line">]);</span><br><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="title class_">Set</span>(map);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(set);  <span class="comment">// Set &#123; [&#x27;a&#x27;, 1], [&#x27;b&#x27;, 2], [&#x27;c&#x27;, 3] &#125;</span></span><br><span class="line"> </span><br><span class="line">set.<span class="title function_">add</span>(<span class="number">5</span>);</span><br><span class="line">set.<span class="title function_">delete</span>(<span class="number">1</span>);</span><br><span class="line">set.<span class="title function_">has</span>(<span class="number">2</span>) <span class="comment">//是否有这个值在set中 返回布尔值</span></span><br><span class="line">set.<span class="property">size</span></span><br><span class="line">set.<span class="title function_">clear</span>()<span class="comment">//清除所有成员 无返回值</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//Set 结构的实例与数组一样，也拥有forEach方法，用于对每个成员执行某种操作，没有返回值。</span></span><br><span class="line">s.<span class="title function_">forEach</span>(<span class="function"><span class="params">value</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(value))</span><br><span class="line"> </span><br><span class="line"><span class="comment">//set也有这些方法</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> item <span class="keyword">of</span> setArr)&#123;<span class="comment">//默认就是value</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(item);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> item <span class="keyword">of</span> setArr.<span class="title function_">keys</span>())&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(item);&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> item <span class="keyword">of</span> setArr.<span class="title function_">values</span>())&#123;&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> [k,v] <span class="keyword">of</span> setArr.<span class="title function_">entries</span>())&#123;&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">let</span> new_Set=[...set]<span class="comment">//让set转为数组</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//类数组都有的特性 filter 是true的才留下</span></span><br><span class="line">set = <span class="keyword">new</span> <span class="title class_">Set</span>([...set].<span class="title function_">filter</span>(<span class="function"><span class="params">val</span>=&gt;</span>val%<span class="number">2</span>==<span class="number">0</span>));</span><br><span class="line"> </span><br><span class="line"><span class="comment">//--------------</span></span><br><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="title class_">Map</span>([[<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>], [<span class="string">&#x27;b&#x27;</span>, <span class="number">2</span>]]);</span><br><span class="line"><span class="keyword">const</span> userMap = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line">userMap.<span class="title function_">set</span>(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;Alice&#x27;</span>);</span><br><span class="line">userMap.<span class="title function_">set</span>(<span class="string">&#x27;age&#x27;</span>, <span class="number">30</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(userMap.<span class="title function_">get</span>(<span class="string">&#x27;name&#x27;</span>)); <span class="comment">// &#x27;Alice&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(userMap.<span class="title function_">has</span>(<span class="string">&#x27;age&#x27;</span>));  <span class="comment">// true</span></span><br><span class="line">userMap.<span class="title function_">delete</span>(<span class="string">&#x27;age&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(userMap.<span class="property">size</span>);        <span class="comment">// 1</span></span><br><span class="line">userMap.<span class="title function_">clear</span>();                  <span class="comment">// 清空所有键值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. for...of</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> [key, value] <span class="keyword">of</span> map) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(key, value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. forEach</span></span><br><span class="line">map.<span class="title function_">forEach</span>(<span class="function">(<span class="params">value, key</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(key, value);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 获取键、值、键值对</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>([...map.<span class="title function_">keys</span>()]);   <span class="comment">// [&#x27;a&#x27;, &#x27;b&#x27;]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>([...map.<span class="title function_">values</span>()]); <span class="comment">// [1, 2]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>([...map.<span class="title function_">entries</span>()]); <span class="comment">// [[&#x27;a&#x27;, 1], [&#x27;b&#x27;, 2]]</span></span><br></pre></td></tr></table></figure>
<h1 id="Promise（异步编程）"><a href="#Promise（异步编程）" class="headerlink" title="Promise（异步编程）"></a>Promise（异步编程）</h1><p>Promise 是 ES6 引入的一种解决异步问题的方式，能够更优雅地处理异步任务和错误。<br>Promise是一个构造函数，代表一个异步操作。调用<code>.then(成功的回调函数，失败的回调函数)</code>方法时，成功的回调函数是必选的、失败的回调函数是可选的。<br>如果上一个 .then() 方法中返回了一个新的 Promise 实例对象，则可以通过下一个 .then() 继续进行处理。</p>
<ul>
<li>优点：<br>解决了回调函数带来的回调地狱问题。<br>链式调用使得异步操作更加简洁、可读。<br>提供了统一的错误处理机制（.catch()）。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//回调地狱 嵌套多层</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">            <span class="comment">//....continue...</span></span><br><span class="line">        &#125;,<span class="number">3000</span>)</span><br><span class="line">    &#125;,<span class="number">2000</span>)</span><br><span class="line">&#125;,<span class="number">1000</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>缺点：比回调函数稍微复杂一些，需要一定的学习成本。</li>
<li>Promise 的三种状态？<br>pending（待定）、fulfilled（已完成）和 rejected（已拒绝）。</li>
<li>.then()、.catch()、.finally() 的执行顺序？<br>成功时.then()-&gt;finally()<br>失败时.catch()-&gt;finally()<br>finally()始终最后执行</li>
<li>async&#x2F;await 如何配合 Promise 使用？<br>await所在的函数加async，await 后面必须是一个 Promise（或类 Promise 对象）<br> try…catch 捕获 Promise 的 reject<br> async 函数本身也返回 Promise</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getError</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">_, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">reject</span>(<span class="string">&#x27;出错了&#x27;</span>), <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fetchWithError</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getError</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;捕获错误:&#x27;</span>, err); <span class="comment">// 输出：捕获错误: 出错了</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>)&#123;</span><br><span class="line"><span class="comment">//将现有的东西，转成一个promise对象，有resolve成功状态；reject失败状态</span></span><br><span class="line">	<span class="keyword">if</span>(a==<span class="number">10</span>)&#123;</span><br><span class="line">		<span class="title function_">resolve</span>(<span class="string">&#x27;成功&#x27;</span>);</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="title function_">reject</span>(<span class="string">&#x27;失败鸟&#x27;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//promise.then(success, fail);</span></span><br><span class="line">promise.<span class="title function_">then</span>(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">&#125;,<span class="function"><span class="params">err</span>=&gt;</span>&#123;     <span class="comment">//err可以省略不写 也可以改成catch</span></span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">&#125;)</span><br><span class="line">promise.<span class="title function_">then</span>(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">&#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">err</span>=&gt;</span>&#123;  <span class="comment">//reject,发生错误，别名</span></span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li>批量处理promise<br>Promise.all([p1, p2, p3]):  并行执行异步任务。把promise打包，扔到一个数组里面，打包完还是一个promise对象。必须确保，所有的promise对象，都是resolve状态，都是成功状态<br>Promise.race([p1, p2, p3]): 只要有一个成功，就返回</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="string">&#x27;aaaa&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> p2 = <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="string">&#x27;bbbb&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> p3 = <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="string">&#x27;cccc&#x27;</span>);</span><br><span class="line"> </span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">all</span>([p1,p2,p3]).<span class="title function_">then</span>(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">	<span class="comment">//console.log(res);</span></span><br><span class="line">	<span class="keyword">let</span> [res1, res2, res3] = res;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(res1, res2, res3);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> promiseArr=[<span class="comment">//数组中promise实例哪个先执行完 就返回哪个结果</span></span><br><span class="line">    fs.<span class="title function_">readFile</span>(<span class="string">&#x27;./1.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>),</span><br><span class="line">    fs.<span class="title function_">readFile</span>(<span class="string">&#x27;./2.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>),</span><br><span class="line">    fs.<span class="title function_">readFile</span>(<span class="string">&#x27;./3.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>),</span><br><span class="line">]</span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">race</span>(promiseArr)</span><br><span class="line">.<span class="title function_">then</span>(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">&#125;)</span><br><span class="line">.<span class="title function_">catch</span>(<span class="function"><span class="params">err</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="类（class）和继承"><a href="#类（class）和继承" class="headerlink" title="类（class）和继承"></a>类（class）和继承</h1><ul>
<li>class 与构造函数的区别？<br>相同点<br>都可以创建实例对象；<br>实例通过 new 创建；<br>实例上的属性是构造函数内部 this 定义的；<br>共享方法都挂载在 prototype 上；<br>都可以继承（但 class 更方便）；</li>
</ul>
<table>
<thead>
<tr>
<th>对比点</th>
<th>构造函数（Function）</th>
<th>Class（类）</th>
</tr>
</thead>
<tbody><tr>
<td>语法可读性</td>
<td>较低</td>
<td>更清晰、接近传统面向对象</td>
</tr>
<tr>
<td>原型方法定义</td>
<td>手动挂载在 prototype 上</td>
<td>自动添加到 prototype</td>
</tr>
<tr>
<td>严格模式</td>
<td>默认非严格模式</td>
<td><strong>自动使用严格模式</strong>，不能被提升</td>
</tr>
<tr>
<td>构造函数调用</td>
<td>可以不加 <code>new</code>（但会出错）</td>
<td><strong>必须使用 <code>new</code> 调用</strong></td>
</tr>
<tr>
<td>类体方法枚举性</td>
<td>自定义方法默认可枚举</td>
<td>类中方法默认不可枚举</td>
</tr>
<tr>
<td>静态方法</td>
<td>需要手动挂载</td>
<td>使用 <code>static</code> 定义更方便</td>
</tr>
<tr>
<td>类本身</td>
<td>是语法糖，本质还是函数</td>
<td>本质是 <code>function</code></td>
</tr>
<tr>
<td>继承</td>
<td>借用 <code>call</code> 或 <code>Object.create</code></td>
<td>使用 <code>extends</code> 更优雅</td>
</tr>
</tbody></table>
<ul>
<li>构造函数首字母应当大写，而普通函数首字母应当小写，一些语法检查工具如jslint将可以帮你检测到漏写的new</li>
<li>ES6 引入面向对象编程的语法糖，使用 class 关键字来定义类，简化传统方法。class的定义包含构造函数constructor，避免手动继承（操作原型链）Student.prototype.hello &#x3D; function () {…}这样分散的代码。<br>用关键字new来调用构造函数，并返回一个对象。它绑定的this指向新创建的对象，并默认返回this，也就是说，不需要在最后写return this;用new 创建的对象还从原型上获得constructor属性，它指向构造函数</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xiaoming.<span class="property">constructor</span> === <span class="title class_">Student</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span>; <span class="comment">// true</span></span><br><span class="line"><span class="title class_">Student</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> === <span class="title class_">Student</span>; <span class="comment">// true</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(xiaoming) === <span class="title class_">Student</span>.<span class="property"><span class="keyword">prototype</span></span>; <span class="comment">// true</span></span><br><span class="line">xiaoming <span class="keyword">instanceof</span> <span class="title class_">Student</span>; <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<ul>
<li>ES6 中的 class 是没有提升功能的，而在 ES5 中，使用函数模拟的类是有“提升”效果的。即class 并没有函数提升的特性，这意味着类声明必须在使用之前声明。如果在类 person 定义之前访问它，会抛出 ReferenceError 错误。这是因为 ES6 的 class 声明是 块级作用域，并且没有提升。<br>在 ES5 中，我们通常使用构造函数模拟类，而 JavaScript 中的函数声明是有提升的（hoisting），函数声明会提升到作用域顶部，所以可以在函数声明之前调用它。</li>
<li>静态方法 在方法前面加static，不需要创建实例，直接调用类.类方法，class_name.static_func()</li>
<li>继承：新方法 子类extends父类</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">//父类</span></span><br><span class="line">        <span class="keyword">class</span> <span class="title class_">Person</span>&#123;</span><br><span class="line">            <span class="title function_">constructor</span>(<span class="params">name</span>)&#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="title function_">showName</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">`名字为: <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//子类</span></span><br><span class="line">        <span class="keyword">class</span> <span class="title class_">Student</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Person</span>&#123;</span><br><span class="line">            <span class="title function_">constructor</span>(<span class="params">name,skill</span>)&#123;<span class="comment">//别忘了加上参数</span></span><br><span class="line">                <span class="variable language_">super</span>(name);</span><br><span class="line"><span class="comment">//扩展子类而不是覆盖对应函数时，必须super（）把父类对应函数拉过来 </span></span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">skill</span> = skill;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="title function_">showSkill</span>(<span class="params"></span>)&#123;</span><br><span class="line">            	<span class="variable language_">super</span>.<span class="title function_">showSkill</span>(); <span class="comment">//父级的同名方法执行</span></span><br><span class="line">                <span class="keyword">return</span>  <span class="string">`哥们儿的技能为: <span class="subst">$&#123;<span class="variable language_">this</span>.skill&#125;</span>`</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//调用</span></span><br><span class="line">        <span class="keyword">let</span> stu1 = <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&#x27;Strive&#x27;</span>,<span class="string">&#x27;逃学&#x27;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(stu1.<span class="title function_">showSkill</span>());</span><br><span class="line">        </span><br><span class="line"><span class="keyword">let</span> a = <span class="string">&#x27;strive&#x27;</span>;</span><br><span class="line"><span class="keyword">let</span> b = <span class="string">&#x27;method&#x27;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;<span class="comment">//ES6 class</span></span><br><span class="line"><span class="comment">//注意首字母大写！！</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">greet</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, I&#x27;m <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">// 计算属性名（computed property names）在 ES6 中动态创建对象的属性或方法名。</span></span><br><span class="line"><span class="comment">//[a + b] 这种语法可以通过表达式来计算属性名或方法名。</span></span><br><span class="line">  [a + b]() &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;This is a dynamic method!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//get 和 set 是用于定义**属性访问器（accessor properties）**的关键字。</span></span><br><span class="line"><span class="comment">//通过这两个方法，可以自定义属性的获取（getter）和设置（setter）行为。</span></span><br><span class="line"><span class="comment">//Getter：用来获取属性的值。</span></span><br><span class="line"><span class="comment">//Setter：用来设置属性的值。</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">使用 getter 和 setter 的优点：</span></span><br><span class="line"><span class="comment">你可以在设置属性时，加入额外的逻辑，例如数据验证、格式化等。</span></span><br><span class="line"><span class="comment">获取属性时，你可以动态计算或处理值，而不需要暴露复杂的内部逻辑。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// Getter: 获取_name的值，通过 person.name 的方式访问，实际上调用的是 get name() 方法。</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">name</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_name</span>;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// Setter: 设置_name的值，通过 person.name = &#x27;newName&#x27; 的方式调用，实际上会触发 set name(value) 方法</span></span><br><span class="line">  <span class="keyword">set</span> <span class="title function_">name</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (value.<span class="property">length</span> &lt; <span class="number">3</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Name must be at least 3 characters long.&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">_name</span> = value;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> p = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&#x27;Alice&#x27;</span>, <span class="number">25</span>);</span><br><span class="line">p.<span class="title function_">greet</span>();</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name, age</span>)&#123;<span class="comment">//ES5 模拟类的函数</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="variable language_">this</span>.<span class="property">name</span> = name;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="variable language_">this</span>.<span class="property">age</span> = age;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">/* Person.prototype.showName = function()&#123;</span></span></span></span><br><span class="line"><span class="comment"><span class="language-javascript"><span class="language-xml">            return `名字为: $&#123;this.name&#125;`;</span></span></span></span><br><span class="line"><span class="comment"><span class="language-javascript"><span class="language-xml">        &#125;;</span></span></span></span><br><span class="line"><span class="comment"><span class="language-javascript"><span class="language-xml">        Person.prototype.showAge = function()&#123;</span></span></span></span><br><span class="line"><span class="comment"><span class="language-javascript"><span class="language-xml">            return `年龄为: $&#123;this.age&#125;`;</span></span></span></span><br><span class="line"><span class="comment"><span class="language-javascript"><span class="language-xml">        &#125;; */</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="comment">//新旧版对比</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="title class_">Object</span>.<span class="title function_">assign</span>(<span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>,&#123; <span class="comment">//assign 合并</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="title function_">showName</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="keyword">return</span> <span class="string">`名字为: <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="title function_">showAge</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="keyword">return</span> <span class="string">`年龄为: <span class="subst">$&#123;<span class="variable language_">this</span>.age&#125;</span>`</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&#x27;Strive&#x27;</span>, <span class="number">18</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">console</span>.<span class="title function_">log</span>(p1.<span class="title function_">showName</span>());</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">console</span>.<span class="title function_">log</span>(p1.<span class="title function_">showAge</span>());</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		  <span class="comment">//父类</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="variable language_">this</span>.<span class="property">name</span> = name;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">showName</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="keyword">return</span> <span class="string">`名字是: <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//子类</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">function</span> <span class="title function_">Student</span>(<span class="params">name,skill</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="title class_">Person</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>,name); <span class="comment">//继承属性  //使用矫正this函数</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="variable language_">this</span>.<span class="property">skill</span> = skill;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="title class_">Student</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title class_">Person</span>(); <span class="comment">//继承方法</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//调用</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">let</span> stu1 = <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&#x27;Strive&#x27;</span>,<span class="string">&#x27;逃学&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">console</span>.<span class="title function_">log</span>(stu1.<span class="title function_">showName</span>());</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<h1 id="模块化（ES-Modules）"><a href="#模块化（ES-Modules）" class="headerlink" title="模块化（ES Modules）"></a>模块化（ES Modules）</h1><ul>
<li>CommonJS 适用于服务器端的 Javascript 模块化。nodejs默认支持CommonJS模块化规范，如果想在nodejs中体验ES6模块化规范，需要按照以下步骤配置：确保安装v14.15.1及+版本的nodejs，在package.json根节点中添加”type”:”module”节点</li>
<li>ES Module v.s. CommonJS<br>相同点：都是模块化规范，导入导出模块<br>不同点：<br>CommonJS出现在ES6前，不支持动态导入，运行时加载，同步加载模块。导出的是值的拷贝，导入模块执行完后模块内部的变化不会影响外部。导出用<code>module.exports or exports</code>，导入用<code>require</code>。适用于服务端nodeJS。共享模块内的变量。<br>ES Module ES6引入，支持动态引入，编译时加载，异步加载模块。导出的是值的引用，外部和内部时刻保持一致变化。适用于浏览器。<code>export and import</code>。顶层this是undefined在严格模式下运行，每个模块有各自的顶层作用域，内部变量不会全局共享。有利于前端代码拆分、懒加载优化性能、静态分析Tree Shaking。</li>
<li>ES6模块化规范<br>ES6 模块化规范是浏览器端与服务器端通用的模块化开发规范。降低前端开发者的模块化学习成本，不需再额外学习 AMD、CMD 或 CommonJS 等模块化规范。<br>规范：<br>⚫ 每个 js 文件都是独立模块<br>⚫ 导入其它模块成员使用 import 关键字；有提升效果，import会自动提升到顶部，首先执行，不管放前面放后面都最先引入<br>无论导入多少次 都只导入一次<br>⚫ 向外共享模块成员使用 export 关键字</li>
</ul>
<ol>
<li>默认导出&#x2F;导入<br>注意：每个模块只允许一次export default否则报错</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;<span class="comment">//默认导出</span></span><br><span class="line">    n1,</span><br><span class="line">    show</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//a.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">get_data</span>(<span class="params">url</span>)&#123; </span><br><span class="line">    <span class="title function_">fetch</span>(url)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">json</span>())</span><br><span class="line">    .<span class="title function_">then</span>(</span><br><span class="line">        <span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">            <span class="keyword">return</span> data;</span><br><span class="line">        &#125;</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//b.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; get_data &#125; <span class="keyword">from</span> <span class="string">&#x27;./utils.js&#x27;</span>; <span class="comment">//按需导入</span></span><br><span class="line"><span class="comment">//同时要在b.html中模块化的引入b.js</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//html</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>  <span class="attr">type</span>=<span class="string">&quot;module&quot;</span> <span class="attr">src</span>=<span class="string">&quot;./js/b.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>按需导出&#x2F;导入<br>每个模块可以多次；<br>按需导入时可用as重命名，可以和默认导入一起使用</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 按需导出</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">add</span> = (<span class="params">a, b</span>) =&gt; a + b;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> a=<span class="number">12</span>; <span class="comment">//也可以导出变量</span></span><br><span class="line"><span class="keyword">const</span> b=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">const</span> c=<span class="number">2</span>;</span><br><span class="line"><span class="keyword">export</span> &#123;b <span class="keyword">as</span> beta ,c <span class="keyword">as</span> cici&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">say</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 按需导入</span></span><br><span class="line"><span class="keyword">import</span> &#123; add,a,cici &#125; <span class="keyword">from</span> <span class="string">&#x27;./math.js&#x27;</span>;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>如果是单纯执行某个模块代码，不需要export，可以直接导入并执行即可。</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// c.js</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)<span class="variable language_">console</span>.<span class="title function_">log</span>(i)</span><br><span class="line"> </span><br><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./c.js&#x27;</span> <span class="comment">//直接导入并执行</span></span><br></pre></td></tr></table></figure>
<ol start="4">
<li>html文件中如何引入？<code>&lt;script type=&quot;module&quot;&gt;&lt;/script&gt;</code>+上述引入方式</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;module&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">import</span> * <span class="keyword">as</span> modTwo <span class="keyword">from</span> <span class="string">&#x27;./modules/2.js&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(modTwo.<span class="property">aaa</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>import&#x2F;export 和 require&#x2F;module.exports 区别？</li>
</ul>
<table>
<thead>
<tr>
<th>特性</th>
<th><code>import/export</code>（ES6）</th>
<th><code>require/module.exports</code>（CommonJS）</th>
</tr>
</thead>
<tbody><tr>
<td>规范</td>
<td>ES6（ECMAScript 2015）模块化规范</td>
<td>CommonJS 是 Node.js 模块化规范</td>
</tr>
<tr>
<td>执行时机</td>
<td>静态分析（编译时）</td>
<td>动态加载（运行时）</td>
</tr>
<tr>
<td>是否支持异步加载</td>
<td>支持异步加载（<code>import()</code>）</td>
<td>不支持（同步加载）</td>
</tr>
<tr>
<td>默认导入&#x2F;导出</td>
<td>使用 <code>export default</code></td>
<td>通过 <code>module.exports</code> 或 <code>exports</code> 导出</td>
</tr>
<tr>
<td>导入方式</td>
<td><code>import &#123;a, b&#125; from &#39;./file&#39;</code></td>
<td><code>const &#123;a, b&#125; = require(&#39;./file&#39;)</code></td>
</tr>
<tr>
<td>动态导入</td>
<td>支持动态导入（<code>import()</code>）</td>
<td>仅能使用 <code>require</code> 动态加载（但相对较麻烦）</td>
</tr>
<tr>
<td>运行时加载方式</td>
<td>在文件编译阶段完成依赖关系</td>
<td>在运行时逐步解析依赖</td>
</tr>
<tr>
<td>是否支持循环依赖</td>
<td>支持（但会警告）</td>
<td>支持（解决方案：<code>require</code> 返回缓存模块）</td>
</tr>
<tr>
<td>是否会被提升</td>
<td><strong>不会</strong>，必须在顶部使用</td>
<td><strong>会提升</strong>，可以在文件任何位置使用</td>
</tr>
<tr>
<td>浏览器支持</td>
<td>原生支持（需要模块化支持的浏览器）</td>
<td>需要通过构建工具（如 Webpack）支持</td>
</tr>
<tr>
<td>Node.js 版本支持</td>
<td>Node.js 12+（需要开启 <code>&quot;type&quot;: &quot;module&quot;</code>）</td>
<td>默认支持</td>
</tr>
<tr>
<td>加载方式</td>
<td>优化，支持 Tree Shaking</td>
<td>每次执行都会重新加载模块</td>
</tr>
</tbody></table>
<ul>
<li>export default 和 export 有什么不同？</li>
</ul>
<table>
<thead>
<tr>
<th>特性</th>
<th><code>export default</code></th>
<th><code>export</code> (命名导出)</th>
</tr>
</thead>
<tbody><tr>
<td><strong>数量</strong></td>
<td>每个模块只能有一个 <code>default</code> 导出</td>
<td>每个模块可以有多个命名导出</td>
</tr>
<tr>
<td><strong>导入方式</strong></td>
<td>导入时可以自定义名字</td>
<td>必须使用与导出时相同的名字</td>
</tr>
<tr>
<td><strong>适用场景</strong></td>
<td>用于导出模块的主要功能&#x2F;类&#x2F;对象等</td>
<td>用于导出多个功能、常量、函数等</td>
</tr>
<tr>
<td><strong>导入时的灵活性</strong></td>
<td>导入时名称不受限制</td>
<td>导入时名称必须一致</td>
</tr>
<tr>
<td><strong>动态导入</strong></td>
<td>适用于动态导入，便于重命名导入</td>
<td>适用于动态导入，并保持一致性</td>
</tr>
</tbody></table>
<h1 id="迭代器与生成器（进阶）"><a href="#迭代器与生成器（进阶）" class="headerlink" title="迭代器与生成器（进阶）"></a>迭代器与生成器（进阶）</h1><p>generator函数是‘生成器’，解决异步，深度嵌套的问题，现在有更好的解决方案： async&#x2F;await</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">function</span> * <span class="title function_">gen</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="keyword">yield</span> <span class="string">&#x27;welcome&#x27;</span>;<span class="comment">//第一步</span></span><br><span class="line">            <span class="keyword">yield</span> <span class="string">&#x27;to&#x27;</span>;<span class="comment">//第二步</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;牧码人&#x27;</span>;<span class="comment">//第三步</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> g1 = <span class="title function_">gen</span>();</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(g1.<span class="title function_">next</span>()); <span class="comment">//&#123;value: &quot;welcome&quot;, done: false没完成&#125;</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(g1.<span class="title function_">next</span>()); <span class="comment">//&#123;value: &quot;to&quot;, done: false&#125;</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(g1.<span class="title function_">next</span>()); <span class="comment">//&#123;value: &quot;牧码人&quot;, done: true&#125;</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(g1.<span class="title function_">next</span>());<span class="comment">//&#123; value: undefined, done: true &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> val <span class="keyword">of</span> g1)&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(val);<span class="comment">//不会遍历到return！</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//生成器可以解构赋值</span></span><br><span class="line"><span class="keyword">let</span> [a, ...b] = <span class="title function_">gen</span>();<span class="comment">//let[a.b.c]</span></span><br><span class="line"><span class="comment">//扩展运算符</span></span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(...<span class="title function_">gen</span>());</span><br><span class="line"> <span class="comment">//转换为数组</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="title function_">gen</span>()));</span><br><span class="line"></span><br><span class="line"><span class="comment">//应用：请求</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/axios/dist/axios.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//https://api.github.com/users/itstrive</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">function</span> * <span class="title function_">gen</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="keyword">let</span> val = <span class="keyword">yield</span> <span class="string">&#x27;aaa&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="keyword">yield</span> axios.<span class="title function_">get</span>(<span class="string">`https://api.github.com/users/<span class="subst">$&#123;val&#125;</span>`</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">let</span> g1 = <span class="title function_">gen</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">let</span> username = g1.<span class="title function_">next</span>().<span class="property">value</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//console.log(g1.next(username).value);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        g1.<span class="title function_">next</span>(username).<span class="property">value</span>.<span class="title function_">then</span>(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">整个流程没有问题，</span></span><br><span class="line"><span class="comment">实际上你只是通过生成器来控制异步操作的执行顺序（类似协程的模式）。</span></span><br><span class="line"><span class="comment">但是，生成器的部分在这里并没有发挥出它的全部优势。</span></span><br><span class="line"><span class="comment">通常生成器和异步操作结合的方式是通过 yield 来暂停执行，等待异步操作完成，</span></span><br><span class="line"><span class="comment">然后再继续执行后续的代码。你可以通过使用 async/await 来简化代码结构，</span></span><br><span class="line"><span class="comment">或者将生成器的控制交给一个专门的调度器。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//改进</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/axios/dist/axios.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//https://api.github.com/users/itstrive</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">function</span>* <span class="title function_">gen</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">let</span> val = <span class="keyword">yield</span> <span class="string">&#x27;aaa&#x27;</span>;  <span class="comment">// This is where we get the username</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">let</span> response = <span class="keyword">yield</span> axios.<span class="title function_">get</span>(<span class="string">`https://api.github.com/users/<span class="subst">$&#123;val&#125;</span>`</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">return</span> response.<span class="property">data</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//返回一个 Promise 对象</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">function</span> <span class="title function_">handleGenerator</span>(<span class="params">gen</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">const</span> iterator = <span class="title function_">gen</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">function</span> <span class="title function_">iterate</span>(<span class="params">result</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="keyword">if</span> (result.<span class="property">done</span>) <span class="keyword">return</span>;  <span class="comment">// If done, stop</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="comment">//配合Promise.then()</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            result.<span class="property">value</span>.<span class="title function_">then</span>(<span class="function"><span class="params">val</span> =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="title function_">iterate</span>(iterator.<span class="title function_">next</span>(val));  </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="comment">// Pass the result to the next yield</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="comment">//递归调用</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="title function_">iterate</span>(iterator.<span class="title function_">next</span>());  </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="comment">// Start the iteration</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleGenerator</span>(gen);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="可选链-空值合并运算符（ES2020-）"><a href="#可选链-空值合并运算符（ES2020-）" class="headerlink" title="可选链 &amp; 空值合并运算符（ES2020+）"></a>可选链 &amp; 空值合并运算符（ES2020+）</h1><p>更方便地处理嵌套对象和可能为 null 或 undefined 的值。</p>
<ul>
<li>可选链（Optional Chaining）<br>可选链（<code>?.</code>）是用来安全地访问嵌套对象的属性，它会自动判断中间的任何一部分是否为 null 或 undefined，如果是，则会短路并返回 undefined，而不会抛出错误。<br><code>user?.info?.name</code>user-&gt;user.info-&gt;user.info.name</li>
<li>空值合并运算符（Nullish Coalescing Operator）<br>与 逻辑 OR 运算符 (<code>||</code>) 类似，但 <code>??</code> 仅在左侧值为 null 或 undefined 时 才会返回右侧值，而 <code>||</code> 会在左侧值是任何假值（如 0, false, “”, NaN 等）时返回右侧值。</li>
<li>练习<br><code>const name = user?.info?.name ?? &#39;default&#39;;</code></li>
</ul>
<h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><h2 id="WeakSet"><a href="#WeakSet" class="headerlink" title="WeakSet"></a>WeakSet</h2><ul>
<li>定义<br>WeakSet 是 ES6 引入的一种新的集合类型。<br>弱引用：WeakSet 对象的元素是 弱引用，这意味着如果一个对象没有其他引用指向它，垃圾回收机制会回收它，而不会因为它在 WeakSet 中的存在而阻止回收。<br>WeakSet 支持以下基本操作：<br>add(value)：将一个对象添加到 WeakSet 中。如果该对象已经存在，什么都不做。初始往里面添加东西，是不行的。最好用add添加<br>has(value)：检查某个对象是否在 WeakSet 中。如果存在返回 true，否则返回 false。<br>delete(value)：从 WeakSet 中删除一个对象。如果该对象存在，</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一些对象</span></span><br><span class="line"><span class="keyword">let</span> obj1 = &#123;<span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span>&#125;;</span><br><span class="line"><span class="keyword">let</span> obj2 = &#123;<span class="attr">name</span>: <span class="string">&#x27;Bob&#x27;</span>&#125;;</span><br><span class="line"><span class="keyword">let</span> obj3 = &#123;<span class="attr">name</span>: <span class="string">&#x27;Charlie&#x27;</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 WeakSet</span></span><br><span class="line"><span class="keyword">let</span> weakSet = <span class="keyword">new</span> <span class="title class_">WeakSet</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加对象到 WeakSet</span></span><br><span class="line">weakSet.<span class="title function_">add</span>(obj1);</span><br><span class="line">weakSet.<span class="title function_">add</span>(obj2);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查对象是否在 WeakSet 中</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(weakSet.<span class="title function_">has</span>(obj1));  <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(weakSet.<span class="title function_">has</span>(obj3));  <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除对象</span></span><br><span class="line">weakSet.<span class="title function_">delete</span>(obj1);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(weakSet.<span class="title function_">has</span>(obj1));  <span class="comment">// false</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>为什么会有weakset？<br>1）跟踪对象的存在性：WeakSet 可用于跟踪对象是否曾经存在，而不阻止这些对象的垃圾回收。例如，某些需要动态管理的对象，且在不再需要时能被自动清除。<br>2）避免内存泄漏：由于 WeakSet 使用弱引用，集合中的对象可以被垃圾回收，避免了因长期引用对象而导致的内存泄漏。在一些缓存系统中，可以使用 WeakSet 来存储对象，确保不再被引用时自动被清除。</li>
<li>WeakSet 与 Set 的区别：<br><img src="/images/ES6%E4%B8%80%E6%9C%AC%E9%80%9A.assets/669b09ad58154a8fa035da82b92a362b.png" alt="在这里插入图片描述"></li>
</ul>
<h2 id="async-await"><a href="#async-await" class="headerlink" title="async&#x2F;await"></a>async&#x2F;await</h2><p>在此之前 promise只能通过链式.then()方式处理，可读性不好，比较复杂。</p>
<ul>
<li>async&#x2F;await 是 ES8（ECMAScript 2017）引入的语法糖，旨在让异步代码更简洁、更易读。基于 Promise的，更直观处理异步操作，避免传统回调函数的“回调地狱”（callback hell）。async&#x2F;await 本质上 是写法上看起来像同步，但底层仍是异步执行。async-await是配套使用的。<strong>在 async 方法中，第一个 await 之前的代码会同步执行，await 之后的代码会异步执行。</strong></li>
<li>await 后面的操作其实是非阻塞的，只是让当前 async 函数“暂停”，而不会阻塞整个程序的运行。await 理解成一个“暂停点”，程序会在那儿等着 Promise 完成，然后继续往下走。<br>注意：await 是暂停，但不是“阻塞线程”</li>
<li>JavaScript 是 单线程的<br>await 并不是开了一个新线程，而是把当前 async 函数挂起，等 Promise 完成后再“恢复”继续执行；同时，主线程可以继续处理其他任务（比如事件监听、渲染页面、执行其他函数等）；类似于单核 CPU 的分时复用，这边暂停下来，先去忙别的事，这边ok了再继续回来执行。</li>
<li>async 关键字<br>async 用来标记一个函数为异步函数。当一个函数被标记为 async 时，它会返回一个 Promise对象。即使函数内部没有显式返回 Promise，async 函数会自动将返回值封装在一个 Promise 对象中。<br>当一个 async 函数中的 await 语句后面的 Promise 变成 reject（即发生错误）时，整个 async 函数会中断执行，并且await后续代码不会执行，除非在 async 函数内使用try…catch 捕获错误。</li>
<li>await 关键字<br>await 只能在 async 函数内使用，会暂停函数执行，等待一个 Promise 完成并返回 Promise 的结果。如果 Promise 拒绝，会抛出异常，必须使用 try&#x2F;catch 来捕获错误。<br>一旦 Promise 被解析，await 会返回解析值。如果 Promise 被拒绝，await 会抛出拒绝的错误。<br>await后面可以是promise对象，也可以数字、字符串、布尔值等。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fetchData</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&quot;https://api.github.com/users/octocat&quot;</span>);</span><br><span class="line">    <span class="keyword">let</span> data = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;错误:&quot;</span>, error);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">fetchData</span>();  <span class="comment">// 如果网络请求失败，输出错误</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getUserRepos</span>(<span class="params">username</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> userResponse = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">`https://api.github.com/users/<span class="subst">$&#123;username&#125;</span>`</span>);</span><br><span class="line">  <span class="keyword">let</span> user = <span class="keyword">await</span> userResponse.<span class="title function_">json</span>();</span><br><span class="line">  <span class="keyword">let</span> reposResponse = <span class="keyword">await</span> <span class="title function_">fetch</span>(user.<span class="property">repos_url</span>);</span><br><span class="line">  <span class="keyword">let</span> repos = <span class="keyword">await</span> reposResponse.<span class="title function_">json</span>();</span><br><span class="line">  <span class="keyword">return</span> repos;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">getUserRepos</span>(<span class="string">&quot;octocat&quot;</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">repos</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(repos);  <span class="comment">// 输出该用户的所有仓库</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

            </div>
        </div>
    </article>

    
    
<nav class="article-nav">
  
    <a href="/2025/07/10/TS%E4%B8%80%E6%9C%AC%E9%80%9A/" id="article-nav-newer" class="article-nav-link-wrap prev">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          TS一本通
        
      </div>
    </a>
  
  
    <a href="/2025/07/09/JS%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0/" id="article-nav-older" class="article-nav-link-wrap next">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">JS一本通</div>
    </a>
  
</nav>

    

    
</div>
    </div>
    <footer class="site-footer">
        <div class="global-width">
            <ul class="site-widget">
                
                <li class="widget widget-tag">
                    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget-body">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/English/" rel="tag">English</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/basics/" rel="tag">basics</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/frontend/" rel="tag">frontend</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/projects/" rel="tag">projects</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tags/" rel="tag">tags</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/test/" rel="tag">test</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

                </li>
                
                <li class="widget widget-category">
                    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/daily-report/">daily_report</a><span class="category-list-count">52</span></li></ul>
    </div>
  </div>

                </li>
                
                <li class="widget widget-recent_posts">
                    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget-body">
      <ul>
        
          <li>
            <a href="/2025/07/20/PWA/">PWA</a>
          </li>
        
          <li>
            <a href="/2025/07/16/nodejs%E6%A8%A1%E5%9D%97%E5%A4%A7%E5%85%A8/">nodejs模块大全</a>
          </li>
        
          <li>
            <a href="/2025/07/15/nodejs%E4%B8%80%E6%9C%AC%E9%80%9A/">nodejs一本通</a>
          </li>
        
          <li>
            <a href="/2025/07/14/docker%E4%B8%80%E6%9C%AC%E9%80%9A/">docker一本通 + nginx</a>
          </li>
        
          <li>
            <a href="/2025/07/12/%E5%8C%85%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/">包管理工具</a>
          </li>
        
      </ul>
    </div>
  </div>

                </li>
                
            </ul>
        </div>
        <div class="site-info">
            <address>
                &copy; 2014 <a href="https://70v-yoyo.github.io">Yoyo&#39;s blog</a> All Right Reserved. <br/>
                Powered by <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a>. Theme by <a target="_blank" rel="noopener" href="http://zzoman.com">ZZOMAN</a>
                <p><a target="_blank" href="https://github.com/70v-Yoyo">My github</a></p>
            </address>
        </div>
    </footer> 
    
    
    <script src="/libs/jquery-1.11.3.min.js" type="text/javascript"></script>
    
    <script src="/libs/fancybox/jquery.fancybox.js" type="text/javascript"></script>
    
    <script src="/js/site_init.js" type="text/javascript"></script>
     
    <noscript>
        <style>
            article {
                position: absolute;
                width: 0;
                height: 0;
                overflow: hidden;
                opacity: 0;
            }

        </style>
        <h1>JS已被禁用</h1>
    </noscript>
<!-- hexo injector body_end start -->
    <script>
      (function() {
        function moveElementIfSmallScreen() {
          const toc = document.getElementById('fixed-toc-container');
          const article = document.querySelector("article");
          const toggleBtn = document.getElementById('toggle_btn');
          if (!toc || !article) return;
          if (window.innerWidth < 1024 && article.firstElementChild !== toc) {
            console.log('small screen!!')
            
            article.insertBefore(toc, article.firstChild);//移动节点，而非复制
            
            toggleBtn.style.display='none';
            // 替换样式：取消 fixed，设置适合正文的样式
            toc.style.position = 'relative';
            toc.style.top = '';
            toc.style.left = '';
            toc.style.width = '100%';
            toc.style.maxHeight = 'none';
            toc.style.overflowY = 'visible';
            toc.style.overflowX = 'visible';
            toc.style.padding = '1em';
            toc.style.borderLeft = 'none';
            toc.style.borderBottom = '1px solid #ddd';
            toc.style.background = '#f9f9f9';
            toc.style.opacity = '1';
            toc.style.zIndex = '9999';
            toc.style.boxShadow = 'none';
            toc.style.margin = '1rem';
            toc.style.paddingTop= '2rem';
          }
        }
        window.addEventListener("DOMContentLoaded", moveElementIfSmallScreen);
        window.addEventListener("resize", moveElementIfSmallScreen);
      })();
    </script>
  <!-- hexo injector body_end end -->
    <div id="fixed-toc-container" style="
      position: fixed;
      top: 0vh;
      left: 0px;
      width: 15rem;
      max-height: 80vh;
      overflow-y: auto;
      overflow-x: auto;
      padding: 10px;
      border-left: 2px solid #ccc;
      font-size: 14px;
      line-height: 1.5;
      background: #fff;
      opacity:0.8;
      z-index: 9999;
      box-shadow:
        0 2px 4px rgba(0, 0, 0, 0.05),  /* 第一层：近处柔和 */
        0 8px 16px rgba(0, 0, 0, 0.08); /* 第二层：远处扩散 */
    ">
      <strong>Contents</strong>
      <div id="toggle_btn" style="
      position:absolute;
      right:1rem;
      display:inline-block;
      width:2rem;
      text-align:center;
      border:1px solid #ccc;
      "><</div>
      <ul id="fixed-toc-list" style="list-style: none; padding-left: 10px;"></ul>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const nav = document.querySelector('nav');
        if (nav) {
          const navBottom = nav.getBoundingClientRect().bottom;//浏览器JS API
          console.log('nav bottom:', navBottom);
          // 设置toc元素 top = nav bottom
          const toc = document.querySelector('#fixed-toc-container');
          if (toc) {
            toc.style.top = navBottom + 'px';
            toc.style.maxHeight=window.innerHeight - navBottom.getBoundingClientRect().bottom;
          }
        }
      });

      const myDiv = document.getElementById('toggle_btn');
      var tocList=document.getElementById("fixed-toc-list");
      var tocContainer=document.getElementById("fixed-toc-container");
      function handleClickBtn() {
        console.log('Div 被点击了！');
        if(myDiv.textContent==='<'){
          myDiv.textContent ='>'
          tocList.style.display='none'
          tocContainer.style.width='11rem'
        }else{
          myDiv.textContent ='<'
          tocList.style.display='block'
          tocContainer.style.width='15rem'
        }
          
      }


      myDiv.addEventListener('click', handleClickBtn);// 绑定点击事件


      (function() {
      const Patternstr = "/*\\d{4}/\\d{2}/\\d{2}/.*"; //本身是字符串插入，所以对符号要转义
      //"^//*"->"/"
      //"/.*"->".*"
      //JS引擎中""转义
      //正则表达式引擎也是""转义
      const dataPattern = new RegExp(Patternstr);
      const path = window.location.pathname;
      console.log(dataPattern.toString(),path,dataPattern.test(path));//控制台在渲染时省略了反斜杠的可视表示。
      if (!dataPattern.test(path)&&(path==='/'||path==='index.html')) {
        console.log('no toc')
        let toc = document.getElementById('fixed-toc-container');
        if (toc) toc.style.display = 'none';
        return;
      }
        var content = document.querySelector('body');
        console.log('content',content)
        //var tocList = document.getElementById('fixed-toc-list');
        if (!content || !tocList) {
          document.getElementById('fixed-toc-container').style.display = 'none';
          return;
        }
        var headings = content.querySelectorAll('h1, h2, h3, h4');
        console.log('headings',headings)
        if(headings){
          const h1Element=headings[0];
          const rect = h1Element.getBoundingClientRect();
          if(rect.left<150){
           tocContainer.style.right='0px';
           tocContainer.style.left = 'auto'; // 移除内联的 left 样式
            //不是设置right:0 就替换left:0 需要移除
            console.log('to right')
          }
          console.log(rect.left,'150')
        }
        
        if (headings.length === 0) {
          document.getElementById('fixed-toc-container').style.display = 'none';
          return;
        }
        headings.forEach(function(heading, i) {
          if (!heading.id) {
            heading.id = 'heading-' + i;
          }
        });
        headings.forEach(function(heading) {
          var level = parseInt(heading.tagName.substring(1));
          var li = document.createElement('li');
          li.style.marginLeft = (level - 1) * 15 + 'px';
          var a = document.createElement('a');
          a.href = '#' + heading.id;
          a.textContent = heading.textContent;
          a.style.color = '#555';
          a.style.textDecoration = 'none';
          a.onmouseover = function() { a.style.textDecoration = 'underline'; };
          a.onmouseout = function() { a.style.textDecoration = 'none'; };
          li.appendChild(a);
          tocList.appendChild(li);
        });
      })();
    </script>
  </body>
</html>
