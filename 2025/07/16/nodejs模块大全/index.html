<!doctype html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    
    
    <title>nodejsæ¨¡å—å¤§å…¨ | Yoyo&#39;s blog</title>
    
    <link rel="alternative" href="/atom.xml" title="Yoyo&#39;s blog" type="application/atom+xml">
    
    
<link rel="stylesheet" href="/css/style.css">

    
    <link rel="stylesheet" href="/libs/fancybox/jquery.fancybox.css" charset="utf-8">
    
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
<!-- hexo injector head_end start --><script src="./func.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>
<body class="site">
    <!-- é®ç½©å±‚ -->
    <div id="mask-layer">
    </div>
    
    <header class="site-header">
        <h1 class="site-title"><a href="/">Yoyo&#39;s blog</a></h1>
        <nav class="site-nav">
            <ul class="nav">
                
                <li><a href="/">Home</a></li>
                
                <li><a href="/archives">Archives</a></li>
                
                
                <li><a href="/atom.xml" title="RSS Feed">rss</a></li>
                
                <li><a class="toggle-search" href="#search">search</a></li>
            </ul>
        </nav>
        <div class="site-search" id="search">
            <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="https://70v-yoyo.github.io"></form>
        </div>
        
            <div class="site-header-background" style="background-image:url('http://reumia.github.io/hexo-theme-zzoman2015/images/background-zzoman2015.jpg')"></div>
        
    </header>
    <div class="site-body">
        <div class="global-width">
    <article class="article" data-layout="post" data-slug="nodejsæ¨¡å—å¤§å…¨">
        <div class="article-content">
            
            
            <header class="article-header">
                <div class="article-meta">
                    <a href="/2025/07/16/nodejs%E6%A8%A1%E5%9D%97%E5%A4%A7%E5%85%A8/" class="article-date">
  <time datetime="2025-07-16T01:44:32.000Z">2025-07-16</time>
</a>
                    
                    
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/frontend/" rel="tag">frontend</a></li></ul>

                </div>
                
    <h1 class="article-title" itemprop="name">
      <a href="/2025/07/16/nodejs%E6%A8%A1%E5%9D%97%E5%A4%A7%E5%85%A8/">nodejsæ¨¡å—å¤§å…¨</a>
    </h1>

            </header>
            
            <div class="article-body">
                <meta name="referrer" content="no-referrer" />

<blockquote>
<p>ç‰ˆæœ¬ï¼š250716</p>
</blockquote>
<ul>
<li>é“¾æ¥<br><a target="_blank" rel="noopener" href="https://wyoyo.blog.csdn.net/article/details/147011343?fromshare=blogdetail&sharetype=blogdetail&sharerId=147011343&sharerefer=PC&sharesource=qq_41775119&sharefrom=from_link">nodeä¸€æœ¬é€š</a><br>åŒ…æ‹¬ï¼š<br>express<br>path<br>fs&#x2F;<br>process&#x2F;<br>os&#x2F;<br>http&#x2F;<br>mysql&#x2F;mongoose&#x2F;<br>express-jwt&#x2F;jsonwebtoken&#x2F;<br>dotenv&#x2F;<br>multer&#x2F;<br>swagger&#x2F;<br>cors&#x2F;<br>nodemon (dockerç¯‡æœ‰)</li>
<li>å¸¸ç”¨æ¨¡å—<ul>
<li>å†…ç½®<br>  fs    æ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼ˆè¯»å†™ã€é‡å‘½åç­‰ï¼‰</li>
</ul>
<p>  path    è·¯å¾„å¤„ç†ï¼ˆæ‹¼æ¥ã€è§£æã€æ‰©å±•åç­‰ï¼‰<br>  http    åˆ›å»º HTTP æœåŠ¡æˆ–å®¢æˆ·ç«¯<br>  os    è·å–æ“ä½œç³»ç»Ÿä¿¡æ¯ï¼ˆCPUã€å†…å­˜ç­‰ï¼‰<br>  events    äº‹ä»¶é©±åŠ¨æœºåˆ¶ï¼ˆç›‘å¬ã€è§¦å‘äº‹ä»¶ï¼‰.<br>  stream    å¤„ç†æµå¼æ•°æ®ï¼ˆæ–‡ä»¶è¯»å†™ã€ç®¡é“ç­‰ï¼‰.<br>  crypto    åŠ å¯†ã€å“ˆå¸Œã€ç­¾åç­‰å®‰å…¨ç›¸å…³åŠŸèƒ½.<br>  child_process    åˆ›å»ºå­è¿›ç¨‹ã€æ‰§è¡Œå‘½ä»¤è¡Œä»»åŠ¡.<br>  util    å·¥å…·å‡½æ•°ï¼ˆç»§æ‰¿ã€promisify ç­‰ï¼‰.</p>
<ul>
<li>ç¬¬ä¸‰æ–¹ï¼š<br>  express    Web æ¡†æ¶ï¼Œå¿«é€Ÿæ„å»º API æœåŠ¡<br>  axios    å‘èµ· HTTP è¯·æ±‚ï¼ˆæ”¯æŒ Promiseï¼‰<br>  dotenv    åŠ è½½ .env ç¯å¢ƒå˜é‡é…ç½®<br>  chalk    ç»ˆç«¯è¾“å‡ºå½©è‰²æ–‡æœ¬<br>  commander    æ„å»ºå‘½ä»¤è¡Œå·¥å…·<br>  nodemon    è‡ªåŠ¨é‡å¯ Node æœåŠ¡ï¼ˆå¼€å‘åˆ©å™¨ï¼‰<br>  jsonwebtoken    JWT é‰´æƒä¸ä»¤ç‰Œç”Ÿæˆ<br>  mongoose    MongoDB ODMï¼Œæ“ä½œæ•°æ®åº“æ›´æ–¹ä¾¿<br>  cors    å¤„ç†è·¨åŸŸè¯·æ±‚<br>  body-parser    è§£æè¯·æ±‚ä½“ï¼ˆExpress ä¸­å¸¸ç”¨ï¼‰.<br>  multer    å¤„ç†æ–‡ä»¶ä¸Šä¼ <br>  socket.io    å®ç° WebSocket å®æ—¶é€šä¿¡</li>
</ul>
</li>
</ul>
<p>@<a href="%E7%9B%AE%E5%BD%95">TOC</a></p>
<h1 id="URL-URLSearchParams-qs"><a href="#URL-URLSearchParams-qs" class="headerlink" title="URL &#x2F; URLSearchParams&#x2F; qs"></a>URL &#x2F; URLSearchParams&#x2F; qs</h1><p>URL &#x2F; URLSearchParams æ˜¯node&#x2F;æµè§ˆå™¨éƒ½æ”¯æŒ<br>qs ç¬¬ä¸‰æ–¹åº“ï¼Œç”¨äºå¤„ç†å¤æ‚queryï¼ˆåµŒå¥—å¯¹è±¡&#x2F;æ•°ç»„ï¼‰ï¼Œæ”¾å…¥æµè§ˆå™¨éœ€è¦æ‰“åŒ…ï¼ˆwebpack&#x2F;viteï¼‰<code>npm i qs</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myURL = <span class="keyword">new</span> <span class="title function_">URL</span>(<span class="string">&#x27;https://example.com:8080/path?a=123&amp;b=456#hash&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(myURL.<span class="property">protocol</span>)  <span class="comment">// &#x27;https:&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(myURL.<span class="property">hostname</span>)  <span class="comment">// &#x27;example.com&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(myURL.<span class="property">port</span>)      <span class="comment">// &#x27;8080&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(myURL.<span class="property">pathname</span>)  <span class="comment">// &#x27;/path&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(myURL.<span class="property">hash</span>)      <span class="comment">// &#x27;#hash&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(url.<span class="property">search</span>);     <span class="comment">// &#x27;?a=123&amp;b=456&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> params = url.<span class="property">searchParams</span>;<span class="comment">//å¾—åˆ°URLSearchParams å®ä¾‹å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ“ä½œ query å‚æ•°</span></span><br><span class="line">myURL.<span class="property">searchParams</span>.<span class="title function_">set</span>(<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;100&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(myURL.<span class="title function_">toString</span>()) <span class="comment">// https://example.com:8080/path?a=100&amp;b=2#hash</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// éå† query å‚æ•°</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> [key, value] <span class="keyword">of</span> myURL.<span class="property">searchParams</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(key, value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ­£åˆ™è¡¨è¾¾å¼è¿™ç§ å®é™…ä¸Šå¹¶ä¸æ˜¯URLåº•å±‚åŸç†ï¼Œå› ä¸ºå®ƒè¦†ç›–ä¸å…¨ã€è¾¹ç•Œå‡ºé”™ã€å¯è¯»æ€§å·®ã€æ•ˆç‡ä½</span></span><br><span class="line"><span class="keyword">const</span> url = <span class="string">&#x27;http://www.example.com/a/index.html?a=123&amp;b=456&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> regex = <span class="regexp">/^(https?):\/\/([^\/?#]+)(\/[^?#]*)?(\?[^#]*)?(#.*)?$/</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//URLSearchParams</span></span><br><span class="line"><span class="comment">//ç©ºå€¼å’Œæ— å€¼çš„å‚æ•°éƒ½ä¼šè¢«è§£æä¸º &#x27;&#x27;</span></span><br><span class="line"><span class="keyword">const</span> params = <span class="keyword">new</span> <span class="title class_">URLSearchParams</span>(<span class="string">&#x27;?name=Alice&amp;age=30&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(params.<span class="title function_">get</span>(<span class="string">&#x27;name&#x27;</span>));      <span class="comment">// &quot;Alice&quot; </span></span><br><span class="line"><span class="comment">//è¿˜æœ‰getAll</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(params.<span class="title function_">has</span>(<span class="string">&#x27;age&#x27;</span>));       <span class="comment">// true</span></span><br><span class="line">params.<span class="title function_">set</span>(<span class="string">&#x27;age&#x27;</span>, <span class="string">&#x27;31&#x27;</span>);              <span class="comment">// ä¿®æ”¹ age å‚æ•°</span></span><br><span class="line">params.<span class="title function_">append</span>(<span class="string">&#x27;hobby&#x27;</span>, <span class="string">&#x27;reading&#x27;</span>);    <span class="comment">// æ·»åŠ  hobby å‚æ•°</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(params.<span class="title function_">toString</span>());       <span class="comment">// &quot;name=Alice&amp;age=31&amp;hobby=reading&quot;</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">.delete(key)	åˆ é™¤æŒ‡å®šå‚æ•°</span></span><br><span class="line"><span class="comment">.sort()	æŒ‰å‚æ•°åæ’åº</span></span><br><span class="line"><span class="comment">.entries()	è·å–æ‰€æœ‰é”®å€¼å¯¹è¿­ä»£å™¨</span></span><br><span class="line"><span class="comment">.keys() / .values()	è·å–æ‰€æœ‰é”®æˆ–å€¼çš„è¿­ä»£å™¨</span></span><br><span class="line"><span class="comment">.forEach()	éå†æ‰€æœ‰å‚æ•°</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//qs</span></span><br><span class="line"><span class="keyword">const</span> qs = <span class="built_in">require</span>(<span class="string">&#x27;qs&#x27;</span>)</span><br><span class="line"><span class="comment">// å¯¹è±¡ â†’ query å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">const</span> str = qs.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">b</span>: [<span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">  <span class="attr">c</span>: &#123; <span class="attr">d</span>: <span class="number">4</span> &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str)</span><br><span class="line"><span class="comment">// a=1&amp;b[0]=2&amp;b[1]=3&amp;c[d]=4</span></span><br><span class="line"><span class="comment">// å­—ç¬¦ä¸² â†’ å¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> obj = qs.<span class="title function_">parse</span>(<span class="string">&#x27;a=1&amp;b[0]=2&amp;b[1]=3&amp;c[d]=4&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj)</span><br><span class="line"><span class="comment">// &#123; a: &#x27;1&#x27;, b: [&#x27;2&#x27;, &#x27;3&#x27;], c: &#123; d: &#x27;4&#x27; &#125; &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// URL: /search?filter[status]=active&amp;filter[tags][]=js&amp;filter[tags][]=vue</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/search&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// é»˜è®¤ Express ä¸æ”¯æŒåµŒå¥—è§£æï¼Œéœ€è¦ qs æ‰‹åŠ¨è§£æ</span></span><br><span class="line">  <span class="keyword">const</span> filter = <span class="built_in">require</span>(<span class="string">&#x27;qs&#x27;</span>).<span class="title function_">parse</span>(req.<span class="property">query</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(filter)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="axioså‘èµ·-HTTP-è¯·æ±‚ï¼ˆæ”¯æŒ-Promiseï¼‰"><a href="#axioså‘èµ·-HTTP-è¯·æ±‚ï¼ˆæ”¯æŒ-Promiseï¼‰" class="headerlink" title="axios	å‘èµ· HTTP è¯·æ±‚ï¼ˆæ”¯æŒ Promiseï¼‰"></a>axios	å‘èµ· HTTP è¯·æ±‚ï¼ˆæ”¯æŒ Promiseï¼‰</h1><p>åœ¨nodejs å’Œ js ç”¨æ³•åŸºæœ¬ä¸€æ ·ï¼Œä½†æœ‰ç»†èŠ‚å·®å¼‚</p>
<table>
<thead>
<tr>
<th>é¡¹ç›®</th>
<th>æµè§ˆå™¨ç¯å¢ƒ</th>
<th>Node.js ç¯å¢ƒ</th>
</tr>
</thead>
<tbody><tr>
<td>è¯·æ±‚åº•å±‚</td>
<td>ä½¿ç”¨ <code>XMLHttpRequest</code> æˆ– <code>fetch</code></td>
<td>ä½¿ç”¨ Node çš„ <code>http</code> æˆ– <code>https</code> æ¨¡å—</td>
</tr>
<tr>
<td>Cookie è‡ªåŠ¨æºå¸¦</td>
<td>é»˜è®¤æºå¸¦å½“å‰åŸŸåä¸‹çš„ Cookie</td>
<td>éœ€è¦æ‰‹åŠ¨è®¾ç½® <code>withCredentials</code> æˆ– <code>headers</code></td>
</tr>
<tr>
<td>CORS è·¨åŸŸé™åˆ¶</td>
<td>å—æµè§ˆå™¨å®‰å…¨ç­–ç•¥é™åˆ¶</td>
<td>ä¸å—é™åˆ¶ï¼Œå¯è‡ªç”±è¯·æ±‚ä»»ä½•åœ°å€</td>
</tr>
<tr>
<td>æ–‡ä»¶ä¸Šä¼ </td>
<td>ä½¿ç”¨ <code>FormData</code></td>
<td>éœ€ä½¿ç”¨ <code>form-data</code> æ¨¡å—æˆ– Buffer</td>
</tr>
<tr>
<td>æµè§ˆå™¨ç‰¹æ€§æ”¯æŒ</td>
<td>å¯æ˜¾ç¤ºåŠ è½½åŠ¨ç”»ã€è¿›åº¦æ¡ç­‰</td>
<td>éœ€æ‰‹åŠ¨å®ç°è¿›åº¦ç›‘å¬é€»è¾‘</td>
</tr>
</tbody></table>
<ul>
<li>åº”ç”¨åœºæ™¯<br>è°ƒç”¨ç¬¬ä¸‰æ–¹ APIï¼šæ¯”å¦‚å¤©æ°”ã€æ”¯ä»˜ã€åœ°å›¾ã€AI æ¥å£ç­‰<br>æœåŠ¡é—´é€šä¿¡ï¼šå¾®æœåŠ¡æ¶æ„ä¸­ï¼Œä¸€ä¸ªæœåŠ¡è°ƒç”¨å¦ä¸€ä¸ªæœåŠ¡çš„æ¥å£<br>æ•°æ®åŒæ­¥ï¼šå®šæ—¶ä»»åŠ¡æ‹‰å–è¿œç¨‹æ•°æ®ï¼Œå†™å…¥æ•°æ®åº“<br>ä»£ç†è½¬å‘è¯·æ±‚ï¼šç»“åˆ Express åš API ç½‘å…³æˆ–ä¸­é—´å±‚<br>ä¸Šä¼ &#x2F;ä¸‹è½½æ–‡ä»¶ï¼šé…åˆ fs æ¨¡å—å¤„ç†æ–‡ä»¶æµ<br>è‡ªåŠ¨åŒ–è„šæœ¬ï¼šæ¯”å¦‚çˆ¬è™«ã€æ‰¹é‡æäº¤æ•°æ®ã€æ¥å£æµ‹è¯•ç­‰</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¯¹æ¯” ä¸ŠJS ä¸‹node</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span><br><span class="line">axios.<span class="title function_">get</span>(<span class="string">&#x27;/api/user&#x27;</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>))</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(err));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> axios = <span class="built_in">require</span>(<span class="string">&#x27;axios&#x27;</span>);</span><br><span class="line">axios.<span class="title function_">get</span>(<span class="string">&#x27;https://api.example.com/user&#x27;</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>))</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(err));</span><br><span class="line"></span><br><span class="line">axios.<span class="title function_">get</span>(<span class="string">&#x27;https://api.example.com/data&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">withCredentials</span>: <span class="literal">true</span> <span class="comment">// å…è®¸æºå¸¦è·¨åŸŸ Cookie</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">axios.<span class="title function_">get</span>(<span class="string">&#x27;https://api.example.com/data&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">headers</span>: &#123;</span><br><span class="line">    <span class="title class_">Cookie</span>: <span class="string">&#x27;sessionId=abc123&#x27;</span> <span class="comment">// æ‰‹åŠ¨è®¾ç½® Cookie</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> formData = <span class="keyword">new</span> <span class="title class_">FormData</span>();</span><br><span class="line">formData.<span class="title function_">append</span>(<span class="string">&#x27;file&#x27;</span>, fileInput.<span class="property">files</span>[<span class="number">0</span>]);</span><br><span class="line">axios.<span class="title function_">post</span>(<span class="string">&#x27;/upload&#x27;</span>, formData, &#123;</span><br><span class="line">  <span class="attr">headers</span>: &#123; <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;multipart/form-data&#x27;</span> &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">FormData</span> = <span class="built_in">require</span>(<span class="string">&#x27;form-data&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> formData = <span class="keyword">new</span> <span class="title class_">FormData</span>();</span><br><span class="line">formData.<span class="title function_">append</span>(<span class="string">&#x27;file&#x27;</span>, fs.<span class="title function_">createReadStream</span>(<span class="string">&#x27;./file.jpg&#x27;</span>));</span><br><span class="line">axios.<span class="title function_">post</span>(<span class="string">&#x27;https://api.example.com/upload&#x27;</span>, formData, &#123;</span><br><span class="line">  <span class="attr">headers</span>: formData.<span class="title function_">getHeaders</span>()</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">axios.<span class="title function_">get</span>(<span class="string">&#x27;/bigfile&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">onDownloadProgress</span>: <span class="function"><span class="params">progressEvent</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`ä¸‹è½½è¿›åº¦: <span class="subst">$&#123;progressEvent.loaded&#125;</span> å­—èŠ‚`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">axios.<span class="title function_">get</span>(<span class="string">&#x27;https://example.com/bigfile&#x27;</span>, &#123; <span class="attr">responseType</span>: <span class="string">&#x27;stream&#x27;</span> &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> total = <span class="number">0</span>;</span><br><span class="line">    response.<span class="property">data</span>.<span class="title function_">on</span>(<span class="string">&#x27;data&#x27;</span>, <span class="function"><span class="params">chunk</span> =&gt;</span> &#123;</span><br><span class="line">      total += chunk.<span class="property">length</span>;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`ä¸‹è½½è¿›åº¦: <span class="subst">$&#123;total&#125;</span> å­—èŠ‚`</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
<h1 id="body-parserè§£æè¯·æ±‚ä½“ï¼ˆExpress-ä¸­å¸¸ç”¨ï¼‰"><a href="#body-parserè§£æè¯·æ±‚ä½“ï¼ˆExpress-ä¸­å¸¸ç”¨ï¼‰" class="headerlink" title="body-parser	è§£æè¯·æ±‚ä½“ï¼ˆExpress ä¸­å¸¸ç”¨ï¼‰"></a>body-parser	è§£æè¯·æ±‚ä½“ï¼ˆExpress ä¸­å¸¸ç”¨ï¼‰</h1><ul>
<li>ä½œç”¨ï¼šåœ¨ Express ä¸­ï¼Œé»˜è®¤ æ— æ³•è¯»å– req.bodyï¼Œéœ€è¦ body-parser è¿™ä¸ªä¸­é—´ä»¶æ¥è§£æ</li>
<li>å®‰è£…<code>npm i ...</code><br>æ›´æ–°ï¼šExpress 4.16+ å†…ç½®äº†æ›¿ä»£æ–¹æ¡ˆï¼ä» Express 4.16 èµ·ï¼Œå¯ä»¥ä¸ç”¨å•ç‹¬è£… body-parserï¼Œç›´æ¥ä½¿ç”¨å³å¯ï¼ŒæŠŠbodyParseræ”¹ä¸ºexpress</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>())</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">true</span> &#125;))</span><br></pre></td></tr></table></figure>
<ul>
<li>ä½¿ç”¨</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">body</span>) <span class="comment">// âŒ é»˜è®¤æ˜¯ undefined</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// è§£æ application/json ç±»å‹çš„è¯·æ±‚ä½“</span></span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">json</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment">// è§£æ application/x-www-form-urlencodedï¼ˆè¡¨å•ï¼‰ç±»å‹</span></span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">true</span> &#125;))</span><br><span class="line"><span class="comment">//ç»Ÿä¸€å°±å†™æ­»æˆtrue </span></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">body</span>) <span class="comment">// âœ… æ­£å¸¸æ‰“å°å¯¹è±¡</span></span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ç™»å½•æˆåŠŸ&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="commander"><a href="#commander" class="headerlink" title="commander"></a>commander</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install commander</span><br></pre></td></tr></table></figure>
<ul>
<li>ä½œç”¨<br>å‘½ä»¤è¡Œå·¥å…·æ„å»ºåº“<br>å®šä¹‰å‘½ä»¤è¡Œå‘½ä»¤ï¼ˆå¦‚ï¼šinitã€buildï¼‰<br>è§£æå‚æ•°ï¼ˆå¦‚ï¼šâ€“forceã€-o outputï¼‰<br>è‡ªåŠ¨ç”Ÿæˆ â€“help å¸®åŠ©æ–‡æ¡£<br>ç›‘å¬ä¸åŒå‘½ä»¤çš„å›è°ƒå‡½æ•°</li>
<li>ä½¿ç”¨</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// cli.js</span></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Command</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;commander&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> program = <span class="keyword">new</span> <span class="title class_">Command</span>()</span><br><span class="line"></span><br><span class="line">program</span><br><span class="line">  .<span class="title function_">name</span>(<span class="string">&#x27;mycli&#x27;</span>)</span><br><span class="line">  .<span class="title function_">description</span>(<span class="string">&#x27;ä¸€ä¸ªè‡ªå®šä¹‰ CLI å·¥å…·&#x27;</span>)</span><br><span class="line">  .<span class="title function_">version</span>(<span class="string">&#x27;1.0.0&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰å‘½ä»¤ mycli init</span></span><br><span class="line">program</span><br><span class="line">  .<span class="title function_">command</span>(<span class="string">&#x27;init&#x27;</span>)</span><br><span class="line">  .<span class="title function_">description</span>(<span class="string">&#x27;åˆå§‹åŒ–é¡¹ç›®&#x27;</span>)</span><br><span class="line">  .<span class="title function_">option</span>(<span class="string">&#x27;-f, --force&#x27;</span>, <span class="string">&#x27;æ˜¯å¦å¼ºåˆ¶åˆå§‹åŒ–&#x27;</span>)</span><br><span class="line">  .<span class="title function_">action</span>(<span class="function">(<span class="params">options</span>) =&gt;</span> &#123;</span><br><span class="line">  	<span class="built_in">require</span>(<span class="string">&#x27;./commands/init&#x27;</span>)(options)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;åˆå§‹åŒ–é¡¹ç›®ï¼Œå‚æ•°:&#x27;</span>, options)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è§£æå‘½ä»¤è¡Œå‚æ•°</span></span><br><span class="line">program.<span class="title function_">parse</span>(process.<span class="property">argv</span>)</span><br><span class="line">program.<span class="title function_">parse</span>() <span class="comment">// é»˜è®¤ä½¿ç”¨ process.argv</span></span><br><span class="line"><span class="comment">//å¦‚æœä½ ä¸è°ƒç”¨ program.parse()ï¼Œå‘½ä»¤å’Œé€‰é¡¹éƒ½ä¸ä¼šç”Ÿæ•ˆã€‚</span></span><br><span class="line">program.<span class="title function_">parse</span>([<span class="string">&#x27;node&#x27;</span>, <span class="string">&#x27;cli.js&#x27;</span>, <span class="string">&#x27;start&#x27;</span>, <span class="string">&#x27;--debug&#x27;</span>]);<span class="comment">//ä¼ å…¥è‡ªå®šä¹‰å‚æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å¤šä¸ªå‘½ä»¤</span></span><br><span class="line">program</span><br><span class="line">  .<span class="title function_">command</span>(<span class="string">&#x27;build&#x27;</span>)</span><br><span class="line">  .<span class="title function_">description</span>(<span class="string">&#x27;æ„å»ºé¡¹ç›®&#x27;</span>)</span><br><span class="line">  .<span class="title function_">option</span>(<span class="string">&#x27;-o, --output &lt;path&gt;&#x27;</span>, <span class="string">&#x27;è¾“å‡ºè·¯å¾„&#x27;</span>, <span class="string">&#x27;./dist&#x27;</span>)</span><br><span class="line">  .<span class="title function_">action</span>(<span class="function">(<span class="params">options</span>) =&gt;</span> &#123;</span><br><span class="line">  	<span class="built_in">require</span>(<span class="string">&#x27;./commands/build&#x27;</span>)(options)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æ„å»ºé¡¹ç›®ï¼Œè¾“å‡ºåˆ°:&#x27;</span>, options.<span class="property">output</span>)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// export å‘½ä»¤</span></span><br><span class="line">program</span><br><span class="line">  .<span class="title function_">command</span>(<span class="string">&#x27;export&#x27;</span>)</span><br><span class="line">  .<span class="title function_">description</span>(<span class="string">&#x27;å¯¼å‡º HTML&#x27;</span>)</span><br><span class="line">  .<span class="title function_">option</span>(<span class="string">&#x27;-t, --theme &lt;name&gt;&#x27;</span>, <span class="string">&#x27;ä½¿ç”¨çš„ä¸»é¢˜&#x27;</span>)</span><br><span class="line">  .<span class="title function_">action</span>(<span class="function">(<span class="params">options</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">require</span>(<span class="string">&#x27;./commands/export&#x27;</span>)(options)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">program.<span class="title function_">parse</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">//é»˜è®¤å‘½ä»¤ å‰æï¼šå¦‚å‰é¢æ‰€ç¤ºprogramåŸºæœ¬ä¿¡æ¯å’Œåé¢å‘½ä»¤/å‚æ•°åˆ†å¼€</span></span><br><span class="line">program</span><br><span class="line">  .<span class="title function_">action</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ä½ æ²¡æœ‰è¾“å…¥å‘½ä»¤ï¼Œæ˜¾ç¤ºå¸®åŠ©ï¼š&#x27;</span>)</span><br><span class="line">    program.<span class="title function_">help</span>()</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="comment">//å¸®åŠ©ä¿¡æ¯è‡ªåŠ¨ç”Ÿæˆï¼Œä¸éœ€è¦æ‰‹åŠ¨å†™</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ”¯æŒä¼ å‚</span></span><br><span class="line">program</span><br><span class="line">  .<span class="title function_">command</span>(<span class="string">&#x27;add &lt;name&gt;&#x27;</span>)</span><br><span class="line">  .<span class="title function_">description</span>(<span class="string">&#x27;æ·»åŠ ä¸€ä¸ªç»„ä»¶&#x27;</span>)</span><br><span class="line">  .<span class="title function_">action</span>(<span class="function">(<span class="params">name</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æ·»åŠ ç»„ä»¶:&#x27;</span>, name)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">.<span class="title function_">command</span>(<span class="string">&#x27;export [file]&#x27;</span>)</span><br><span class="line">.<span class="title function_">action</span>(<span class="function">(<span class="params">file, options</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// file æ˜¯å¯¼å‡ºçš„æ–‡ä»¶å</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//package.jsonä¸­è¦é…ç½®å¥½</span></span><br><span class="line"><span class="string">&quot;bin&quot;</span>: &#123;</span><br><span class="line">  <span class="string">&quot;mycli&quot;</span>: <span class="string">&quot;./cli.js&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>åº”ç”¨ï¼šWebpack å’Œ Vite æœ¬è´¨ä¸Šå°±æ˜¯ CLIï¼ˆå‘½ä»¤è¡Œå·¥å…·ï¼‰ï¼Œä½†å®ƒä»¬è¿œä¸æ­¢äºæ­¤â€”â€”å®ƒä»¬ä¸ä»…æ˜¯å‘½ä»¤è¡Œå·¥å…·ï¼Œæ›´æ˜¯æ„å»ºå·¥å…·ã€æ¨¡å—æ‰“åŒ…å™¨ã€å¼€å‘æœåŠ¡å™¨ã€æ’ä»¶å¹³å°ã€æ¨¡å—è§£æä¸ä¼˜åŒ–	ã€ç¼–è¯‘å™¨é›†æˆã€‚</li>
</ul>
<h1 id="inquirer-è¯¢é—®-æ­é…commander"><a href="#inquirer-è¯¢é—®-æ­é…commander" class="headerlink" title="inquirer è¯¢é—® æ­é…commander"></a>inquirer è¯¢é—® æ­é…commander</h1><p>åœ¨ commander ä¸­æœ¬èº«ä¸æ”¯æŒäº¤äº’å¼é€‰æ‹©ï¼Œå®ƒä¸»è¦ç”¨äºè§£æå‘½ä»¤è¡Œå‚æ•°ã€‚ä½†ä½ å¯ä»¥ç»“åˆå¦ä¸€ä¸ªåº“ â€”â€” inquirer æ¥å®ç°å‘½ä»¤è¡Œä¸­çš„â€œè¯¢é—®â€å’Œâ€œé€‰æ‹©â€åŠŸèƒ½ï¼Œæ¯”å¦‚è®©ç”¨æˆ·é€‰æ‹©ä¸€ä¸ªé€‰é¡¹ã€è¾“å…¥æ–‡æœ¬ã€ç¡®è®¤æ“ä½œç­‰ã€‚</p>
<ul>
<li>ä½¿ç”¨<br>input	æ–‡æœ¬è¾“å…¥<br>number	æ•°å­—è¾“å…¥<br>confirm	æ˜¯&#x2F;å¦ç¡®è®¤<br>list	å•é€‰åˆ—è¡¨ï¼ˆä¸Šä¸‹é”®é€‰æ‹©ï¼‰<br>rawlist	æ•°å­—é€‰æ‹©ï¼ˆè¾“å…¥æ•°å­—ï¼‰<br>expand	å¿«æ·é”®é€‰æ‹©ï¼ˆæŒ‰å­—æ¯ï¼‰<br>checkbox	å¤šé€‰åˆ—è¡¨ï¼ˆç©ºæ ¼é€‰æ‹©ï¼‰<br>password	å¯†ç è¾“å…¥ï¼ˆéšè—å­—ç¬¦ï¼‰<br>editor	æ‰“å¼€ç³»ç»Ÿç¼–è¾‘å™¨è¾“å…¥å†…å®¹<br>validate: éªŒè¯ç”¨æˆ·è¾“å…¥æ˜¯å¦åˆæ³•<br>filter: å¤„ç†ç”¨æˆ·è¾“å…¥ï¼ˆå¦‚è½¬æˆå¤§å†™ï¼‰<br>when: æ¡ä»¶æé—®ï¼ˆæ ¹æ®å‰é¢å›ç­”å†³å®šæ˜¯å¦æé—®ï¼‰<br>default: è®¾ç½®é»˜è®¤å€¼<br>transformer: ç¾åŒ–æ˜¾ç¤ºå†…å®¹</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Command</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;commander&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> inquirer = <span class="built_in">require</span>(<span class="string">&#x27;inquirer&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> program = <span class="keyword">new</span> <span class="title class_">Command</span>();</span><br><span class="line"></span><br><span class="line">program</span><br><span class="line">  .<span class="title function_">command</span>(<span class="string">&#x27;init&#x27;</span>)</span><br><span class="line">  .<span class="title function_">description</span>(<span class="string">&#x27;åˆå§‹åŒ–é¡¹ç›®&#x27;</span>)</span><br><span class="line">  .<span class="title function_">action</span>(<span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> answers = <span class="keyword">await</span> inquirer.<span class="title function_">prompt</span>([</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;list&#x27;</span>,</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;framework&#x27;</span>,</span><br><span class="line">        <span class="attr">message</span>: <span class="string">&#x27;è¯·é€‰æ‹©ä½ è¦ä½¿ç”¨çš„æ¡†æ¶ï¼š&#x27;</span>,</span><br><span class="line">        <span class="attr">choices</span>: [<span class="string">&#x27;React&#x27;</span>, <span class="string">&#x27;Vue&#x27;</span>, <span class="string">&#x27;Svelte&#x27;</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;confirm&#x27;</span>,</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;typescript&#x27;</span>,</span><br><span class="line">        <span class="attr">message</span>: <span class="string">&#x27;æ˜¯å¦å¯ç”¨ TypeScriptï¼Ÿ&#x27;</span>,</span><br><span class="line">        <span class="attr">default</span>: <span class="literal">true</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ]);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ä½ çš„é€‰æ‹©ï¼š&#x27;</span>, answers);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">program.<span class="title function_">parse</span>();</span><br></pre></td></tr></table></figure>
<h1 id="chokidar"><a href="#chokidar" class="headerlink" title="chokidar"></a>chokidar</h1><ul>
<li>ä½œç”¨<br>é«˜æ•ˆã€è·¨å¹³å°çš„ æ–‡ä»¶ç›‘å¬åº“ï¼ŒåŸºäºåº•å±‚ fs.watch å’Œ fs.watchFileï¼Œä½†åšäº†å¤§é‡å…¼å®¹æ€§å¢å¼ºå’Œæ€§èƒ½ä¼˜åŒ–ã€‚</li>
<li>ä½¿ç”¨</li>
</ul>
<table>
<thead>
<tr>
<th>äº‹ä»¶å</th>
<th>è§¦å‘æ—¶æœº</th>
</tr>
</thead>
<tbody><tr>
<td><code>add</code></td>
<td>æ–‡ä»¶è¢«æ–°å¢</td>
</tr>
<tr>
<td><code>addDir</code></td>
<td>æ–‡ä»¶å¤¹è¢«æ–°å¢</td>
</tr>
<tr>
<td><code>change</code></td>
<td>æ–‡ä»¶å†…å®¹å‘ç”Ÿå˜åŒ–</td>
</tr>
<tr>
<td><code>unlink</code></td>
<td>æ–‡ä»¶è¢«åˆ é™¤</td>
</tr>
<tr>
<td><code>unlinkDir</code></td>
<td>æ–‡ä»¶å¤¹è¢«åˆ é™¤</td>
</tr>
<tr>
<td><code>ready</code></td>
<td>åˆå§‹æ‰«æå®Œæˆ</td>
</tr>
<tr>
<td><code>error</code></td>
<td>å‡ºç°é”™è¯¯</td>
</tr>
</tbody></table>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> chokidar = <span class="built_in">require</span>(<span class="string">&#x27;chokidar&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–ç›‘å¬å™¨ï¼Œç›‘å¬æŸä¸ªæ–‡ä»¶æˆ–ç›®å½•</span></span><br><span class="line"><span class="keyword">const</span> watcher = chokidar.<span class="title function_">watch</span>(<span class="string">&#x27;src/**/*.md&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">ignored</span>: <span class="regexp">/(^|[\/\\])\../</span>, <span class="comment">// å¿½ç•¥éšè—æ–‡ä»¶</span></span><br><span class="line">  <span class="comment">//.å¼€å¤´çš„éšè—æ–‡ä»¶ æˆ–è€…æ˜¯æ–‡ä»¶å¤¹é‡Œé¢çš„.å¼€å¤´çš„éšè—æ–‡ä»¶</span></span><br><span class="line">  <span class="attr">persistent</span>: <span class="literal">true</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›‘å¬äº‹ä»¶</span></span><br><span class="line">watcher</span><br><span class="line">  .<span class="title function_">on</span>(<span class="string">&#x27;add&#x27;</span>, <span class="function"><span class="params">path</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`ğŸ“„ æ–°å¢æ–‡ä»¶: <span class="subst">$&#123;path&#125;</span>`</span>))</span><br><span class="line">  .<span class="title function_">on</span>(<span class="string">&#x27;change&#x27;</span>, <span class="function"><span class="params">path</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`âœï¸  æ–‡ä»¶å˜åŠ¨: <span class="subst">$&#123;path&#125;</span>`</span>))</span><br><span class="line">  .<span class="title function_">on</span>(<span class="string">&#x27;unlink&#x27;</span>, <span class="function"><span class="params">path</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`âŒ åˆ é™¤æ–‡ä»¶: <span class="subst">$&#123;path&#125;</span>`</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> watcher = chokidar.<span class="title function_">watch</span>(<span class="string">&#x27;src&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">ignored</span>: <span class="regexp">/node_modules/</span>,</span><br><span class="line">  <span class="attr">persistent</span>: <span class="literal">true</span>,<span class="comment">//æŒç»­åœ¨åå°è¿è¡Œ ä¸è‡ªåŠ¨é€€å‡º</span></span><br><span class="line">  <span class="attr">ignoreInitial</span>: <span class="literal">false</span>,     <span class="comment">// æ˜¯å¦å¿½ç•¥ç¬¬ä¸€æ¬¡åŠ è½½æ—¶è§¦å‘çš„ add äº‹ä»¶</span></span><br><span class="line">  <span class="attr">usePolling</span>: <span class="literal">false</span>,        <span class="comment">// å¦‚æœ trueï¼Œå¼ºåˆ¶ä½¿ç”¨è½®è¯¢ï¼ˆæ€§èƒ½è¾ƒå·®ï¼Œå…¼å®¹æŸäº›å¹³å°ï¼‰</span></span><br><span class="line">  <span class="attr">interval</span>: <span class="number">100</span>,            <span class="comment">// è½®è¯¢é—´éš”ï¼ˆä»…å½“ usePolling ä¸º trueï¼‰</span></span><br><span class="line">  <span class="attr">awaitWriteFinish</span>: &#123;</span><br><span class="line">    <span class="attr">stabilityThreshold</span>: <span class="number">200</span>,<span class="comment">//å¤šä¹…æ²¡æœ‰å˜åŒ–å°±è®¤ä¸ºå†™å…¥å®Œæˆ</span></span><br><span class="line">    <span class="attr">pollInterval</span>: <span class="number">100</span> <span class="comment">//æ£€æµ‹å†™å…¥å˜åŒ–çš„é¢‘ç‡</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">watcher.<span class="title function_">on</span>(<span class="string">&#x27;change&#x27;</span>, <span class="function">(<span class="params">path</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> content = fs.<span class="title function_">readFileSync</span>(path, <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">  socket.<span class="title function_">emit</span>(<span class="string">&#x27;update&#x27;</span>, content) <span class="comment">// é…åˆ socket.io å®ç°çƒ­æ›´æ–°</span></span><br><span class="line">&#125;)</span><br><span class="line">watcher.<span class="title function_">on</span>(<span class="string">&#x27;change&#x27;</span>, <span class="function">(<span class="params">filePath</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> html = <span class="title function_">render</span>(fs.<span class="title function_">readFileSync</span>(filePath, <span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">  io.<span class="title function_">emit</span>(<span class="string">&#x27;reload&#x27;</span>, html)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//è‡ªåŠ¨é‡æ–°æ„å»º</span></span><br><span class="line">watcher.<span class="title function_">on</span>(<span class="string">&#x27;change&#x27;</span>, <span class="function">(<span class="params">filePath</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">build</span>(filePath)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="open"><a href="#open" class="headerlink" title="open"></a>open</h1><ul>
<li>ç‰ˆæœ¬<br>open@10+ é»˜è®¤å¯¼å‡ºæ˜¯ ESMï¼ˆexport defaultï¼‰ï¼Œä½ ç”¨ require() ä¼šæŠ¥é”™ï¼Œå¦‚æœä½ ç”¨çš„æ˜¯ type: â€œmoduleâ€ æˆ– .mjsï¼Œç›´æ¥<code> import chalk from &#39;chalk&#39;</code><br>å¦‚æœé¡¹ç›®æ˜¯ CommonJSï¼Œå¯ä»¥ä½¿ç”¨ open@9</li>
<li>ä½œç”¨<br> Node.js ç¬¬ä¸‰æ–¹åº“ï¼Œå¯ä»¥å¸®ä½  åœ¨é»˜è®¤ç¨‹åºä¸­æ‰“å¼€ URLã€æ–‡ä»¶ã€ç›®å½•ã€åº”ç”¨ç¨‹åºç­‰ã€‚open ä¼šè‡ªåŠ¨åˆ¤æ–­å½“å‰å¹³å°ï¼ˆWindows&#x2F;macOS&#x2F;Linuxï¼‰æ¥é€‰æ‹©åˆé€‚çš„ç³»ç»Ÿè°ƒç”¨ï¼Œæ— éœ€ä½ æ‰‹åŠ¨å¤„ç†è·¨å¹³å°é—®é¢˜ã€‚<br> å¸¸ç”¨äº CLI å·¥å…·ä¸­ï¼Œæ¯”å¦‚ vite å¯åŠ¨åè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ï¼šå°±æ˜¯ç”¨ open(â€˜<a target="_blank" rel="noopener" href="http://localhost:3000/">http://localhost:3000</a>â€˜) å®ç°çš„ã€‚</li>
<li>ä½¿ç”¨</li>
</ul>
<table>
<thead>
<tr>
<th>æ‰“å¼€ç±»å‹</th>
<th>ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td>æ‰“å¼€ç½‘é¡µ</td>
<td><code>open(&#39;https://google.com&#39;)</code></td>
</tr>
<tr>
<td>æ‰“å¼€æœ¬åœ°æ–‡ä»¶</td>
<td><code>open(&#39;README.md&#39;)</code></td>
</tr>
<tr>
<td>æ‰“å¼€æœ¬åœ°ç›®å½•</td>
<td><code>open(&#39;.&#39;)</code></td>
</tr>
<tr>
<td>æ‰“å¼€åº”ç”¨ç¨‹åº</td>
<td><code>open(&#39;https://google.com&#39;, &#123; app: &#39;firefox&#39; &#125;)</code></td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td><code>app.name</code></td>
<td>æŒ‡å®šæ‰“å¼€çš„åº”ç”¨åï¼ˆå¦‚ <code>chrome</code>, <code>firefox</code>, <code>code</code>, <code>sublime</code>ï¼‰</td>
</tr>
<tr>
<td><code>app.arguments</code></td>
<td>ä¼ ç»™åº”ç”¨çš„å‚æ•°ï¼ˆå¦‚æ‰“å¼€æ— ç—•ã€æŒ‡å®šçª—å£ç­‰ï¼‰</td>
</tr>
<tr>
<td><code>wait</code></td>
<td>æ˜¯å¦ç­‰å¾…ç¨‹åºé€€å‡ºï¼ˆé»˜è®¤ <code>false</code>ï¼‰</td>
</tr>
<tr>
<td><code>newInstance</code></td>
<td>æ˜¯å¦å¼ºåˆ¶æ–°å¼€ä¸€ä¸ªç¨‹åºå®ä¾‹</td>
</tr>
</tbody></table>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> open <span class="keyword">from</span> <span class="string">&#x27;open&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨é»˜è®¤æµè§ˆå™¨ä¸­æ‰“å¼€ URL</span></span><br><span class="line"><span class="keyword">await</span> <span class="title function_">open</span>(<span class="string">&#x27;https://example.com&#x27;</span>)</span><br><span class="line"><span class="comment">// æ‰“å¼€é¡¹ç›®ç›®å½•</span></span><br><span class="line"><span class="keyword">await</span> <span class="title function_">open</span>(<span class="string">&#x27;./my-project&#x27;</span>)</span><br><span class="line"><span class="comment">// æ‰“å¼€ Markdown æ–‡ä»¶ï¼ˆé»˜è®¤ç¼–è¾‘å™¨æˆ–é¢„è§ˆï¼‰</span></span><br><span class="line"><span class="keyword">await</span> <span class="title function_">open</span>(<span class="string">&#x27;./README.md&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> open = <span class="built_in">require</span>(<span class="string">&#x27;open&#x27;</span>)</span><br><span class="line"><span class="title function_">open</span>(<span class="string">&#x27;https://example.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰“å¼€ VSCode</span></span><br><span class="line"><span class="keyword">await</span> <span class="title function_">open</span>(<span class="string">&#x27;.&#x27;</span>, &#123; <span class="attr">app</span>: &#123; <span class="attr">name</span>: <span class="string">&#x27;code&#x27;</span> &#125; &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰“å¼€ Chrome å¹¶ä¼ å‚</span></span><br><span class="line"><span class="keyword">await</span> <span class="title function_">open</span>(<span class="string">&#x27;https://example.com&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">app</span>: &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;google chrome&#x27;</span>,</span><br><span class="line">    <span class="attr">arguments</span>: [<span class="string">&#x27;--new-window&#x27;</span>]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="chalk"><a href="#chalk" class="headerlink" title="chalk"></a>chalk</h1><ul>
<li>ç‰ˆæœ¬<br>ä» v5 èµ·ï¼Œchalk æ˜¯ ESM-onlyï¼ˆåªèƒ½ç”¨ importï¼‰ï¼Œå¦‚æœä½ é¡¹ç›®æ˜¯ CommonJSï¼Œæ¨èä½¿ç”¨ v4 <code>npm install chalk@4 </code></li>
<li>ä½œç”¨ï¼šç»™ å‘½ä»¤è¡Œæ–‡æœ¬æ·»åŠ é¢œè‰²å’Œæ ·å¼</li>
<li>ä½¿ç”¨</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ESM å†™æ³•ï¼ˆv5+ï¼‰</span></span><br><span class="line"><span class="keyword">import</span> chalk <span class="keyword">from</span> <span class="string">&#x27;chalk&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡ºå½©è‰²æ–‡å­—</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(chalk.<span class="title function_">green</span>(<span class="string">&#x27;æˆåŠŸï¼&#x27;</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(chalk.<span class="title function_">red</span>(<span class="string">&#x27;é”™è¯¯ï¼&#x27;</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(chalk.<span class="title function_">yellow</span>(<span class="string">&#x27;è­¦å‘Šï¼&#x27;</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(chalk.<span class="title function_">blue</span>(<span class="string">&#x27;ä¿¡æ¯&#x27;</span>))</span><br><span class="line"><span class="comment">//é“¾å¼è°ƒç”¨</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(chalk.<span class="property">bold</span>.<span class="title function_">red</span>(<span class="string">&#x27;åŠ ç²—çº¢è‰²&#x27;</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(chalk.<span class="property">bgYellow</span>.<span class="title function_">black</span>(<span class="string">&#x27;é»‘å­—é»„åº•&#x27;</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(chalk.<span class="property">underline</span>.<span class="title function_">green</span>(<span class="string">&#x27;ä¸‹åˆ’çº¿ç»¿è‰²&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">//å˜é‡å®šä¹‰ å°è£…success/error/info</span></span><br><span class="line"><span class="keyword">const</span> error = chalk.<span class="property">bold</span>.<span class="property">red</span></span><br><span class="line"><span class="keyword">const</span> warning = chalk.<span class="title function_">hex</span>(<span class="string">&#x27;#FFA500&#x27;</span>) <span class="comment">// è‡ªå®šä¹‰é¢œè‰²ï¼ˆæ©™è‰²ï¼‰</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">error</span>(<span class="string">&#x27;å‡ºé”™äº†ï¼&#x27;</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">warning</span>(<span class="string">&#x27;è­¦å‘Šï¼šè¯·æ£€æŸ¥é…ç½®æ–‡ä»¶&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> log = <span class="variable language_">console</span>.<span class="property">log</span></span><br><span class="line"><span class="title function_">log</span>(chalk.<span class="property">bold</span>.<span class="title function_">green</span>(<span class="string">&#x27;âœ” æ“ä½œæˆåŠŸ&#x27;</span>))</span><br><span class="line"><span class="title function_">log</span>(chalk.<span class="property">bold</span>.<span class="title function_">yellow</span>(<span class="string">&#x27;âš  è¯·æ£€æŸ¥é…ç½®&#x27;</span>))</span><br><span class="line"><span class="title function_">log</span>(chalk.<span class="property">bold</span>.<span class="title function_">red</span>(<span class="string">&#x27;âœ– å‡ºç°é”™è¯¯&#x27;</span>))</span><br><span class="line">log.<span class="title function_">success</span>(<span class="string">&#x27;æˆåŠŸ&#x27;</span>)</span><br><span class="line">log.<span class="title function_">error</span>(<span class="string">&#x27;å¤±è´¥&#x27;</span>)</span><br><span class="line">log.<span class="title function_">info</span>(<span class="string">&#x27;æç¤º&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¨¡ç‰ˆå­—ç¬¦ä¸²åµŒå…¥é¢œè‰²</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`è¿™æ˜¯ä¸€ä¸ª <span class="subst">$&#123;chalk.green(<span class="string">&#x27;æˆåŠŸ&#x27;</span>)&#125;</span> çš„ä¾‹å­`</span>)</span><br></pre></td></tr></table></figure>
<h1 id="socket-io"><a href="#socket-io" class="headerlink" title="socket.io"></a>socket.io</h1><ul>
<li>ä½œç”¨<br>Node.js å®æ—¶é€šä¿¡åº“ï¼ŒåŸºäº WebSocket å°è£…ï¼Œæä¾›å®¢æˆ·ç«¯-æœåŠ¡ç«¯ä¹‹é—´çš„å…¨åŒå·¥é€šä¿¡èƒ½åŠ›ï¼Œæ”¯æŒè‡ªåŠ¨é‡è¿ã€æ–­çº¿é‡è¯•ã€äº‹ä»¶é€šä¿¡ç­‰ã€‚<br>Socket.IO æ˜¯å»ºç«‹åœ¨ HTTP æˆ– HTTPS åè®®ä¹‹ä¸Šçš„ï¼Œå®ƒéœ€è¦ä¸€ä¸ªåº•å±‚çš„æœåŠ¡å™¨å¯¹è±¡æ¥æŒ‚è½½ WebSocket é€šé“ã€‚æ‰€ä»¥ä½ å¿…é¡»æä¾›ä¸€ä¸ª HTTP Server å®ä¾‹ã€‚<br>Socket.IO å¿…é¡»ä¾é™„åœ¨ HTTP Server ä¸Šè¿è¡Œï¼Œç¡®å®éœ€è¦ä¸€ä¸ª HTTP æœåŠ¡å™¨å¯¹è±¡æ¥åˆå§‹åŒ– Socket.IOï¼Œå¯ä»¥æ‰‹åŠ¨åˆ›å»ºï¼Œä¹Ÿå¯ä»¥ç”¨ Express çš„ app.listen() è¿”å›å€¼æ¥è·å–ã€‚</li>
<li>åº”ç”¨ï¼šå®æ—¶èŠå¤©ã€å®æ—¶æ•°æ®æ¨é€ï¼ˆå¦‚è‚¡ç¥¨&#x2F;ä»·æ ¼æ›´æ–°ï¼‰ã€çƒ­æ›´æ–°ã€å¤šäººååŒç¼–è¾‘</li>
<li>å¯¹æ¯”</li>
</ul>
<table>
<thead>
<tr>
<th>åŠŸèƒ½</th>
<th>WebSocket åŸç”Ÿ</th>
<th>Socket.IO</th>
</tr>
</thead>
<tbody><tr>
<td>è¿æ¥æ¡æ‰‹</td>
<td>æ‰‹åŠ¨ç®¡ç†</td>
<td>è‡ªåŠ¨é‡è¿</td>
</tr>
<tr>
<td>æ¶ˆæ¯ç»“æ„</td>
<td>å­—ç¬¦ä¸² &#x2F; äºŒè¿›åˆ¶</td>
<td><strong>äº‹ä»¶æœºåˆ¶</strong></td>
</tr>
<tr>
<td>å¹¿æ’­æ”¯æŒ</td>
<td>âŒ</td>
<td>âœ…</td>
</tr>
<tr>
<td>å‘½åç©ºé—´ &#x2F; æˆ¿é—´</td>
<td>âŒ</td>
<td>âœ…</td>
</tr>
<tr>
<td>è·¨å¹³å°&#x2F;æµè§ˆå™¨å…¼å®¹æ€§</td>
<td>å·®</td>
<td>å¥½</td>
</tr>
</tbody></table>
<ul>
<li>ä½¿ç”¨</li>
</ul>
<table>
<thead>
<tr>
<th>åŠŸèƒ½</th>
<th>æœåŠ¡ç«¯ï¼ˆsocket.ioï¼‰</th>
<th>å®¢æˆ·ç«¯ï¼ˆsocket.io-clientï¼‰</th>
</tr>
</thead>
<tbody><tr>
<td>è¿æ¥</td>
<td><code>io.on(&#39;connection&#39;, cb)</code></td>
<td><code>io()</code></td>
</tr>
<tr>
<td>å‘é€æ¶ˆæ¯</td>
<td><code>socket.emit(&#39;event&#39;, data)</code></td>
<td><code>socket.emit(&#39;event&#39;, data)</code></td>
</tr>
<tr>
<td>æ¥æ”¶æ¶ˆæ¯</td>
<td><code>socket.on(&#39;event&#39;, cb)</code></td>
<td><code>socket.on(&#39;event&#39;, cb)</code></td>
</tr>
<tr>
<td>å¹¿æ’­æ¶ˆæ¯</td>
<td><code>io.emit(...)</code></td>
<td>N&#x2F;Aï¼ˆç”±æœåŠ¡ç«¯è§¦å‘ï¼‰</td>
</tr>
<tr>
<td>ç§å‘æ¶ˆæ¯</td>
<td><code>socket.to(id).emit(...)</code></td>
<td>N&#x2F;A</td>
</tr>
<tr>
<td>æ–­å¼€è¿æ¥</td>
<td><code>socket.disconnect()</code></td>
<td><code>socket.disconnect()</code></td>
</tr>
</tbody></table>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æœåŠ¡ç«¯</span></span><br><span class="line">npm install socket.<span class="property">io</span></span><br><span class="line"><span class="comment">//å®¢æˆ·ç«¯</span></span><br><span class="line">npm install socket.<span class="property">io</span>-client</span><br><span class="line">æˆ–è€…<span class="variable constant_">HTML</span>å¼•å…¥ &lt;script src=<span class="string">&quot;/socket.io/socket.io.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸¤ç§åˆ›å»ºæ–¹æ³• å‡åŸºäºHTTP</span></span><br><span class="line"><span class="comment">//ç¬¬ä¸€ç§ ä¸‹é¢ä»£ç ä¸­æ˜¾å¼å¯¼å…¥å¹¶åˆ›å»ºhttp server</span></span><br><span class="line"><span class="comment">//ç¬¬äºŒç§ å€ŸåŠ©app.listen</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Server</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;socket.io&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"><span class="keyword">const</span> server = app.<span class="title function_">listen</span>(<span class="number">3000</span>); <span class="comment">// è¿”å›çš„æ˜¯ HTTP Server å®ä¾‹</span></span><br><span class="line"><span class="keyword">const</span> io = <span class="keyword">new</span> <span class="title class_">Server</span>(server);</span><br><span class="line"></span><br><span class="line">io.<span class="title function_">on</span>(<span class="string">&#x27;connection&#x27;</span>, <span class="function"><span class="params">socket</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å®¢æˆ·ç«¯è¿æ¥æˆåŠŸ&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ›å»ºæœåŠ¡ç«¯</span></span><br><span class="line"><span class="comment">// server.js</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Server</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;socket.io&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"><span class="keyword">const</span> server = http.<span class="title function_">createServer</span>(app);</span><br><span class="line"><span class="keyword">const</span> io = <span class="keyword">new</span> <span class="title class_">Server</span>(server, &#123;</span><br><span class="line">  <span class="attr">cors</span>: &#123;</span><br><span class="line">    <span class="attr">origin</span>: <span class="string">&#x27;*&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›‘å¬å®¢æˆ·ç«¯è¿æ¥</span></span><br><span class="line">io.<span class="title function_">on</span>(<span class="string">&#x27;connection&#x27;</span>, <span class="function">(<span class="params">socket</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å®¢æˆ·ç«¯å·²è¿æ¥:&#x27;</span>, socket.<span class="property">id</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">  socket.<span class="title function_">on</span>(<span class="string">&#x27;chat message&#x27;</span>, <span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æ”¶åˆ°æ¶ˆæ¯:&#x27;</span>, msg);</span><br><span class="line">    io.<span class="title function_">emit</span>(<span class="string">&#x27;chat message&#x27;</span>, msg); <span class="comment">// å¹¿æ’­ç»™æ‰€æœ‰å®¢æˆ·ç«¯</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ–­å¼€è¿æ¥</span></span><br><span class="line">  socket.<span class="title function_">on</span>(<span class="string">&#x27;disconnect&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å®¢æˆ·ç«¯æ–­å¼€:&#x27;</span>, socket.<span class="property">id</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:3000&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å®¢æˆ·ç«¯ä»£ç  --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- index.html --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Socket.IO èŠå¤©<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;input&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;è¾“å…¥æ¶ˆæ¯&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;send()&quot;</span>&gt;</span>å‘é€<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;messages&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;/socket.io/socket.io.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> socket = <span class="title function_">io</span>(<span class="string">&#x27;http://localhost:3000&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    socket.<span class="title function_">on</span>(<span class="string">&#x27;chat message&#x27;</span>, <span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> li = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;li&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">      li.<span class="property">textContent</span> = msg;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;messages&#x27;</span>).<span class="title function_">appendChild</span>(li);</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">send</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> input = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;input&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">      socket.<span class="title function_">emit</span>(<span class="string">&#x27;chat message&#x27;</span>, input.<span class="property">value</span>);</span></span><br><span class="line"><span class="language-javascript">      input.<span class="property">value</span> = <span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>çƒ­æ›´æ–°</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æœåŠ¡ç«¯</span></span><br><span class="line"><span class="comment">// ç›‘å¬ .md æ–‡ä»¶å˜åŠ¨å</span></span><br><span class="line">watcher.<span class="title function_">on</span>(<span class="string">&#x27;change&#x27;</span>, <span class="function">(<span class="params">filePath</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> content = fs.<span class="title function_">readFileSync</span>(filePath, <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">  io.<span class="title function_">emit</span>(<span class="string">&#x27;update&#x27;</span>, content)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®¢æˆ·ç«¯</span></span><br><span class="line">socket.<span class="title function_">on</span>(<span class="string">&#x27;update&#x27;</span>, <span class="function">(<span class="params">html</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#app&#x27;</span>).<span class="property">innerHTML</span> = html</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ESM å®¢æˆ·ç«¯</span></span><br><span class="line"><span class="keyword">import</span> &#123; io &#125; <span class="keyword">from</span> <span class="string">&#x27;socket.io-client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> socket = <span class="title function_">io</span>(<span class="string">&#x27;http://localhost:3000&#x27;</span>)</span><br><span class="line"></span><br><span class="line">socket.<span class="title function_">emit</span>(<span class="string">&#x27;hello&#x27;</span>, <span class="string">&#x27;hi from client&#x27;</span>)</span><br><span class="line"></span><br><span class="line">socket.<span class="title function_">on</span>(<span class="string">&#x27;hello&#x27;</span>, <span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æœåŠ¡ç«¯è¯´ï¼š&#x27;</span>, msg)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="æ’ä»¶æœºåˆ¶"><a href="#æ’ä»¶æœºåˆ¶" class="headerlink" title="æ’ä»¶æœºåˆ¶"></a>æ’ä»¶æœºåˆ¶</h1><ul>
<li>ä½œç”¨ï¼šæ”¯æŒç”¨æˆ·è‡ªå®šä¹‰</li>
<li>æ ¸å¿ƒæ€è·¯<br>â€œæ’ä»¶æœºåˆ¶â€ &#x3D; çº¦å®šæ¥å£ + è‡ªåŠ¨è°ƒç”¨<br>åªéœ€è¦ï¼š<br>å…è®¸ç”¨æˆ·ä¼ å…¥æ’ä»¶ï¼ˆæ•°ç»„ï¼‰<br>åœ¨æ¸²æŸ“æ—¶å¾ªç¯è°ƒç”¨è¿™äº›æ’ä»¶ï¼ˆé’©å­ï¼‰<br>æ’ä»¶åªè¦æ»¡è¶³æŸäº›æ–¹æ³•ç­¾åå°±èƒ½å·¥ä½œ</li>
<li>å®šä¹‰æ’ä»¶æ ¼å¼</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//sample_plugin.js</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;my-plugin&#x27;</span>,</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// åœ¨æ¸²æŸ“å‰è°ƒç”¨ï¼Œå¯ä¿®æ”¹åŸå§‹å†…å®¹</span></span><br><span class="line">  <span class="title function_">beforeRender</span>(<span class="params">content, options</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> content</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ¸²æŸ“ä¸º HTML åè°ƒç”¨ï¼Œå¯ä¿®æ”¹ HTML å­—ç¬¦ä¸²</span></span><br><span class="line">  <span class="title function_">afterRender</span>(<span class="params">html, options</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> html</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//example</span></span><br><span class="line"><span class="comment">// plugins/copyright-plugin.js</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;copyright-plugin&#x27;</span>,</span><br><span class="line"></span><br><span class="line">  <span class="title function_">afterRender</span>(<span class="params">html</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> html + <span class="string">`&lt;footer&gt;&lt;p style=&quot;text-align:center;color:#aaa;&quot;&gt;Â© hello 2025 &lt;/p&gt;&lt;/footer&gt;`</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ä¿®æ”¹æ‰§è¡Œæ–‡ä»¶æ¥æ”¯æŒæ’ä»¶æœºåˆ¶ï¼Œå¼•å…¥æ’ä»¶åŠ è½½å™¨.jsï¼Œç”¨å®ƒåŠ è½½æ‰€æœ‰æ’ä»¶ï¼Œå¾ªç¯åˆ†åˆ«åœ¨æ¸²æŸ“å‰&#x2F;æ¸²æŸ“åæ‰§è¡Œå¯¹åº”å‡½æ•°å³beforeRender&#x2F;afterRender</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> loadPlugins = <span class="built_in">require</span>(<span class="string">&#x27;./plugins&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">operator</span>(<span class="params">filePath, theme = <span class="string">&#x27;default&#x27;</span>, pluginPaths = []</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="title class_">Content</span> = fs.<span class="title function_">readFileSync</span>(filePath, <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åŠ è½½æ’ä»¶</span></span><br><span class="line">  <span class="keyword">const</span> plugins = <span class="title function_">loadPlugins</span>(pluginPaths)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ’ä»¶å¤„ç†åŸå§‹å†…å®¹</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> plugin <span class="keyword">of</span> plugins) &#123;</span><br><span class="line">    <span class="keyword">if</span> (plugin.<span class="property">beforeRender</span>) &#123;</span><br><span class="line">      <span class="title class_">Content</span> = plugin.<span class="title function_">beforeRender</span>(<span class="title class_">Content</span>, &#123; theme &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> renderer = <span class="keyword">new</span> <span class="title function_">xx</span>()</span><br><span class="line">  <span class="keyword">let</span> <span class="title class_">NewContent</span> = renderer.<span class="title function_">render</span>(<span class="title class_">Content</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ’ä»¶å¤„ç† HTML å†…å®¹</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> plugin <span class="keyword">of</span> plugins) &#123;</span><br><span class="line">    <span class="keyword">if</span> (plugin.<span class="property">afterRender</span>) &#123;</span><br><span class="line">      <span class="title class_">NewContent</span> = plugin.<span class="title function_">afterRender</span>(<span class="title class_">NewContent</span>, &#123; theme &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> cssPath = <span class="string">`/styles/<span class="subst">$&#123;theme&#125;</span>.css`</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line"><span class="string">&lt;head&gt;</span></span><br><span class="line"><span class="string">  &lt;meta charset=&quot;UTF-8&quot; /&gt;</span></span><br><span class="line"><span class="string">  &lt;title&gt;Preview&lt;/title&gt;</span></span><br><span class="line"><span class="string">  &lt;link rel=&quot;stylesheet&quot; href=&quot;<span class="subst">$&#123;cssPath&#125;</span>&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">  &lt;div class=&quot;content&quot;&gt;</span></span><br><span class="line"><span class="string">    <span class="subst">$&#123;NewContent&#125;</span></span></span><br><span class="line"><span class="string">  &lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = operator</span><br></pre></td></tr></table></figure>
<ul>
<li>åˆ›å»ºæ’ä»¶åŠ è½½å™¨</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//loader.js</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loadPlugins</span>(<span class="params">pluginPaths</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> plugins = []</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> pluginPath <span class="keyword">of</span> pluginPaths) &#123;</span><br><span class="line">    <span class="keyword">const</span> abs = path.<span class="title function_">resolve</span>(process.<span class="title function_">cwd</span>(), pluginPath)</span><br><span class="line">    <span class="keyword">if</span> (fs.<span class="title function_">existsSync</span>(abs)) &#123;</span><br><span class="line">      <span class="keyword">const</span> plugin = <span class="built_in">require</span>(abs)</span><br><span class="line">      plugins.<span class="title function_">push</span>(plugin)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">`âš ï¸ æ’ä»¶ <span class="subst">$&#123;pluginPath&#125;</span> ä¸å­˜åœ¨`</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> plugins</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = loadPlugins</span><br></pre></td></tr></table></figure>
<ul>
<li>æ”¯æŒå‘½ä»¤è¡Œä¼ æ’ä»¶</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä¿®æ”¹CLIæ”¯æŒ--pluginå‚æ•° å¯å¤šæ¬¡</span></span><br><span class="line">.<span class="title function_">option</span>(<span class="string">&#x27;--plugin &lt;path...&gt;&#x27;</span>, <span class="string">&#x27;åŠ è½½æ’ä»¶&#x27;</span>)<span class="comment">//...æ˜¯commanderé‡Œçš„restå‚æ•° </span></span><br></pre></td></tr></table></figure>
<ul>
<li>æ’ä»¶æ³¨å†Œ API	æä¾› use() æ–¹æ³•ï¼Œå†…éƒ¨æ³¨å†Œæ’ä»¶<br>æ–¹æ³•å°è£…æˆç±»</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//lib/pluginManager.js</span></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PluginManager</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">plugins</span> = []</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ³¨å†Œæ’ä»¶</span></span><br><span class="line">  <span class="title function_">use</span>(<span class="params">plugin</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> plugin === <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">plugins</span>.<span class="title function_">push</span>(plugin)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">`æ’ä»¶æ— æ•ˆï¼š<span class="subst">$&#123;plugin&#125;</span>`</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span> <span class="comment">// æ”¯æŒé“¾å¼è°ƒç”¨</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ¸²æŸ“æµç¨‹ï¼Œå†…éƒ¨æŒ‚è½½æ’ä»¶é’©å­</span></span><br><span class="line">  <span class="title function_">render</span>(<span class="params">filePath, theme = <span class="string">&#x27;default&#x27;</span></span>) &#123;</span><br><span class="line">    <span class="comment">//å°è£…beforeRender-&gt;render-&gt;afterRender</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> cssPath = <span class="string">`/styles/<span class="subst">$&#123;theme&#125;</span>.css`</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line"><span class="string">&lt;head&gt;</span></span><br><span class="line"><span class="string">  &lt;meta charset=&quot;UTF-8&quot; /&gt;</span></span><br><span class="line"><span class="string">  &lt;title&gt;Preview&lt;/title&gt;</span></span><br><span class="line"><span class="string">  &lt;link rel=&quot;stylesheet&quot; href=&quot;<span class="subst">$&#123;cssPath&#125;</span>&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">  &lt;div class=&quot;content&quot;&gt;</span></span><br><span class="line"><span class="string">    <span class="subst">$&#123;htmlContent&#125;</span></span></span><br><span class="line"><span class="string">  &lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;`</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">new</span> <span class="title class_">PluginManager</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">const</span> pluginManager = <span class="built_in">require</span>(<span class="string">&#x27;./pluginManager&#x27;</span>)</span><br><span class="line"><span class="comment">// æ³¨å†Œæ’ä»¶</span></span><br><span class="line">pluginManager</span><br><span class="line">  .<span class="title function_">use</span>(<span class="built_in">require</span>(<span class="string">&#x27;./plugins/copyright-plugin&#x27;</span>))</span><br><span class="line">  .<span class="title function_">use</span>(<span class="built_in">require</span>(<span class="string">&#x27;./plugins/toc-plugin&#x27;</span>))</span><br><span class="line"><span class="comment">// æ¸²æŸ“</span></span><br><span class="line"><span class="keyword">const</span> html = pluginManager.<span class="title function_">render</span>(filePath, theme)</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¤ç”¨</span></span><br><span class="line"><span class="keyword">const</span> pluginManager = <span class="built_in">require</span>(<span class="string">&#x27;../lib/pluginManager&#x27;</span>)</span><br><span class="line"><span class="comment">// æ³¨å†Œæ‰€æœ‰ä¼ å…¥çš„æ’ä»¶</span></span><br><span class="line"><span class="keyword">if</span> (options.<span class="property">plugin</span> &amp;&amp; options.<span class="property">plugin</span>.<span class="property">length</span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> pluginPath <span class="keyword">of</span> options.<span class="property">plugin</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> abs = path.<span class="title function_">resolve</span>(process.<span class="title function_">cwd</span>(), pluginPath)</span><br><span class="line">    <span class="keyword">const</span> plugin = <span class="built_in">require</span>(abs)</span><br><span class="line">    pluginManager.<span class="title function_">use</span>(plugin)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (options.<span class="property">export</span>) &#123;<span class="comment">//å¯¼å‡ºæ¸²æŸ“</span></span><br><span class="line">  <span class="keyword">const</span> html = pluginManager.<span class="title function_">render</span>(filePath, options.<span class="property">theme</span>)</span><br><span class="line">  fs.<span class="title function_">writeFileSync</span>(options.<span class="property">export</span>, html)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="comment">// å¯åŠ¨æœåŠ¡å™¨æ—¶ä¹Ÿç”¨ pluginManager.render()</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>æ’ä»¶ç³»ç»Ÿç”Ÿå‘½å‘¨æœŸé’©å­	initã€beforeRenderã€afterRenderã€onError<br>Node.js  æœ¬èº«å¹¶æ²¡æœ‰ç»Ÿä¸€çš„â€œæ’ä»¶ç”Ÿå‘½å‘¨æœŸé’©å­â€æœºåˆ¶ï¼Œä¸åƒ Webpackã€Fastifyã€Nuxt ç­‰æ¡†æ¶é‚£æ ·æä¾›æ ‡å‡†åŒ–çš„é’©å­ç³»ç»Ÿã€‚ä½†åœ¨ Node.js  çš„ç”Ÿæ€ä¸­ï¼Œå¾ˆå¤šæ¡†æ¶å’Œå·¥å…·éƒ½å®ç°äº†è‡ªå·±çš„æ’ä»¶æœºåˆ¶å’Œç”Ÿå‘½å‘¨æœŸé’©å­ã€‚<br>æŠŠè¿™äº›æ’ä»¶è‡ªå¸¦çš„é’©å­éƒ½è¡¥è¿› pluginManager.render() ä¸­ï¼Œéå¸¸å¥½æ‰©å±•ã€‚</li>
</ul>
<table>
<thead>
<tr>
<th>ç”Ÿå‘½å‘¨æœŸé’©å­å</th>
<th>è§¦å‘æ—¶æœº</th>
<th>æ˜¯å¦å¼‚æ­¥æ”¯æŒ</th>
</tr>
</thead>
<tbody><tr>
<td><code>init(options)</code></td>
<td>æ’ä»¶åˆå§‹åŒ–æ—¶</td>
<td>æ”¯æŒ</td>
</tr>
<tr>
<td><code>beforeRender(content, options)</code></td>
<td>æ¸²æŸ“å‰</td>
<td>æ”¯æŒ</td>
</tr>
<tr>
<td><code>afterRender(html, options)</code></td>
<td>æ¸²æŸ“å</td>
<td>æ”¯æŒ</td>
</tr>
<tr>
<td><code>onError(err)</code></td>
<td>æ¸²æŸ“å‡ºé”™æ—¶</td>
<td>æ”¯æŒ</td>
</tr>
<tr>
<td><code>onFinish()</code></td>
<td>æ¸²æŸ“æµç¨‹ç»“æŸ</td>
<td>æ”¯æŒ</td>
</tr>
</tbody></table>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">  <span class="title function_">use</span>(<span class="params">plugin</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (plugin &amp;&amp; <span class="keyword">typeof</span> plugin === <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">      <span class="comment">// è°ƒç”¨ init é’©å­</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> plugin.<span class="property">init</span> === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          plugin.<span class="title function_">init</span>()</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">`æ’ä»¶ <span class="subst">$&#123;plugin.name&#125;</span> åˆå§‹åŒ–å¤±è´¥:`</span>, e)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">plugins</span>.<span class="title function_">push</span>(plugin)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`âŒ æ¸²æŸ“å¤±è´¥: <span class="subst">$&#123;err.message&#125;</span>`</span>)</span><br><span class="line"></span><br><span class="line">      <span class="comment">// é”™è¯¯é’©å­</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">const</span> plugin <span class="keyword">of</span> <span class="variable language_">this</span>.<span class="property">plugins</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> plugin.<span class="property">onError</span> === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">          <span class="keyword">try</span> &#123;</span><br><span class="line">            plugin.<span class="title function_">onError</span>(err)</span><br><span class="line">          &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">`æ’ä»¶ <span class="subst">$&#123;plugin.name&#125;</span> onError å¤±è´¥ï¼š`</span>, e)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ¸²æŸ“å®Œæˆé’©å­</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> plugin <span class="keyword">of</span> <span class="variable language_">this</span>.<span class="property">plugins</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> plugin.<span class="property">onFinish</span> === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          plugin.<span class="title function_">onFinish</span>()</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">`æ’ä»¶ <span class="subst">$&#123;plugin.name&#125;</span> onFinish å¤±è´¥ï¼š`</span>, e)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//....</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">new</span> <span class="title class_">PluginManager</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// plugins/dev-logger.js</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;dev-logger&#x27;</span>,</span><br><span class="line"></span><br><span class="line">  <span class="title function_">init</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[dev-logger] æ’ä»¶å·²åŠ è½½&#x27;</span>)</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="title function_">beforeRender</span>(<span class="params">content</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[dev-logger] æ¸²æŸ“å‰å†…å®¹é•¿åº¦ï¼š&#x27;</span>, content.<span class="property">length</span>)</span><br><span class="line">    <span class="keyword">return</span> content</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="title function_">afterRender</span>(<span class="params">html</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[dev-logger] æ¸²æŸ“å HTML é•¿åº¦ï¼š&#x27;</span>, html.<span class="property">length</span>)</span><br><span class="line">    <span class="keyword">return</span> html</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="title function_">onError</span>(<span class="params">err</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;[dev-logger] æ¸²æŸ“å¼‚å¸¸ï¼š&#x27;</span>, err)</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="title function_">onFinish</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[dev-logger] æ¸²æŸ“æµç¨‹å®Œæˆ ğŸ‰&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>æ’ä»¶é»˜è®¤ç›®å½•	è‡ªåŠ¨åŠ è½½ .&#x2F;plugins&#x2F;*.js<br>å°è£…è‡ªåŠ¨åŠ è½½é€»è¾‘</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//lib/loadLocalPlugins.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loadLocalPlugins</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> pluginsDir = path.<span class="title function_">resolve</span>(process.<span class="title function_">cwd</span>(), <span class="string">&#x27;plugins&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> pluginList = []</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!fs.<span class="title function_">existsSync</span>(pluginsDir)) <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> files = fs.<span class="title function_">readdirSync</span>(pluginsDir)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> file <span class="keyword">of</span> files) &#123;</span><br><span class="line">    <span class="keyword">const</span> ext = path.<span class="title function_">extname</span>(file)</span><br><span class="line">    <span class="keyword">if</span> (ext === <span class="string">&#x27;.js&#x27;</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> fullPath = path.<span class="title function_">join</span>(pluginsDir, file)</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> plugin = <span class="built_in">require</span>(fullPath)</span><br><span class="line">        pluginList.<span class="title function_">push</span>(plugin)</span><br><span class="line">      &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">`âš ï¸ æ’ä»¶åŠ è½½å¤±è´¥ï¼š<span class="subst">$&#123;file&#125;</span>`</span>, e)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> pluginList</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = loadLocalPlugins</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ§åˆ¶åŠ è½½é¡ºåº</span></span><br><span class="line"><span class="comment">//åœ¨æ’ä»¶æ–‡ä»¶ä¸­åŠ ä¸€ä¸ª order å­—æ®µ</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;copyright&#x27;</span>,</span><br><span class="line">  <span class="attr">order</span>: <span class="number">10</span>,</span><br><span class="line">  <span class="title function_">afterRender</span>(<span class="params">html</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> html + <span class="string">&#x27;&lt;footer&gt;Â© 2025&lt;/footer&gt;&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//loadLocalPluginsé‡Œæ’åº</span></span><br><span class="line">pluginList.<span class="title function_">sort</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> (a.<span class="property">order</span> || <span class="number">0</span>) - (b.<span class="property">order</span> || <span class="number">0</span>))</span><br></pre></td></tr></table></figure>
<p>æ­é…ä¸Šä¹‹å‰çš„æ‰‹åŠ¨ä¼ å‚ï¼Œå®ç°è‡ªåŠ¨æ‰‹åŠ¨ä¸€èµ·åŠ è½½</p>
<ul>
<li>æ’ä»¶é…ç½®æ–‡ä»¶	æ”¯æŒè¯»å– .previewrc é…ç½®æ–‡ä»¶åŠ è½½æ’ä»¶<br>è®©ç”¨æˆ·é€šè¿‡é¡¹ç›®æ ¹ç›®å½•çš„ .previewrc æ–‡ä»¶è‡ªåŠ¨é…ç½®æ’ä»¶å’Œä¸»é¢˜ï¼Œé¿å…å¤æ‚å‘½ä»¤è¡Œå‚æ•°ã€‚</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ”¯æŒJSONæ ¼å¼</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;theme&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hacker&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;plugins&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;./plugins/copyright-plugin.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;./plugins/toc-plugin.js&quot;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//é…ç½®è¯»å–æ¨¡å— lib/loadConfig.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loadConfig</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> configPath = path.<span class="title function_">resolve</span>(process.<span class="title function_">cwd</span>(), <span class="string">&#x27;.previewrc&#x27;</span>)</span><br><span class="line">  <span class="keyword">if</span> (!fs.<span class="title function_">existsSync</span>(configPath)) <span class="keyword">return</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> raw = fs.<span class="title function_">readFileSync</span>(configPath, <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> config = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(raw)</span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&#x27;âš ï¸ é…ç½®æ–‡ä»¶ .previewrc åŠ è½½å¤±è´¥:&#x27;</span>, e.<span class="property">message</span>)</span><br><span class="line">    <span class="keyword">return</span> &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = loadConfig</span><br><span class="line"></span><br><span class="line"><span class="comment">//è°ƒç”¨åŠ è½½é…ç½®å¹¶åˆå¹¶å‚æ•°</span></span><br><span class="line"><span class="comment">// åŠ è½½ .previewrc</span></span><br><span class="line"><span class="keyword">const</span> rc = <span class="title function_">loadConfig</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå¹¶ theme è®¾ç½®ï¼ˆå‘½ä»¤è¡Œä¼˜å…ˆç”Ÿæ•ˆï¼‰</span></span><br><span class="line"><span class="keyword">const</span> theme = options.<span class="property">theme</span> || rc.<span class="property">theme</span> || <span class="string">&#x27;default&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åŠ è½½æ’ä»¶ï¼ˆæ¥è‡ª CLI å‚æ•° + .previewrc + plugins/ ç›®å½•ï¼‰</span></span><br><span class="line"><span class="keyword">const</span> allPlugins = [</span><br><span class="line">  ...(rc.<span class="property">plugins</span> || []),</span><br><span class="line">  ...(options.<span class="property">plugin</span> || [])</span><br><span class="line">]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

            </div>
        </div>
    </article>

    
    
<nav class="article-nav">
  
  
    <a href="/2025/07/15/nodejs%E4%B8%80%E6%9C%AC%E9%80%9A/" id="article-nav-older" class="article-nav-link-wrap next">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">nodejsä¸€æœ¬é€š</div>
    </a>
  
</nav>

    

    
</div>
    </div>
    <footer class="site-footer">
        <div class="global-width">
            <ul class="site-widget">
                
                <li class="widget widget-tag">
                    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget-body">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/English/" rel="tag">English</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/basics/" rel="tag">basics</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/frontend/" rel="tag">frontend</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/projects/" rel="tag">projects</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tags/" rel="tag">tags</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/test/" rel="tag">test</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

                </li>
                
                <li class="widget widget-category">
                    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/daily-report/">daily_report</a><span class="category-list-count">52</span></li></ul>
    </div>
  </div>

                </li>
                
                <li class="widget widget-recent_posts">
                    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget-body">
      <ul>
        
          <li>
            <a href="/2025/07/16/nodejs%E6%A8%A1%E5%9D%97%E5%A4%A7%E5%85%A8/">nodejsæ¨¡å—å¤§å…¨</a>
          </li>
        
          <li>
            <a href="/2025/07/15/nodejs%E4%B8%80%E6%9C%AC%E9%80%9A/">nodejsä¸€æœ¬é€š</a>
          </li>
        
          <li>
            <a href="/2025/07/14/docker%E4%B8%80%E6%9C%AC%E9%80%9A/">dockerä¸€æœ¬é€š + nginx</a>
          </li>
        
          <li>
            <a href="/2025/07/12/%E5%8C%85%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/">åŒ…ç®¡ç†å·¥å…·</a>
          </li>
        
          <li>
            <a href="/2025/07/11/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E9%80%82%E9%85%8D%E4%B8%8E%E5%93%8D%E5%BA%94%E5%BC%8F%E5%B8%83%E5%B1%80/">ç§»åŠ¨ç«¯é€‚é…ä¸å“åº”å¼å¸ƒå±€</a>
          </li>
        
      </ul>
    </div>
  </div>

                </li>
                
            </ul>
        </div>
        <div class="site-info">
            <address>
                &copy; 2014 <a href="https://70v-yoyo.github.io">Yoyo&#39;s blog</a> All Right Reserved. <br/>
                Powered by <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a>. Theme by <a target="_blank" rel="noopener" href="http://zzoman.com">ZZOMAN</a>
                <p><a target="_blank" href="https://github.com/70v-Yoyo">My github</a></p>
            </address>
        </div>
    </footer> 
    
    
    <script src="/libs/jquery-1.11.3.min.js" type="text/javascript"></script>
    
    <script src="/libs/fancybox/jquery.fancybox.js" type="text/javascript"></script>
    
    <script src="/js/site_init.js" type="text/javascript"></script>
     
    <noscript>
        <style>
            article {
                position: absolute;
                width: 0;
                height: 0;
                overflow: hidden;
                opacity: 0;
            }

        </style>
        <h1>JSå·²è¢«ç¦ç”¨</h1>
    </noscript>
<!-- hexo injector body_end start -->
    <script>
      (function() {
        function moveElementIfSmallScreen() {
          const toc = document.getElementById('fixed-toc-container');
          const article = document.querySelector("article");
          const toggleBtn = document.getElementById('toggle_btn');
          if (!toc || !article) return;
          if (window.innerWidth < 1024 && article.firstElementChild !== toc) {
            console.log('small screen!!')
            
            article.insertBefore(toc, article.firstChild);//ç§»åŠ¨èŠ‚ç‚¹ï¼Œè€Œéå¤åˆ¶
            
            toggleBtn.style.display='none';
            // æ›¿æ¢æ ·å¼ï¼šå–æ¶ˆ fixedï¼Œè®¾ç½®é€‚åˆæ­£æ–‡çš„æ ·å¼
            toc.style.position = 'relative';
            toc.style.top = '';
            toc.style.left = '';
            toc.style.width = '100%';
            toc.style.maxHeight = 'none';
            toc.style.overflowY = 'visible';
            toc.style.overflowX = 'visible';
            toc.style.padding = '1em';
            toc.style.borderLeft = 'none';
            toc.style.borderBottom = '1px solid #ddd';
            toc.style.background = '#f9f9f9';
            toc.style.opacity = '1';
            toc.style.zIndex = '9999';
            toc.style.boxShadow = 'none';
            toc.style.margin = '1rem';
            toc.style.paddingTop= '2rem';
          }
        }
        window.addEventListener("DOMContentLoaded", moveElementIfSmallScreen);
        window.addEventListener("resize", moveElementIfSmallScreen);
      })();
    </script>
  <!-- hexo injector body_end end -->
    <div id="fixed-toc-container" style="
      position: fixed;
      top: 0vh;
      left: 0px;
      width: 15rem;
      max-height: 80vh;
      overflow-y: auto;
      overflow-x: auto;
      padding: 10px;
      border-left: 2px solid #ccc;
      font-size: 14px;
      line-height: 1.5;
      background: #fff;
      opacity:0.8;
      z-index: 9999;
      box-shadow:
        0 2px 4px rgba(0, 0, 0, 0.05),  /* ç¬¬ä¸€å±‚ï¼šè¿‘å¤„æŸ”å’Œ */
        0 8px 16px rgba(0, 0, 0, 0.08); /* ç¬¬äºŒå±‚ï¼šè¿œå¤„æ‰©æ•£ */
    ">
      <strong>Contents</strong>
      <div id="toggle_btn" style="
      position:absolute;
      right:1rem;
      display:inline-block;
      width:2rem;
      text-align:center;
      border:1px solid #ccc;
      "><</div>
      <ul id="fixed-toc-list" style="list-style: none; padding-left: 10px;"></ul>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const nav = document.querySelector('nav');
        if (nav) {
          const navBottom = nav.getBoundingClientRect().bottom;//æµè§ˆå™¨JS API
          console.log('nav bottom:', navBottom);
          // è®¾ç½®tocå…ƒç´  top = nav bottom
          const toc = document.querySelector('#fixed-toc-container');
          if (toc) {
            toc.style.top = navBottom + 'px';
            toc.style.maxHeight=window.innerHeight - navBottom.getBoundingClientRect().bottom;
          }
        }
      });

      const myDiv = document.getElementById('toggle_btn');
      var tocList=document.getElementById("fixed-toc-list");
      var tocContainer=document.getElementById("fixed-toc-container");
      function handleClickBtn() {
        console.log('Div è¢«ç‚¹å‡»äº†ï¼');
        if(myDiv.textContent==='<'){
          myDiv.textContent ='>'
          tocList.style.display='none'
          tocContainer.style.width='11rem'
        }else{
          myDiv.textContent ='<'
          tocList.style.display='block'
          tocContainer.style.width='15rem'
        }
          
      }


      myDiv.addEventListener('click', handleClickBtn);// ç»‘å®šç‚¹å‡»äº‹ä»¶


      (function() {
      const Patternstr = "/*\\d{4}/\\d{2}/\\d{2}/.*"; //æœ¬èº«æ˜¯å­—ç¬¦ä¸²æ’å…¥ï¼Œæ‰€ä»¥å¯¹ç¬¦å·è¦è½¬ä¹‰
      //"^//*"->"/"
      //"/.*"->".*"
      //JSå¼•æ“ä¸­""è½¬ä¹‰
      //æ­£åˆ™è¡¨è¾¾å¼å¼•æ“ä¹Ÿæ˜¯""è½¬ä¹‰
      const dataPattern = new RegExp(Patternstr);
      const path = window.location.pathname;
      console.log(dataPattern.toString(),path,dataPattern.test(path));//æ§åˆ¶å°åœ¨æ¸²æŸ“æ—¶çœç•¥äº†åæ–œæ çš„å¯è§†è¡¨ç¤ºã€‚
      if (!dataPattern.test(path)&&(path==='/'||path==='index.html')) {
        console.log('no toc')
        let toc = document.getElementById('fixed-toc-container');
        if (toc) toc.style.display = 'none';
        return;
      }
        var content = document.querySelector('body');
        console.log('content',content)
        //var tocList = document.getElementById('fixed-toc-list');
        if (!content || !tocList) {
          document.getElementById('fixed-toc-container').style.display = 'none';
          return;
        }
        var headings = content.querySelectorAll('h1, h2, h3, h4');
        console.log('headings',headings)
        if(headings){
          const h1Element=headings[0];
          const rect = h1Element.getBoundingClientRect();
          if(rect.left<150){
           tocContainer.style.right='0px';
           tocContainer.style.left = 'auto'; // ç§»é™¤å†…è”çš„ left æ ·å¼
            //ä¸æ˜¯è®¾ç½®right:0 å°±æ›¿æ¢left:0 éœ€è¦ç§»é™¤
            console.log('to right')
          }
          console.log(rect.left,'150')
        }
        
        if (headings.length === 0) {
          document.getElementById('fixed-toc-container').style.display = 'none';
          return;
        }
        headings.forEach(function(heading, i) {
          if (!heading.id) {
            heading.id = 'heading-' + i;
          }
        });
        headings.forEach(function(heading) {
          var level = parseInt(heading.tagName.substring(1));
          var li = document.createElement('li');
          li.style.marginLeft = (level - 1) * 15 + 'px';
          var a = document.createElement('a');
          a.href = '#' + heading.id;
          a.textContent = heading.textContent;
          a.style.color = '#555';
          a.style.textDecoration = 'none';
          a.onmouseover = function() { a.style.textDecoration = 'underline'; };
          a.onmouseout = function() { a.style.textDecoration = 'none'; };
          li.appendChild(a);
          tocList.appendChild(li);
        });
      })();
    </script>
  </body>
</html>
