<!doctype html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    
    
    <title>JS一本通 | Yoyo&#39;s blog</title>
    
    <link rel="alternative" href="/atom.xml" title="Yoyo&#39;s blog" type="application/atom+xml">
    
    
<link rel="stylesheet" href="/css/style.css">

    
    <link rel="stylesheet" href="/libs/fancybox/jquery.fancybox.css" charset="utf-8">
    
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
<!-- hexo injector head_end start --><script src="./func.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>
<body class="site">
    <!-- 遮罩层 -->
    <div id="mask-layer">
    </div>
    
    <header class="site-header">
        <h1 class="site-title"><a href="/">Yoyo&#39;s blog</a></h1>
        <nav class="site-nav">
            <ul class="nav">
                
                <li><a href="/">Home</a></li>
                
                <li><a href="/archives">Archives</a></li>
                
                
                <li><a href="/atom.xml" title="RSS Feed">rss</a></li>
                
                <li><a class="toggle-search" href="#search">search</a></li>
            </ul>
        </nav>
        <div class="site-search" id="search">
            <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="https://70v-yoyo.github.io"></form>
        </div>
        
            <div class="site-header-background" style="background-image:url('http://reumia.github.io/hexo-theme-zzoman2015/images/background-zzoman2015.jpg')"></div>
        
    </header>
    <div class="site-body">
        <div class="global-width">
    <article class="article" data-layout="post" data-slug="【前端】JS大全">
        <div class="article-content">
            
            
            <header class="article-header">
                <div class="article-meta">
                    <a href="/2025/07/20/%E3%80%90%E5%89%8D%E7%AB%AF%E3%80%91JS%E5%A4%A7%E5%85%A8/" class="article-date">
  <time datetime="2025-07-20T12:04:34.000Z">2025-07-20</time>
</a>
                    
                    
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/frontend/" rel="tag">frontend</a></li></ul>

                </div>
                
    <h1 class="article-title" itemprop="name">
      <a href="/2025/07/20/%E3%80%90%E5%89%8D%E7%AB%AF%E3%80%91JS%E5%A4%A7%E5%85%A8/">JS一本通</a>
    </h1>

            </header>
            
            <div class="article-body">
                <meta name="referrer" content="no-referrer" />

<blockquote>
<p>版本：20250720</p>
</blockquote>
<h1 id="编译器-解释器"><a href="#编译器-解释器" class="headerlink" title="编译器&#x2F;解释器"></a>编译器&#x2F;解释器</h1><p><img src="/images/JS%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0.assets/interpreter.png" alt="image.png"></p>
<ul>
<li>V8如何执行JS代码：有解释器Ignition&#x2F;编译器TurboFan</li>
</ul>
<p><img src="/images/JS%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0.assets/1617151968523-b8c1e108-81ed-4d80-ad35-ccd4550beb4e.png" alt="image.png"></p>
<ol>
<li>生成抽象语法树（AST）和执行上下文</li>
</ol>
<ul>
<li>Babel 的工作原理就是先将 ES6 源码转换为 AST，然后再将 ES6 语法的 AST 转换为 ES5 语法的 AST，最后利用 ES5 的 AST 生成 JavaScript 源代码。</li>
<li>ESLint 是一个用来检查 JavaScript 编写规范的插件，其检测流程也是需要将源码转换为 AST，然后再利用 AST 来检查代码规范化的问题。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myName = <span class="string">&quot; 极客时间 &quot;</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">23</span>;</span><br><span class="line">&#125;</span><br><span class="line">myName = <span class="string">&quot;geektime&quot;</span></span><br><span class="line"><span class="title function_">foo</span>()</span><br></pre></td></tr></table></figure>

<p><img src="/images/JS%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0.assets/1617152020707-6c964841-22a2-4dad-8877-86f93628aa73.png" alt="image.png"></p>
<p>生成 AST 需要经过两个阶段：<strong>第一阶段是分词（tokenize），又称为词法分析</strong>，作用是将一行行的源码拆解成一个个 token。所谓<strong>token</strong>，指的是语法上不可能再分的、最小的单个字符或字符串。<strong>第二阶段是解析（parse），又称为语法分析</strong>，其作用是将上一步生成的 token 数据，根据语法规则转为 AST。如果源码符合语法规则，这一步就会顺利完成。但如果源码存在语法错误，这一步就会终止，并抛出一个“语法错误”。</p>
<ol start="2">
<li>生成字节码</li>
</ol>
<p>一开始 V8 并没有字节码，而是直接将 AST 转换为机器码，由于执行机器码的效率是非常高效的，所以这种方式在发布后的一段时间内运行效果是非常好的。但是随着 Chrome 在手机上的广泛普及，特别是运行在 512M 内存的手机上，内存占用问题也暴露出来了，因为 V8 需要消耗大量的内存来存放转换后的机器码。为了解决内存占用问题，V8 团队大幅重构了引擎架构，引入字节码，并且抛弃了之前的编译器。</p>
<p>**字节码就是介于 AST 和机器码之间的一种代码。需要通过解释器将其转换为机器码后才能执行。**机器码所占用的空间远远超过了字节码，所以使用字节码可以减少系统的内存使用。</p>
<ol start="3">
<li>执行代码</li>
</ol>
<p>如果有一段第一次执行的字节码，解释器 Ignition 会逐条解释执行。在执行字节码的过程中，如果发现有热点代码（HotSpot），比如一段代码被重复执行多次，这种就称为<strong>热点代码</strong>，那么后台的编译器 TurboFan 就会把该段热点的字节码编译为高效的机器码，然后当再次执行这段被优化的代码时，只需要执行编译后的机器码就可以了，这样就大大提升了代码的执行效率。</p>
<p>V8 的解释器和编译器的取名也很有意思。解释器 Ignition 是点火器的意思，编译器 TurboFan 是涡轮增压的意思，寓意着代码启动时通过点火器慢慢发动，一旦启动，涡轮增压介入，其执行效率随着执行时间越来越高效率，因为热点代码都被编译器 TurboFan 转换了机器码，直接执行机器码就省去了字节码“翻译”为机器码的过程。</p>
<p>其实字节码配合解释器和编译器是最近一段时间很火的技术，比如 Java 和 Python 的虚拟机也都是基于这种技术实现的，我们把这种技术称为<strong>即时编译（JIT）</strong>。具体到 V8，就是指解释器 Ignition 在解释执行字节码的同时，收集代码信息，当它发现某一部分代码变热了之后，TurboFan 编译器便闪亮登场，把热点的字节码转换为机器码，并把转换后的机器码保存起来，以备下次使用。</p>
<p><img src="/images/JS%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0.assets/1617152267210-312ecd1f-47e0-4dbd-8b70-cc5d6805606c.png" alt="image.png"></p>
<ul>
<li>DOM树如何生成</li>
</ul>
<p>在渲染引擎内部，有**HTML 解析器（HTMLParser）**模块，负责将 HTML 字节流转换为 DOM 结构。</p>
<p>HTML 解析器并不是等整个文档加载完成之后再解析的，而是<strong>网络进程加载了多少数据，HTML 解析器便解析多少数据</strong>。网络进程接收到响应头之后，根据响应头中的 content-type 字段来判断文件类型，比如 content-type 值是“text&#x2F;html”，那么浏览器判断这是HTML 类型的文件，为该请求选择或者创建一个渲染进程。渲染进程准备好之后，<strong>网络进程和渲染进程之间建立一个共享数据的管道</strong>，网络进程接收到数据后就往这个管道里面放，而渲染进程则从管道的另外一端不断地读取数据，并同时将读取的数据“喂”给 HTML 解析器，动态接收字节流，并将其解析为 DOM。</p>
<p><img src="/images/JS%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0.assets/1617237061187-11f151e3-8cab-4931-96b0-adfb22af351c.png" alt="image.png"></p>
<p>**第一个阶段，通过分词器将字节流转换为 Token。**需要通过分词器先将字节流转换为一个个 Token，分为 Tag Token 和文本 Token。Tag Token 又分 StartTag 和 EndTag，比如<code>&lt;body&gt;</code>就是 StartTag ，<code>&lt;/body&gt;就是EndTag</code>，分别对于图中的蓝色和红色块，文本 Token 对应的绿色块。</p>
<p><strong>后续的第二个和第三个阶段是同步进行的，需要将 Token 解析为 DOM 节点，并将 DOM 节点添加到 DOM 树中。</strong></p>
<p>HTML 解析器维护一个<strong>Token 栈结构</strong>，用来计算节点间的父子关系，在第一个阶段中生成的 Token 会被按照顺序压到这个栈中。具体的处理规则如下所示：</p>
<p>如果压入到栈中的是<strong>StartTag Token</strong>，HTML 解析器会为该 Token 创建一个 DOM 节点，然后将该节点加入到 DOM 树中，它的父节点就是栈中相邻的那个元素生成的节点。</p>
<p>如果分词器解析出来是<strong>文本 Token</strong>，那么会生成一个文本节点，然后将该节点加入到 DOM 树中，文本 Token 是不需要压入到栈中，它的父节点就是当前栈顶 Token 所对应的 DOM 节点。</p>
<p>如果分词器解析出来的是<strong>EndTag 标签</strong>，比如是 EndTag div，HTML 解析器会查看 Token 栈顶的元素是否是 StarTag div，如果是，就将 StartTag div 从栈中弹出，表示该 div 元素解析完成。</p>
<p>通过分词器产生的新 Token 就这样不停地压栈和出栈，整个解析过程就这样一直持续下去，直到分词器将所有字节流分词完成。</p>
<ul>
<li>JS如何影响DOM生成</li>
</ul>
<p>优化：预解析+async&#x2F;defer+CDN+压缩</p>
<p>如果代码里引用了外部的 CSS 文件，那么在执行 JavaScript 之前，还需要等待外部的 CSS 文件下载完成，并解析生成 CSSOM 对象之后，才能执行 JavaScript 脚本。</p>
<p>布局树的结构基本上就是复制 DOM 树的结构，不同之处在于 DOM 树中那些不需要显示的元素会被过滤掉</p>
<p><img src="/images/JS%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0.assets/1617238764637-0f56f635-314a-4db8-bf8b-b2445595710c.png" alt="image.png"></p>
<ul>
<li>渲染引擎生成一帧图像的方式：合成方式优先，因为其步骤短，采用GPU效率高；其次是重绘、重排。</li>
</ul>
<p>为提升每帧渲染效率，Chrome 引入分层和合成机制。</p>
<p>可以把一张网页想象成是由很多个图片叠加在一起的，每个图片就对应一个图层，Chrome 合成器最终将这些图层合成用于显示页面的图片。如 PhotoShop。将素材分解为多个图层的操作就称为<strong>分层</strong>，最后将这些图层合并到一起的操作就称为<strong>合成</strong>。所以，分层和合成通常是一起使用的。</p>
<p>在 Chrome 的渲染流水线中，<strong>分层体现在生成布局树之后</strong>，渲染引擎根据布局树特点将其转换为层树（Layer Tree），层树是渲染流水线后续流程的基础结构。</p>
<p>层树中的每个节点都对应着一个图层，下一步的绘制阶段就依赖于层树中的节点。绘制阶段其实并不是真正地绘出图片，而是将绘制指令组合成一个列表，比如一个图层要设置的背景为黑色，并且还要在中间画一个圆形，那么绘制过程会生成<code>|Paint BackGroundColor:Black | Paint Circle|</code>这样的绘制指令列表，绘制过程就完成了。</p>
<p>有绘制列表之后，就需要进入光栅化阶段了，光栅化就是按照绘制列表中的指令生成图片。每一个图层都对应一张图片，合成线程有了这些图片之后，会将这些图片合成为“一张”图片，并最终将生成的图片发送到后缓冲区。这就是一个大致的分层、合成流程。</p>
<p><strong>需要重点关注的是，合成操作是在合成线程上完成的，不影响到主线程执行</strong>。这就是为什么经常主线程卡住了，但是 CSS 动画依然能执行的原因。</p>
<ul>
<li>分块</li>
</ul>
<p>分层是从宏观上提升渲染效率，那么分块则是从微观层面提升渲染效率。</p>
<p>通常页面内容都要比屏幕大得多，显示页面时，如果等所有图层都生成完毕再合成，会产生不必要开销，时间变久。</p>
<p>因此，合成线程将每个图层分割为大小固定的图块，优先绘制靠近视口的图块，大大加速页面显示速度。不过即使只绘制那些优先级最高的图块，也要耗费不少的时间，因为涉及到一个很关键的因素——<strong>纹理上传</strong>，从计算机内存上传到 GPU 内存的操作慢。</p>
<p>为解决这个问题，Chrome 又采取一个策略：<strong>在首次合成图块使用一个低分辨率图片</strong>，纹理就减少了。首次显示页面内容将低分辨率图片显示出来，合成器继续绘制正常比例的网页内容，绘制完成后再替换掉当前显示的低分辨率内容。</p>
<ul>
<li>利用分层技术优化代码</li>
</ul>
<p>在写 Web 应用的时候，你可能经常需要对某个元素做几何形状变换、透明度变换或者一些缩放操作，如果使用 JavaScript 来写这些效果，会牵涉到整个渲染流水线，所以 JavaScript 的绘制效率会非常低下。</p>
<p>可以使用 will-change 来告诉渲染引擎你会对该元素做一些特效变换。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.<span class="property">box</span> &#123;</span><br><span class="line">	will-<span class="attr">change</span>: transform, opacity;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>提前告诉渲染引擎 box 元素将要做几何变换和透明度变换操作，这时候渲染引擎会将该元素单独实现一帧，等这些变换发生时，渲染引擎会通过合成线程直接去处理变换，不涉及到主线程，提升渲染效率。<strong>这也是 CSS 动画比 JavaScript 动画高效的原因</strong>。</p>
<p>所以，如果涉及可以使用合成线程来处理 CSS 特效&#x2F;动画，尽量使用 will-change 提前告诉渲染引擎，让它为该元素准备独立层。但每当渲染引擎为一个元素准备一个独立层，占用内存也大大增加，因为从层树开始，后续每个阶段都会多一个层结构，都需要额外内存。</p>
<ul>
<li>关键资源：并非所有的资源都会阻塞页面的首次绘制，比如图片、音频、视频等文件就不会阻塞页面的首次渲染；而 JavaScript、首次请求的 HTML 资源文件、CSS 文件是会阻塞首次渲染的，因为在构建 DOM 的过程中需要 HTML 和 JavaScript 文件，在构造渲染树的过程中需要用到 CSS 文件。把<strong>这些能阻塞网页首次渲染的资源称为关键资源</strong>。</li>
<li>RTT：由于 TCP 的特性，这个数据并不是一次传输到服务端的，而是需要拆分成一个个数据包来回多次进行传输的。<strong>RTT 就是这里的往返时延。它是网络中一个重要的性能指标，表示从发送端发送数据开始，到发送端收到来自接收端的确认，总共经历的时延</strong>。通常 1 个 HTTP 的数据包在 14KB 左右，所以 1 个 0.1M 的页面就需要拆分成 8 个包来传输了，也就是说需要 8 个 RTT。</li>
</ul>
<p>由于渲染引擎有一个预解析的线程，在接收到 HTML 数据之后，预解析线程会快速扫描 HTML 数据中的关键资源，一旦扫描到了，会立马发起请求，你可以认为 JavaScript 和 CSS 是同时发起请求的，所以它们的请求是重叠的，那么计算它们的 RTT 时，只需要计算体积最大的那个数据就可以了。</p>
<ul>
<li><p>交互阶段的渲染：通常只有JS触发的交互动画。</p>
<p>大部分情况下，生成一个新的帧都是由 JS 通过修改 DOM 或者 CSSOM 来触发的。还有另外一部分帧是由 CSS 来触发的。</p>
<p>如果在计算样式阶段发现有布局信息的修改，那么就会触发<strong>重排</strong>操作，触发后续渲染流水线的一系列操作，代价非常大。</p>
<p>同样如果在计算样式阶段没有发现有布局信息的修改，只是修改了颜色一类的信息，那么就不会涉及到布局相关的调整，所以可以跳过布局阶段，直接进入绘制阶段，这个过程叫<strong>重绘</strong>。不过重绘阶段的代价也是不小的。</p>
<p>还有另外一种情况，通过 CSS 实现一些变形、渐变、动画等特效，这是由 CSS 触发的，并且是在合成线程上执行的，这个过程称为合成。因为它不会触发重排或者重绘，而且合成操作本身的速度就非常快，所以执行合成是效率最高的方式。</p>
</li>
<li><p>正常布局操作</p>
<p><img src="/images/JS%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0.assets/1617239339930-36d2f021-7ba4-4daf-abb2-cfd19e95bdc5.png" alt="image.png"></p>
<p>从图中可以看出来，执行 JavaScript 添加元素是在一个任务中执行的，重新计算样式布局是在另外一个任务中执行，这就是正常情况下的布局操作。</p>
</li>
<li><p><strong>强制同步布局：JS 强制将计算样式和布局操作提前到当前的任务中</strong>。</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> main_div = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;mian_div&quot;</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(main_div.<span class="property">offsetHeight</span>)</span><br><span class="line"><span class="comment">// ✅为避免强制同步布局，应在修改 DOM 之前查询相关值</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> main_div = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;mian_div&quot;</span>)</span><br><span class="line">    <span class="keyword">let</span> new_node = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;li&quot;</span>)</span><br><span class="line">    <span class="keyword">let</span> textnode = <span class="variable language_">document</span>.<span class="title function_">createTextNode</span>(<span class="string">&quot;time.geekbang&quot;</span>)</span><br><span class="line">    new_node.<span class="title function_">appendChild</span>(textnode);</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;mian_div&quot;</span>).<span class="title function_">appendChild</span>(new_node);</span><br><span class="line"><span class="comment">//❌强制同步布局：下面强加计算样式、布局操作</span></span><br><span class="line"><span class="comment">// 但是此时offsetHeight 还是老数据，所以需要立即执行布局操作</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(main_div.<span class="property">offsetHeight</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/images/JS%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0.assets/1617239339987-3ec52ce2-dde7-4564-bc58-4fcb861d15fe.png" alt="image.png"></p>
<ul>
<li>避免布局抖动：比强制同步布局更坏的情况，那就是布局抖动。是指一次JS执行过程中，多次执行强制布局和抖动操作。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//for循环语句里不断读取属性值，每次读取属性值之前都要进行计算样式和布局。</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> time_li = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;time_li&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">let</span> main_div = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;main_div&quot;</span>)</span><br><span class="line">        <span class="keyword">let</span> new_node = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;li&quot;</span>)</span><br><span class="line">        <span class="keyword">let</span> textnode = <span class="variable language_">document</span>.<span class="title function_">createTextNode</span>(<span class="string">&quot;time.geekbang&quot;</span>)</span><br><span class="line">        new_node.<span class="title function_">appendChild</span>(textnode);</span><br><span class="line">        new_node.<span class="property">offsetHeight</span> = time_li.<span class="property">offsetHeight</span>;</span><br><span class="line">        main_div.<span class="title function_">appendChild</span>(new_node);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/images/JS%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0.assets/1617239339958-b69df0b0-68e2-489f-948d-e11eb808f33f.png" alt="image.png"></p>
<h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><ul>
<li><p>JavaScript严格区分大小写</p>
</li>
<li><p>应用场景：控制硬件-物联网 Ruff、游戏开发 cocos2d-js</p>
</li>
<li><p>JS 包括：</p>
<ul>
<li>ECMAScript是JS的语言标准 如ES6</li>
<li>DOM文档对象模型</li>
<li>BOM浏览器对象模型，包含window，location，screen，history..</li>
</ul>
</li>
<li><p>&#x3D;&#x3D;打印&#x3D;&#x3D;：console.log()简写为c()</p>
</li>
<li><p>&#x3D;&#x3D;引入&#x3D;&#x3D;<br>1、内部  ：放入<code>&lt;head&gt;</code><br><code>&lt;script type=&quot;text/javascript&quot;&gt;js code&lt;/script&gt;</code><br>2、外部：js文件引入 (更方便维护）<br><code>&lt;script type=&quot;text/javascript&quot; src=&quot;...&quot;&gt;&lt;/script&gt; </code></p>
</li>
<li><p>&#x3D;&#x3D;运行条件&#x3D;&#x3D;：必须先有HTML页面，在HTML页面中引入 JS ，浏览器加载该HTML页面，执行 JS 代码。</p>
</li>
<li><p>&#x3D;&#x3D;注释&#x3D;&#x3D; <code>//  /* */</code></p>
</li>
<li><p>&#x3D;&#x3D;废弃特性&#x3D;&#x3D;：很多类似这种特性都被废除，比如字符串对象，都是不再将被处理的对象作为参数传递，而是用实例其自带的方法调用。</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>❌ 非标准旧写法</th>
<th>✅ 推荐的标准写法</th>
</tr>
</thead>
<tbody><tr>
<td><code>Array.slice(myArr, 0, 2)</code></td>
<td><code>myArr.slice(0, 2)</code></td>
</tr>
<tr>
<td><code>Array.forEach(myArr, fn)</code></td>
<td><code>myArr.forEach(fn)</code></td>
</tr>
<tr>
<td><code>Array.map(myArr, fn)</code></td>
<td><code>myArr.map(fn)</code></td>
</tr>
<tr>
<td><code>Array.filter(myArr, fn)</code></td>
<td><code>myArr.filter(fn)</code></td>
</tr>
<tr>
<td><code>Array.join(myArr, &#39;,&#39;)</code></td>
<td><code>myArr.join(&#39;,&#39;)</code></td>
</tr>
</tbody></table>
<h1 id="JS-核心基础"><a href="#JS-核心基础" class="headerlink" title="JS 核心基础"></a>JS 核心基础</h1><h2 id="运行机制"><a href="#运行机制" class="headerlink" title="运行机制"></a>运行机制</h2><ul>
<li>JS是单线程，不能同时进行；因为 JavaScript 是为处理页面中用户的交互，以及操作 DOM 而诞生的。比如我们对<br>某个 DOM 元素进行添加和删除操作，不能同时进行。 应该先进行添加，之后再删除。如果 JS 执行的时间过长，这样就会造成页面的渲染不连贯，导致页面渲染加载阻塞的感觉。</li>
<li>同步任务v.s.异步任务<br>为了解决这个问题，利用多核 CPU 的计算能力，HTML5 提出 允许 JavaScript 脚本创建多个线程，但是子线程完全受主线程控制。故出现了JS中所有任务可以分成两种，<strong>同步任务（synchronous）<strong>和</strong>异步任务（asynchronous）</strong>。<br>同步任务指的是：在主线程【执行栈】上排队执行的任务，只有前一个任务执行完毕，才能执行后一个任务；<br>异步任务指的是：不进入主线程、而进入【任务队列】的任务，当主线程中的任务运行完了，才会从”任务队列”取出异步任务放入主线程执行。</li>
</ul>
<blockquote>
<p>比如你在做一件事情时，因为这件事情会花费很长时间，在做这件事的同时，你还可以去处理其他事情。比如做饭的异步做法，我们在烧水的同时，利用这10分钟，去切菜，炒菜。</p>
</blockquote>
<table>
<thead>
<tr>
<th>【异步任务】类别</th>
<th>示例&#x2F;说明</th>
</tr>
</thead>
<tbody><tr>
<td>网络请求</td>
<td>fetch(), axios.get(), XMLHttpRequest</td>
</tr>
<tr>
<td>定时器任务</td>
<td>setTimeout, setInterval, requestAnimationFrame</td>
</tr>
<tr>
<td>DOM 事件回调</td>
<td>click, keyup, onload 等事件回调</td>
</tr>
<tr>
<td>Promise 任务</td>
<td>.then, .catch, .finally</td>
</tr>
<tr>
<td>Async&#x2F;Await</td>
<td>封装 Promise 的更简洁语法</td>
</tr>
<tr>
<td>微任务（Microtasks）</td>
<td>queueMicrotask, Promise.then</td>
</tr>
<tr>
<td>宏任务（Macrotasks）</td>
<td>setTimeout, setInterval, MessageChannel</td>
</tr>
<tr>
<td>Web Worker</td>
<td>在子线程中处理数据（比如大计算任务）</td>
</tr>
<tr>
<td>事件循环触发</td>
<td>浏览器&#x2F;Node 的 event loop 会安排任务执行顺序</td>
</tr>
</tbody></table>
<h3 id="事件循环"><a href="#事件循环" class="headerlink" title="事件循环"></a>事件循环</h3><p>JavaScript在按代码从前往后顺序执行，依次压入执行栈，每次执行一个方法，都会为它生成独有的执行环境（上下文)，当这个方法执行完成后，就会销毁当前执行环境，并从栈中弹出此方法，继续执行下一个方法。执行栈是栈，先进后出，但并不是代码从后往前执行，而是调用一个压栈、它执行完出栈，所以还是从前往后执行。<br><img src="/images/JS%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0.assets/fc52f2ed526b44958e547ec167f55bd1.png" alt="在这里插入图片描述"><br>任务队列分为宏任务、微任务两种队列。<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41775119/article/details/147123962?fromshare=blogdetail&sharetype=blogdetail&sharerId=147123962&sharerefer=PC&sharesource=qq_41775119&sharefrom=from_link">详见事件循环专题 点击跳转</a><br><img src="/images/JS%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0.assets/5b5d6784e3c84b1ab87cbe5de25ab283.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//下面三个片段的输出各是什么</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>);</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span>);</span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>);</span><br><span class="line"><span class="comment">//1-&gt;2-&gt;3</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>);</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span>);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"><span class="comment">//将回调函数放入 宏任务队列，虽然 0ms 但仍然要等主线程任务执行完毕后才执行。</span></span><br><span class="line"><span class="comment">//即使 setTimeout 的时间是 0ms，它依然不会立即执行，而是等 同步任务执行完毕 才执行。</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>);</span><br><span class="line"><span class="comment">//1-&gt;2-&gt;3</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>);</span><br><span class="line"><span class="variable language_">document</span>.<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;click&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>);</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span>);</span><br><span class="line">&#125;, <span class="number">3000</span>);</span><br><span class="line"><span class="comment">//1 2 3（如果 3 秒不点击） </span></span><br><span class="line"><span class="comment">// 1 2 click 3（如果 3 秒内点击）</span></span><br></pre></td></tr></table></figure>

<h3 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h3><p>HTML页面生命周期包含3个事件：DOMContentLoaded：完全加载HTML，构建完成DOM树</p>
<p>load：加载完成所有外部资源</p>
<p>beforeunload&#x2F;unload：beforeunload可以检查是否保存修改并询问是否离开，unload可以发送统计数据</p>
<h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">alert</span>(<span class="keyword">typeof</span> name);</span><br><span class="line">value=<span class="title function_">prompt</span>(text,defaultText)<span class="comment">//用于显示可提示用户进行输入的对话框。</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(x)<span class="comment">//写在页面上</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//几进制</span></span><br><span class="line">num=<span class="number">0b1</span>;</span><br><span class="line">num=<span class="number">0o5</span>;</span><br><span class="line">num=<span class="number">0xa</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//显式变量转换</span></span><br><span class="line"><span class="keyword">var</span> a=<span class="title class_">Number</span>(<span class="string">&quot;23&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> age = <span class="built_in">parseInt</span>(<span class="title function_">prompt</span>(<span class="string">&#x27;请输入年龄:&#x27;</span>));</span><br><span class="line"><span class="keyword">var</span> height = <span class="built_in">parseFloat</span>(<span class="title function_">prompt</span>(<span class="string">&#x27;请输入身高(m):&#x27;</span>));</span><br><span class="line"><span class="keyword">var</span> str=num.<span class="title function_">toString</span>();<span class="comment">//或String(num)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title class_">Infinity</span> ，代表无穷大，大于任何数值</span><br><span class="line">-<span class="title class_">Infinity</span> ，代表无穷小，小于任何数值</span><br><span class="line"><span class="title class_">NaN</span> ，<span class="title class_">Not</span> a number，代表一个非数值</span><br></pre></td></tr></table></figure>

<h2 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h2><ol>
<li>算数运算符<br>次方<code>**</code> </li>
<li>逻辑运算符<br>常用<code>&amp;&amp; ||  !</code></li>
<li>三目&#x2F;三元运算符<br><code>条件?真run：假run</code></li>
<li>比较运算符<br><code>===</code>对应<code>!==</code>，<br><strong>&#x3D;&#x3D;&#x3D;不会自动转换数据类型</strong>，如果数据类型不一致，返回false，如果一致，再比较。<br>undefined 和 null 与其自身严格相等</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> res1 = (<span class="literal">null</span> === <span class="literal">null</span>)  <span class="comment">//true</span></span><br><span class="line"><span class="keyword">let</span> res2 = (<span class="literal">undefined</span> === <span class="literal">undefined</span>)  <span class="comment">//true</span></span><br></pre></td></tr></table></figure>

<p>尽量不要使用&#x3D; &#x3D;比较，<strong>始终坚持使用&#x3D; &#x3D; &#x3D;比较</strong>。<br><code>==</code>做类型转换，再进行值的比较</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> res1 = (<span class="literal">null</span> == <span class="literal">undefined</span> ); <span class="comment">// true</span></span><br><span class="line"><span class="keyword">let</span> res2 = (<span class="literal">null</span>  === <span class="literal">undefined</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<ul>
<li><code> !=</code> 和 <code>!==</code>和<code>!===</code><br><code>!= </code>是非严格不等于，允许类型转换。<br><code>!== </code>是严格不等于，不允许类型转换。<br><code>!=== </code>是无效的运算符，不能使用。</li>
</ul>
<ol start="5">
<li>赋值运算符</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">c+=<span class="number">5</span>;</span><br><span class="line">c++;</span><br></pre></td></tr></table></figure>

<ol start="6">
<li>一元正号（Unary plus）将一个值强制转换为数字类型（Number）：就是在值前面放<code>+</code></li>
</ol>
<p>类似的还有：<code>~~</code>去除小数部分 <code>!!</code>转换成bool值</p>
<ol start="6">
<li><code>??</code>空值合并运算符（Nullish Coalescing）<br>作用：当左边是 null 或 undefined 时，才返回右边的值。</li>
<li><code>?.</code>可选链操作符（Optional Chaining）<br>作用：在访问对象深层属性时，如果某一层为 null 或 undefined，不会报错，而是返回 undefined</li>
</ol>
<h2 id="流程控制"><a href="#流程控制" class="headerlink" title="流程控制"></a>流程控制</h2><ul>
<li>循环<br>for &#x2F;while &#x2F;do…while</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> j=<span class="number">0</span>;j&lt;s.<span class="property">length</span>;j++)&#123;&#125;</span><br><span class="line"><span class="keyword">while</span>(xx)&#123;&#125;</span><br><span class="line"><span class="keyword">do</span> &#123; ... &#125; <span class="keyword">while</span>()<span class="comment">//先执行一次 再判断</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"><span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="条件判断"><a href="#条件判断" class="headerlink" title="条件判断"></a>条件判断</h2><p>switch case性能优于if else</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//判断简化</span></span><br><span class="line"><span class="keyword">if</span>(a === <span class="literal">undefined</span> || a === <span class="number">10</span> || a=== <span class="number">15</span> || a === <span class="literal">null</span>) &#123;</span><br><span class="line">	<span class="comment">//...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>([<span class="literal">undefined</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="literal">null</span>].<span class="title function_">includes</span>(a)) &#123;</span><br><span class="line">	<span class="comment">//...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(a &gt; <span class="number">10</span>) &#123;</span><br><span class="line">	<span class="title function_">doSomething</span>(a)</span><br><span class="line">&#125;</span><br><span class="line">a &gt; <span class="number">10</span> &amp;&amp; <span class="title function_">doSomething</span>(a)</span><br><span class="line"></span><br><span class="line">a ?? <span class="title function_">dosomething</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(xx)&#123;</span><br><span class="line">...</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(xx)&#123;</span><br><span class="line">...</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//三元运算符</span></span><br><span class="line">condition?<span class="attr">ok_then</span>:no_then</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span>()&#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="attr">label1</span>:</span><br><span class="line">		xxx</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="attr">label2</span>:</span><br><span class="line">		xxx</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="attr">default</span>:</span><br><span class="line">		xxx</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//函数声明 函数提升至作用域顶部</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//函数表达式</span></span><br><span class="line"><span class="comment">// 函数表达式必须要先声明再调用</span></span><br><span class="line"><span class="keyword">const</span> add = <span class="keyword">function</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//箭头函数</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">add</span> = (<span class="params">x, y</span>) =&gt; x + y;</span><br><span class="line"></span><br><span class="line"><span class="comment">//默认参数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">greet</span>(<span class="params">name = <span class="string">&#x27;游客&#x27;</span></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;你好，&#x27;</span> + name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//剩余参数 变成数组</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sum</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> args.<span class="title function_">reduce</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a + b, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">sum</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>); <span class="comment">// 6</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//返回值不写则返回undefined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//传参过多的优化</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getItem</span>(<span class="params">price, quantity, name, description</span>) &#123;&#125;</span><br><span class="line"><span class="title function_">getItem</span>(<span class="number">15</span>, <span class="literal">undefined</span>, <span class="string">&#x27;bananas&#x27;</span>, <span class="string">&#x27;fruit&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getItem</span>(<span class="params">args</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;price, quantity, name, description&#125; = args</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">getItem</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;bananas&#x27;</span>,</span><br><span class="line">    <span class="attr">price</span>: <span class="number">10</span>,</span><br><span class="line">    <span class="attr">quantity</span>: <span class="number">1</span>, </span><br><span class="line">    <span class="attr">description</span>: <span class="string">&#x27;fruit&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>总结</li>
</ul>
<ol>
<li>函数内部声明的变量，在函数外部无法被访问</li>
<li>函数参数也是函数内部的局部变量</li>
<li>不同函数内部声明的变量无法互相访问</li>
<li>函数执行完毕后，函数内部变量实际被清空</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">func</span>(<span class="params">parameter</span>)&#123;</span><br><span class="line">	<span class="keyword">return</span> parameter;<span class="comment">//return 只能返回一个值，如果有多个则返回最后一个，无返回时是undefined</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数形参实参个数匹配</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">getSum</span>(<span class="params">num1, num2</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(num1 + num2);</span><br><span class="line"><span class="comment">// 1. 如果实参的个数和形参的个数一致 则正常输出结果</span></span><br><span class="line">        <span class="title function_">getSum</span>(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"><span class="comment">// 2. 如果实参的个数多于形参的个数  会取到形参的个数 </span></span><br><span class="line">        <span class="title function_">getSum</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line"><span class="comment">// 3. 如果实参的个数小于形参的个数  多于的形参定义为undefined  最终的结果就是 NaN</span></span><br><span class="line"><span class="comment">// 形参可以看做是不用声明的变量  num2 是一个变量但是没有接受值  结果就是undefined </span></span><br><span class="line">        <span class="title function_">getSum</span>(<span class="number">1</span>); <span class="comment">// NaN</span></span><br><span class="line"><span class="comment">// 建议 我们尽量让实参的个数和形参相匹配</span></span><br></pre></td></tr></table></figure>

<ul>
<li>IIFE（immediately invoked function expression）立即执行函数：创建闭包，是一种自执行匿名函数，匿名函数拥有独立作用域。不仅避免外界访问此 IIFE 中的变量，而且又不会污染全局作用域。保存全局作用域和当前函数的作用域，因此可输出全局变量。</li>
</ul>
<h3 id="return坑"><a href="#return坑" class="headerlink" title="return坑"></a>return坑</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">        &#123; <span class="attr">name</span>: <span class="string">&#x27;foo&#x27;</span> &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">foo</span>(); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>

<p>由于JavaScript引擎在行末自动添加分号的机制，上面的代码实际上变成了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span>; <span class="comment">// 自动添加了分号，相当于return undefined;</span></span><br><span class="line">        &#123; <span class="attr">name</span>: <span class="string">&#x27;foo&#x27;</span> &#125;; <span class="comment">// 这行语句已经没法执行到了</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>所以正确写法为</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="comment">// 这里不会自动加分号，因为&#123;表示语句尚未结束</span></span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;foo&#x27;</span></span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="输入输出"><a href="#输入输出" class="headerlink" title="输入输出"></a>输入输出</h2><table>
<thead>
<tr>
<th>环境</th>
<th>输入方式</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>浏览器</td>
<td><code>prompt()</code></td>
<td><code>prompt(&quot;请输入&quot;)</code></td>
</tr>
<tr>
<td>浏览器</td>
<td>HTML + JS</td>
<td><code>input.value</code> + <code>button.onclick</code></td>
</tr>
<tr>
<td>Node.js</td>
<td><code>readline</code></td>
<td><code>rl.question(...)</code></td>
</tr>
</tbody></table>
<ul>
<li>在 Node.js 中获取输入</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> readline = <span class="built_in">require</span>(<span class="string">&quot;readline&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rl = readline.<span class="title function_">createInterface</span>(&#123;</span><br><span class="line">  <span class="attr">input</span>: process.<span class="property">stdin</span>,</span><br><span class="line">  <span class="attr">output</span>: process.<span class="property">stdout</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">rl.<span class="title function_">question</span>(<span class="string">&quot;请输入你的名字：&quot;</span>, <span class="keyword">function</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`你好，<span class="subst">$&#123;name&#125;</span>！`</span>);</span><br><span class="line">  rl.<span class="title function_">close</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<ul>
<li>json</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">fetch</span>(<span class="string">&quot;data.json&quot;</span>)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">json</span>())</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(data))</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;加载数据失败&quot;</span>, error));</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fetchData</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&quot;https://jsonplaceholder.typicode.com/users/1&quot;</span>);</span><br><span class="line">        <span class="keyword">const</span> data = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;请求失败&quot;</span>, error);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">fetchData</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//ES6 import</span></span><br><span class="line"><span class="keyword">import</span> userData <span class="keyword">from</span> <span class="string">&quot;./data.json&quot;</span> assert &#123; <span class="attr">type</span>: <span class="string">&quot;json&quot;</span> &#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(userData);</span><br><span class="line"></span><br><span class="line"><span class="comment">//main.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; user, getUser &#125; <span class="keyword">from</span> <span class="string">&quot;./data.js&quot;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(user);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">getUser</span>());</span><br><span class="line"><span class="comment">//data.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> user = &#123; <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span>, <span class="attr">age</span>: <span class="number">25</span> &#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getUser</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> user;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>读取本地存储 (localStorage &#x2F; sessionStorage)</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 存储数据</span></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;user&quot;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span>, <span class="attr">age</span>: <span class="number">25</span> &#125;));</span><br><span class="line"><span class="comment">//JSON.stringify converts a JavaScript value to a JSON string</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 读取数据</span></span><br><span class="line"><span class="keyword">const</span> userData = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;user&quot;</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(userData);</span><br></pre></td></tr></table></figure>

<ul>
<li>txt,csv<br>浏览器的 File 对象（即 event.target.files[0]）不能直接访问内容，必须通过 FileReader 读取。<br>FileReader 是浏览器提供的 API，用于异步读取文件内容，它支持以下格式：<br>readAsText(file) —— 读取文本（如 .txt, .csv, .json）。<br>readAsDataURL(file) —— 读取图片并返回 Base64 编码。<br>readAsArrayBuffer(file) —— 读取二进制数据。<br>为什么必须写FileReader().onload？readAsText(file) 是异步操作，读取文件需要时间，所以不能直接在下一行获取 result。必须等 onload 事件触发，文件数据才会被正确读取。<br>1️⃣ dragover 事件<br>当文件被拖动到 dropArea 上方时触发。<br>默认情况下，浏览器不允许放置文件，e.preventDefault(); 使其成为可拖拽区域。<br>2️⃣ drop 事件<br>当文件被放下时触发。<br>默认行为是打开文件，但我们希望自己控制读取文件，因此 e.preventDefault(); 阻止这个默认行为。</li>
</ul>
<p>可将读取到的文本转换成json</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">fetch</span>(<span class="string">&quot;./data.txt&quot;</span>) <span class="comment">// 读取 txt 文件</span></span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">text</span>()) <span class="comment">// 读取文本内容</span></span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">text</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> jsonData = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(text); <span class="comment">// 将文本转换为 JSON</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(jsonData); <span class="comment">// 输出 JSON 数据</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;JSON 解析失败:&quot;</span>, error);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;读取文件失败:&quot;</span>, err));</span><br><span class="line"></span><br><span class="line"><span class="title function_">fetch</span>(<span class="string">&quot;https://example.com/api/users&quot;</span>)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>())</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(data));</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 1 </span></span><br><span class="line"><span class="comment">不适用于：直接打开 HTML 文件时（因浏览器安全限制）</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">fetch(&quot;example.txt&quot;)</span><br><span class="line">    .then(response =&gt; response.text())</span><br><span class="line">    .then(data =&gt; console.log(data))</span><br><span class="line">    .catch(error =&gt; console.error(&quot;读取文件失败&quot;, error));</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 2 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">id</span>=<span class="string">&quot;fileInput&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;fileInput&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;change&quot;</span>, <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> file = event.<span class="property">target</span>.<span class="property">files</span>[<span class="number">0</span>];</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> reader = <span class="keyword">new</span> <span class="title class_">FileReader</span>();</span></span><br><span class="line"><span class="language-javascript">    reader.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(e.<span class="property">target</span>.<span class="property">result</span>); <span class="comment">// 读取的文件内容</span></span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">    reader.<span class="title function_">readAsText</span>(file);</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 3 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;dropArea&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 300px; height: 150px; border: 2px dashed gray; text-align: center; line-height: 150px;&quot;</span>&gt;</span></span><br><span class="line">    拖拽 TXT 文件到此处</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">pre</span> <span class="attr">id</span>=<span class="string">&quot;fileContent&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line">pre是一个 HTML 标签，常用于显示文本内容，尤其是保留换行和空格格式的文本。</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> dropArea = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;dropArea&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">dropArea.<span class="title function_">addEventListener</span>(<span class="string">&quot;dragover&quot;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    e.<span class="title function_">preventDefault</span>(); <span class="comment">// 允许拖拽</span></span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">dropArea.<span class="title function_">addEventListener</span>(<span class="string">&quot;drop&quot;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    e.<span class="title function_">preventDefault</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> file = e.<span class="property">dataTransfer</span>.<span class="property">files</span>[<span class="number">0</span>]; <span class="comment">// 获取拖拽的文件</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (!file || file.<span class="property">type</span> !== <span class="string">&quot;text/plain&quot;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">alert</span>(<span class="string">&quot;请选择一个 TXT 文件！&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> reader = <span class="keyword">new</span> <span class="title class_">FileReader</span>();</span></span><br><span class="line"><span class="language-javascript">    reader.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;fileContent&quot;</span>).<span class="property">textContent</span> = event.<span class="property">target</span>.<span class="property">result</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">    reader.<span class="title function_">readAsText</span>(file);</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="操作文件"><a href="#操作文件" class="headerlink" title="操作文件"></a>操作文件</h3><p>在HTML表单中，上传文件唯一控件是<code>&lt; input type=&quot;file&quot;&gt;</code>，表单enctype必须指定为<code>multipart/form-data</code>，method必须指定为post。出于安全考虑，浏览器只允许用户选择本地文件，用JavaScript对&lt; input type&#x3D;”file”&gt;的value赋值是没有任何效果的。JavaScript可以在提交表单时对文件扩展名做检查，以便防止用户上传无效格式的文件。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> f = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;test-file-upload&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> filename = f.<span class="property">value</span>; <span class="comment">// &#x27;C:\fakepath\test.png&#x27;</span></span><br><span class="line"><span class="keyword">if</span> (!filename || !(filename.<span class="title function_">endsWith</span>(<span class="string">&#x27;.jpg&#x27;</span>) || filename.<span class="title function_">endsWith</span>(<span class="string">&#x27;.png&#x27;</span>) || filename.<span class="title function_">endsWith</span>(<span class="string">&#x27;.gif&#x27;</span>))) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&#x27;Can only upload image file.&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>HTML5新增File API允许JS读取文件内容，获得更多文件信息。提供File和FileReader两个主要对象，可获得文件信息并读取文件。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span></span><br><span class="line">    fileInput = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;test-image-file&#x27;</span>),</span><br><span class="line">    info = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;test-file-info&#x27;</span>),</span><br><span class="line">    preview = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;test-image-preview&#x27;</span>);</span><br><span class="line"><span class="comment">// 监听change事件:</span></span><br><span class="line">fileInput.<span class="title function_">addEventListener</span>(<span class="string">&#x27;change&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 清除背景图片:</span></span><br><span class="line">    preview.<span class="property">style</span>.<span class="property">backgroundImage</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="comment">// 检查文件是否选择:</span></span><br><span class="line">    <span class="keyword">if</span> (!fileInput.<span class="property">value</span>) &#123;</span><br><span class="line">        info.<span class="property">innerHTML</span> = <span class="string">&#x27;没有选择文件&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 获取File引用:</span></span><br><span class="line">    <span class="keyword">var</span> file = fileInput.<span class="property">files</span>[<span class="number">0</span>];</span><br><span class="line">    <span class="comment">// 获取File信息:</span></span><br><span class="line">    info.<span class="property">innerHTML</span> = <span class="string">&#x27;文件: &#x27;</span> + file.<span class="property">name</span> + <span class="string">&#x27;&lt;br&gt;&#x27;</span> +</span><br><span class="line">                     <span class="string">&#x27;大小: &#x27;</span> + file.<span class="property">size</span> + <span class="string">&#x27;&lt;br&gt;&#x27;</span> +</span><br><span class="line">                     <span class="string">&#x27;修改: &#x27;</span> + file.<span class="property">lastModifiedDate</span>;</span><br><span class="line">    <span class="keyword">if</span> (file.<span class="property">type</span> !== <span class="string">&#x27;image/jpeg&#x27;</span> &amp;&amp; file.<span class="property">type</span> !== <span class="string">&#x27;image/png&#x27;</span> &amp;&amp; file.<span class="property">type</span> !== <span class="string">&#x27;image/gif&#x27;</span>) &#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&#x27;不是有效的图片文件!&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 读取文件:</span></span><br><span class="line">    <span class="keyword">var</span> reader = <span class="keyword">new</span> <span class="title class_">FileReader</span>();</span><br><span class="line">    <span class="comment">// FileReader() 返回一个新构造的FileReader。</span></span><br><span class="line">    <span class="comment">//当 FileReader 读取文件的方式为  </span></span><br><span class="line">    <span class="comment">//readAsArrayBuffer, </span></span><br><span class="line">    <span class="comment">//readAsBinaryString, </span></span><br><span class="line">    <span class="comment">//readAsDataURL 或者 readAsText 的时候，会触发一个 load 事件。从而可以使用  FileReader.onload 属性对该事件进行处理。</span></span><br><span class="line">    reader.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> data = e.<span class="property">target</span>.<span class="property">result</span>; </span><br><span class="line"><span class="comment">// &#x27;data:image/jpeg;base64,/9j/4AAQSk...(base64编码)...&#x27;            </span></span><br><span class="line">        preview.<span class="property">style</span>.<span class="property">backgroundImage</span> = <span class="string">&#x27;url(&#x27;</span> + data + <span class="string">&#x27;)&#x27;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 以DataURL的形式读取文件:</span></span><br><span class="line">    reader.<span class="title function_">readAsDataURL</span>(file);</span><br><span class="line"><span class="comment">//readAsDataURL 方法会读取指定的 Blob 或 File 对象。</span></span><br><span class="line"><span class="comment">//读取操作完成的时候，readyState 变成已完成DONE，并触发 loadend 事件，</span></span><br><span class="line"><span class="comment">//result属性将包含一个data:URL格式的字符串（base64编码）以表示所读取文件的内容。</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="严格模式"><a href="#严格模式" class="headerlink" title="*严格模式"></a>*严格模式</h2><p>严格模式在 IE10 以上版本的浏览器中才会被支持，旧版本浏览器中会被忽略。</p>
<ul>
<li><p>严格模式：<br>1.消除 Javascript 语法的不合理、不严谨之处，减少怪异行为。<br>2.消除代码运行的不安全之处，保证代码运行的安全。<br>3.提高编译器效率，增加运行速度。<br>4.禁用在 ECMAScript 的未来版本中可能定义的语法，为未来新版本的 Javascript 做好铺垫。比如一些保留字如：class,enum,export, extends, import, super 不能做变量名</p>
</li>
<li><p>开启严格模式<br>严格模式可以应用到整个脚本或个别函数中。因此在使用时，我们可以将严格模式分为脚本开启严格模式和为函数开启严格模式两种情况。</p>
</li>
</ul>
<ol>
<li>脚本开启严格模式<br>有的 script 脚本是严格模式，有的 script 脚本是正常模式，这样不利于文件合并，所以可以将整个脚本文件放在一个立即执行的匿名函数之中。这样独立创建一个作用域而不影响其他script 脚本文件。</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">  <span class="comment">//在当前的这个自调用函数中有开启严格模式，当前函数之外还是普通模式</span></span><br><span class="line">　　　　<span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">       <span class="keyword">var</span> num = <span class="number">10</span>;</span><br><span class="line">　　　　<span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">&#125;)();</span><br><span class="line"><span class="comment">//或者 </span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="meta"></span></span></span></span><br><span class="line"><span class="meta"><span class="language-javascript"><span class="language-xml">  　&quot;use strict&quot;</span>; <span class="comment">//当前script标签开启了严格模式</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>函数开启严格模式：需要把“use strict”;  (或 ‘use strict’; ) 声明放在函数体所有语句之前。</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>)&#123;</span><br><span class="line">　　<span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">　　<span class="keyword">return</span> <span class="string">&quot;123&quot;</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//当前fn函数开启了严格模式</span></span><br></pre></td></tr></table></figure>

<ul>
<li>严格模式产生的改变</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span></span><br><span class="line">num = <span class="number">10</span> </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(num)<span class="comment">//不能使用未声明的变量</span></span><br><span class="line">------------------</span><br><span class="line"><span class="keyword">var</span> num2 = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">delete</span> num2;<span class="comment">//不允许删除变量</span></span><br><span class="line">------------------</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>); <span class="comment">// 严格模式下全局作用域 this 是 undefined</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">fn</span>();  </span><br><span class="line">------------------</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Star</span>(<span class="params"></span>) &#123;</span><br><span class="line">	 <span class="variable language_">this</span>.<span class="property">sex</span> = <span class="string">&#x27;男&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Star();严格模式下,如果构造函数不加new调用, this 指向的是undefined 给他赋值会报错.</span></span><br><span class="line"><span class="keyword">var</span> ldh = <span class="keyword">new</span> <span class="title class_">Star</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ldh.<span class="property">sex</span>);</span><br><span class="line">--------------------</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>); <span class="comment">//严格模式下，定时器 this 还是指向 window</span></span><br><span class="line">&#125;, <span class="number">2000</span>);  </span><br></pre></td></tr></table></figure>

<h2 id="数字安全专题-（0-1-0-2-0-3-的原因）"><a href="#数字安全专题-（0-1-0-2-0-3-的原因）" class="headerlink" title="数字安全专题 （0.1+0.2!&#x3D;&#x3D;0.3 的原因）"></a>数字安全专题 （0.1+0.2!&#x3D;&#x3D;0.3 的原因）</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41775119/article/details/147121040?fromshare=blogdetail&sharetype=blogdetail&sharerId=147121040&sharerefer=PC&sharesource=qq_41775119&sharefrom=from_link">详细分析</a><br>总结：JS数字采用 IEEE 754 标准 64 位双精度浮点数，1-11-52，用科学记数法表示指数和尾数，过长小数会被截断，导致精度误差。解决方法：高精度数值库Decimal.js；在ES6中，提供Number.EPSILON属性，值是$2^{-52}$</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">numberepsilon</span>(<span class="params">arg1,arg2</span>)&#123;                   </span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">abs</span>(arg1 - arg2) &lt; <span class="title class_">Number</span>.<span class="property">EPSILON</span>;        </span><br><span class="line">&#125;        </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">numberepsilon</span>(<span class="number">0.1</span> + <span class="number">0.2</span>, <span class="number">0.3</span>)); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<h2 id="对象object"><a href="#对象object" class="headerlink" title="对象object"></a>对象object</h2><ul>
<li>JavaScript 一切皆对象，有各自的构造函数&#x2F;方法属性&#x2F;实例化。</li>
<li>普通对象在赋值时只是赋值栈内存中的地址，不是堆内存中的数据。</li>
<li>定义：对象是一组由键-值组成的无序集合，键都是字符串类型（自动转为字符串，除Symbol 唯一不会被覆盖），值可以是任意数据类型。</li>
<li>使用</li>
</ul>
<ol>
<li>创建</li>
</ol>
<table>
<thead>
<tr>
<th>创建方式</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>字面量</td>
<td><code>const obj = &#123; name: &#39;Tom&#39;, age: 18 &#125;;</code></td>
</tr>
<tr>
<td>构造函数</td>
<td><code>const obj = new Object();</code></td>
</tr>
<tr>
<td>工厂函数</td>
<td><code>function createUser() &#123; return &#123;...&#125; &#125;</code></td>
</tr>
<tr>
<td><code>Object.create(proto)</code></td>
<td><code>const obj = Object.create(null);</code></td>
</tr>
</tbody></table>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Bob&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">20</span>,</span><br><span class="line">    <span class="attr">tags</span>: [<span class="string">&#x27;js&#x27;</span>, <span class="string">&#x27;web&#x27;</span>, <span class="string">&#x27;mobile&#x27;</span>],</span><br><span class="line">    <span class="attr">city</span>: <span class="string">&#x27;Beijing&#x27;</span>,</span><br><span class="line">    <span class="attr">hasCar</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">zipcode</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">habit</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">alert</span>(<span class="string">&#x27;habit&#x27;</span>) <span class="keyword">return</span><span class="string">&#x27;ok&#x27;</span>;&#125;,</span><br><span class="line">  	[dynamic]:<span class="string">&#x27;666&#x27;</span><span class="comment">//key可以是变量 比如[dynamic]得到其值作为key</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 利用构造函数创建对象</span></span><br><span class="line">        <span class="comment">// 构造函数的语法格式</span></span><br><span class="line">        <span class="comment">// function 构造函数名() &#123;</span></span><br><span class="line">        <span class="comment">//     this.属性 = 值;</span></span><br><span class="line">        <span class="comment">//     this.方法 = function() &#123;&#125;</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">        <span class="comment">// new 构造函数名();</span></span><br><span class="line">        </span><br><span class="line"><span class="comment">// 1. 构造函数名字首字母要大写</span></span><br><span class="line"><span class="comment">// 2. 我们构造函数不需要return 就可以返回结果</span></span><br><span class="line"><span class="comment">// 3. 我们调用构造函数 必须使用 new</span></span><br><span class="line"><span class="comment">// 4. 我们的属性和方法前面必须添加 this</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">Star</span>(<span class="params">uname, age, sex</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">name</span> = uname;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">sex</span> = sex;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">sing</span> = <span class="keyword">function</span>(<span class="params">sang</span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(sang);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> ldh = <span class="keyword">new</span> <span class="title class_">Star</span>(<span class="string">&#x27;刘德华&#x27;</span>, <span class="number">18</span>, <span class="string">&#x27;男&#x27;</span>); </span><br></pre></td></tr></table></figure>

<ol start="2">
<li>基本操作</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//访问</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(ldh.<span class="property">name</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(ldh[<span class="string">&#x27;sex&#x27;</span>]);</span><br><span class="line">        ldh.<span class="title function_">sing</span>(<span class="string">&#x27;冰雨&#x27;</span>);</span><br><span class="line"><span class="comment">//新增修改</span></span><br><span class="line">obj.<span class="property">age</span> = <span class="number">20</span>;        <span class="comment">// 修改</span></span><br><span class="line">obj.<span class="property">gender</span> = <span class="string">&#x27;男&#x27;</span>;   <span class="comment">// 新增</span></span><br><span class="line"><span class="comment">//删除</span></span><br><span class="line"><span class="keyword">delete</span> object.<span class="property">p</span> <span class="comment">//只能删除对象属性或数组元素</span></span><br><span class="line"><span class="comment">//不能删除变量、函数、常量，不会更新length</span></span><br><span class="line"><span class="comment">//删除数组元素会留下“空洞”，即该位置的值为 undefined。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//要检测xiaoming是否拥有某属性，可以用in操作符</span></span><br><span class="line"><span class="string">&#x27;name&#x27;</span> <span class="keyword">in</span> xiaoming; <span class="comment">// true</span></span><br><span class="line"><span class="string">&#x27;grade&#x27;</span> <span class="keyword">in</span> xiaoming; <span class="comment">// false</span></span><br><span class="line"><span class="comment">//如果in判断一个属性存在，这个属性不一定是xiaoming的，可能是xiaoming继承得到的</span></span><br><span class="line"><span class="comment">//要判断一个属性是否是xiaoming自身拥有的，而不是继承得到的，可以用hasOwnProperty()方法</span></span><br><span class="line">xiaoming.<span class="title function_">hasOwnProperty</span>(<span class="string">&#x27;name&#x27;</span>); <span class="comment">// true</span></span><br><span class="line">xiaoming.<span class="title function_">hasOwnProperty</span>(<span class="string">&#x27;toString&#x27;</span>); <span class="comment">// false</span></span><br><span class="line">xiaoming.<span class="title function_">isPrototypeOf</span>(obj)<span class="comment">//检查当前对象是否是另一个对象的原型。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//浅拷贝 只复制一层</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">assign</span>(target, source)<span class="comment">//将 source对象的所有属性复制到 target 对象。</span></span><br><span class="line"><span class="comment">//覆盖规则：后覆盖前</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj2 = &#123; ...obj &#125;;</span><br><span class="line"><span class="keyword">const</span> obj3 = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, obj);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> target = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span> &#125;;</span><br><span class="line"><span class="keyword">let</span> source1 = &#123; <span class="attr">b</span>: <span class="number">3</span>, <span class="attr">c</span>: <span class="number">4</span> &#125;;</span><br><span class="line"><span class="keyword">let</span> source2 = &#123; <span class="attr">d</span>: <span class="number">5</span> &#125;;</span><br><span class="line"><span class="keyword">let</span> 新对象 = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, target, source1, source2);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(新的对象); <span class="comment">// &#123; a: 1, b: 3, c: 4, d: 5 &#125;</span></span><br><span class="line"><span class="comment">//深拷贝 更强大的深拷贝，使用 lodash.cloneDeep</span></span><br><span class="line"><span class="keyword">const</span> deepCopy = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(obj)); </span><br><span class="line"><span class="comment">// ⚠️ 不能拷贝函数、undefined、symbol</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//对象合并</span></span><br><span class="line"><span class="keyword">const</span> obj1 = &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> obj2 = &#123; <span class="attr">b</span>: <span class="number">2</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> merged = &#123; ...obj1, ...obj2 &#125;; <span class="comment">// &#123; a: 1, b: 2 &#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">freeze</span>(obj)<span class="comment">//冻结对象，防止后续修改对象的属性。</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">is</span>(<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;a&#x27;</span>)<span class="comment">//用来比较两个值是否相等</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//遍历 不能直接用for of</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">keys</span>(obj)<span class="comment">//返回对象的所有属性名（键）组成的数组。</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">values</span>(obj)<span class="comment">//返回对象的所有属性值组成的数组。</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">entries</span>(obj)<span class="comment">//返回对象的所有属性键值对组成的二维数组。</span></span><br><span class="line"><span class="keyword">let</span> &#123;keys, values, entries&#125; = <span class="title class_">Object</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> key <span class="keyword">of</span> <span class="title function_">keys</span>(json))&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> value <span class="keyword">of</span> <span class="title function_">values</span>(json))&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> item <span class="keyword">of</span> <span class="title function_">entries</span>(json))&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(item);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> [key, val] <span class="keyword">of</span> <span class="title function_">entries</span>(json))&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(key, val);</span><br><span class="line">&#125;</span><br><span class="line"> <span class="keyword">for</span> (<span class="keyword">var</span> k <span class="keyword">in</span> obj) &#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(k); <span class="comment">// k 变量 输出  得到的是 属性名</span></span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(obj[k]); <span class="comment">// obj[k] 得到是 属性值</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ES6特性</span></span><br><span class="line"><span class="keyword">let</span> json =&#123;<span class="comment">//简化</span></span><br><span class="line">            name,   <span class="comment">//name:name,</span></span><br><span class="line">            age ,    <span class="comment">//age:age</span></span><br><span class="line">          </span><br><span class="line">          <span class="comment">/* showA:function()&#123;</span></span><br><span class="line"><span class="comment">                return this.name;</span></span><br><span class="line"><span class="comment">            &#125; */</span></span><br><span class="line">            <span class="title function_">showA</span>(<span class="params"></span>)&#123;<span class="comment">//不要用箭头函数</span></span><br><span class="line">                <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">name</span>;</span><br><span class="line">            &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="哈希表Map"><a href="#哈希表Map" class="headerlink" title="哈希表Map"></a>哈希表Map</h2><table>
<thead>
<tr>
<th>操作类型</th>
<th>方法 &#x2F; 语法</th>
<th>示例代码</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><strong>创建 Map</strong></td>
<td><code>new Map()</code></td>
<td><code>const map = new Map();</code></td>
<td>创建一个空的 Map</td>
</tr>
<tr>
<td><strong>创建 Map（带值）</strong></td>
<td><code>new Map([[key1, val1], [key2, val2]])</code></td>
<td><code>const map = new Map([[&#39;a&#39;, 1], [&#39;b&#39;, 2]]);</code></td>
<td>创建时直接初始化</td>
</tr>
<tr>
<td><strong>添加键值对</strong></td>
<td><code>.set(key, value)</code></td>
<td><code>map.set(&#39;name&#39;, &#39;Alice&#39;);</code></td>
<td>添加或更新键值对</td>
</tr>
<tr>
<td><strong>获取值</strong></td>
<td><code>.get(key)</code></td>
<td><code>map.get(&#39;name&#39;)</code></td>
<td>获取对应键的值</td>
</tr>
<tr>
<td><strong>检查键是否存在</strong></td>
<td><code>.has(key)</code></td>
<td><code>map.has(&#39;age&#39;)</code></td>
<td>判断 Map 中是否有该键</td>
</tr>
<tr>
<td><strong>删除键值对</strong></td>
<td><code>.delete(key)</code></td>
<td><code>map.delete(&#39;age&#39;)</code></td>
<td>删除指定键的条目</td>
</tr>
<tr>
<td><strong>清空 Map</strong></td>
<td><code>.clear()</code></td>
<td><code>map.clear()</code></td>
<td>删除所有键值对</td>
</tr>
<tr>
<td><strong>获取 Map 大小</strong></td>
<td><code>.size</code></td>
<td><code>map.size</code></td>
<td>获取键值对数量</td>
</tr>
<tr>
<td><strong>遍历所有键值对</strong></td>
<td><code>for (const [k, v] of map)</code></td>
<td><code>for (const [k, v] of map) &#123; console.log(k, v); &#125;</code></td>
<td>以插入顺序遍历键值对</td>
</tr>
<tr>
<td><strong>遍历所有键</strong></td>
<td><code>map.keys()</code></td>
<td><code>for (const k of map.keys())</code></td>
<td>遍历所有键</td>
</tr>
<tr>
<td><strong>遍历所有值</strong></td>
<td><code>map.values()</code></td>
<td><code>for (const v of map.values())</code></td>
<td>遍历所有值</td>
</tr>
<tr>
<td><strong>forEach 遍历</strong></td>
<td><code>map.forEach((v, k) =&gt; &#123;&#125;)</code></td>
<td><code>map.forEach((v, k) =&gt; console.log(k, v))</code></td>
<td>使用回调函数遍历</td>
</tr>
<tr>
<td><strong>使用对象做键</strong></td>
<td><code>map.set(obj, value)</code></td>
<td><code>map.set(&#123;id: 1&#125;, &#39;data&#39;)</code></td>
<td>可使用对象或函数作为键</td>
</tr>
<tr>
<td><strong>Map 转数组</strong></td>
<td><code>Array.from(map)</code> 或 <code>[...map]</code></td>
<td><code>const arr = [...map]</code></td>
<td>转换为数组</td>
</tr>
<tr>
<td><strong>数组转 Map</strong></td>
<td><code>new Map(array)</code></td>
<td><code>const map = new Map([[key, value]])</code></td>
<td>使用二维数组创建 Map</td>
</tr>
</tbody></table>
<h3 id="map不是Map"><a href="#map不是Map" class="headerlink" title="map不是Map"></a>map不是Map</h3><p>一个是循环方法，一个是变量类型。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Map的回调函数参数依次为value、key和map本身</span></span><br><span class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> <span class="title class_">Map</span>([[<span class="number">1</span>, <span class="string">&#x27;x&#x27;</span>], [<span class="number">2</span>, <span class="string">&#x27;y&#x27;</span>], [<span class="number">3</span>, <span class="string">&#x27;z&#x27;</span>]]);</span><br><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line">map.<span class="title function_">set</span>(key,value); <span class="comment">//设置一个值</span></span><br><span class="line">map.<span class="title function_">get</span>(key)    <span class="comment">//获取一个值</span></span><br><span class="line">map.<span class="title function_">delete</span>(key)    <span class="comment">//删除一项</span></span><br><span class="line">map.<span class="title function_">has</span>(key)    <span class="comment">//判断有没有</span></span><br><span class="line">map.<span class="title function_">clear</span>()    <span class="comment">//清空</span></span><br><span class="line">map.<span class="title function_">forEach</span>(<span class="function">(<span class="params">value, key</span>) =&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(value, key);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">array.<span class="title function_">map</span>(callback)</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">遍历数组的每一项</span></span><br><span class="line"><span class="comment">对每一项执行 callback 函数</span></span><br><span class="line"><span class="comment">返回一个新的数组（不改变原数组）</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h2 id="数组对象Array"><a href="#数组对象Array" class="headerlink" title="数组对象Array"></a>数组对象Array</h2><ul>
<li>有些数组方法不会改变原数组，有些则会改变原数组。<br>改变原数组的方法（3对+2单）：fill()、pop&#x2F;push()、unshift&#x2F;shift()、reverse&#x2F;sort()、splice()</li>
</ul>
<table>
<thead>
<tr>
<th>原数组不变方法</th>
<th>用途</th>
</tr>
</thead>
<tbody><tr>
<td><code>map()</code></td>
<td>遍历并生成新数组</td>
</tr>
<tr>
<td><code>filter()</code></td>
<td>条件筛选出新数组</td>
</tr>
<tr>
<td><code>reduce()</code></td>
<td>聚合（如求和）</td>
</tr>
<tr>
<td><code>slice()</code></td>
<td>截取部分数组 （不含末尾）</td>
</tr>
<tr>
<td><code>concat()</code></td>
<td>合并数组</td>
</tr>
<tr>
<td><code>includes()</code></td>
<td>判断是否包含元素</td>
</tr>
<tr>
<td><code>join()</code></td>
<td>连接数组元素为字符串</td>
</tr>
<tr>
<td><code>toSorted()</code></td>
<td>排序返回新数组（ES2023）</td>
</tr>
</tbody></table>
<ul>
<li>sort排序算法原理：插入排序、快排。<br>当数组长度小于等于10的时候，采用插入排序，大于10的时候，采用快排。</li>
<li>判断两个数组值是否相等<br>不能用等号判断，它是比较引用地址的<br>用JSON.stringify()判断，但缺点是如果是对象或嵌套数组的复杂数组，会报错</li>
<li>检测是否为数组<br>instanceof 运算符：instanceof 可以判断一个对象是否是某个构造函数的实例</li>
</ul>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">23</span>];</span><br><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr <span class="keyword">instanceof</span> <span class="title class_">Array</span>); <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj <span class="keyword">instanceof</span> <span class="title class_">Array</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<p>Array.isArray()用于判断一个对象是否为数组，isArray() 是 HTML5 中提供的方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">23</span>];</span><br><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Array</span>.<span class="title function_">isArray</span>(arr));   <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Array</span>.<span class="title function_">isArray</span>(obj));   <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<ul>
<li>不要对数组用 in 来判断值是否存在<br>数组用 includes()，不要用 in，因为in是判断索引是否存在</li>
<li>清空数组最简单最快捷方法就是arr.length&#x3D;0</li>
<li>创建</li>
</ul>
<table>
<thead>
<tr>
<th>创建方式</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>字面量</td>
<td><code>const arr = [1, 2, 3];</code></td>
</tr>
<tr>
<td>构造函数</td>
<td><code>new Array(3)</code> → [empty × 3]</td>
</tr>
<tr>
<td>Array.of</td>
<td><code>Array.of(&#39;apple&#39;,&#39;banana&#39;,&#39;orange&#39;)</code></td>
</tr>
<tr>
<td>arr.fill(填充东西, 开始位置, 结束位置);</td>
<td><code>Array.from(&#39;abc&#39;)</code> → <code>[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]</code>具备length属性的类数组都能转换</td>
</tr>
<tr>
<td>类数组转换成数组</td>
<td><code>[...arguments]</code></td>
</tr>
</tbody></table>
<ul>
<li>遍历<br>数组的 map 和 forEach 方法不支持提前结束循环，无法break 或 return 跳出循环。但是可以使用抛出异常方式来达到提前结束循环的效果。</li>
</ul>
<table>
<thead>
<tr>
<th>遍历方式</th>
<th>用法示例</th>
</tr>
</thead>
<tbody><tr>
<td><code>for</code></td>
<td><code>for (let i = 0; i &lt; arr.length; i++)</code></td>
</tr>
<tr>
<td><code>for...of</code></td>
<td><code>for (let item of arr)</code></td>
</tr>
<tr>
<td><code>forEach</code></td>
<td><code>arr.forEach(item =&gt; …)</code></td>
</tr>
<tr>
<td><code>map</code>（返回新数组）</td>
<td><code>arr.map(item =&gt; item * 2)</code></td>
</tr>
<tr>
<td><code>filter</code>（筛选）</td>
<td><code>arr.filter(item =&gt; item &gt; 2)</code></td>
</tr>
<tr>
<td><code>reduce</code>（归并）</td>
<td><code>arr.reduce((a, b) =&gt; a + b, 0)</code></td>
</tr>
<tr>
<td><code>for...in</code>（❌不推荐）</td>
<td>遍历索引+原型链，不适合数组</td>
</tr>
<tr>
<td>some</td>
<td>只要一个true就提前返回true</td>
</tr>
<tr>
<td>every</td>
<td>必须所有都是true才是true，只要一个false就提前返回false</td>
</tr>
<tr>
<td>find &#x2F; findIndex</td>
<td>返回第一个通过测试的元素&#x2F;元素索引</td>
</tr>
</tbody></table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br></pre></td><td class="code"><pre><span class="line">a.<span class="title function_">push</span>(<span class="string">&#x27;a&#x27;</span>)<span class="comment">//向Array的末尾添加若干元素</span></span><br><span class="line">a.<span class="title function_">pop</span>()<span class="comment">//把Array的最后一个元素删除掉</span></span><br><span class="line">a.<span class="title function_">unshift</span>(<span class="string">&#x27;a&#x27;</span>)<span class="comment">//往Array的头部添加若干元素</span></span><br><span class="line">a.<span class="title function_">shift</span>(<span class="string">&#x27;a&#x27;</span>)<span class="comment">//把Array的第一个元素删掉.</span></span><br><span class="line"></span><br><span class="line">a.<span class="property">length</span></span><br><span class="line"><span class="comment">//直接给Array的length赋一个新的值会导致Array大小的变化(索引超过范围也可)。</span></span><br><span class="line">arr.<span class="property">length</span> = <span class="number">6</span>;</span><br><span class="line">arr; <span class="comment">// arr变为[1, 2, 3, undefined, undefined, undefined]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//查找元素</span></span><br><span class="line">a.<span class="title function_">indexOf</span>(<span class="string">&#x27;c&#x27;</span>)<span class="comment">//搜索一个指定的元素的位置。没找到返回-1</span></span><br><span class="line"><span class="comment">//lastIndexOf</span></span><br><span class="line">arr.<span class="title function_">includes</span>(<span class="number">3</span>);    <span class="comment">// 是否包含（ES7）</span></span><br><span class="line">arr.<span class="title function_">find</span>(<span class="function"><span class="params">x</span> =&gt;</span> x &gt; <span class="number">2</span>);   <span class="comment">// 找第一个满足条件的值</span></span><br><span class="line">arr.<span class="title function_">findIndex</span>(<span class="function"><span class="params">x</span> =&gt;</span> x &gt; <span class="number">2</span>); <span class="comment">// 找索引</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//拍平成一维数组</span></span><br><span class="line">arr.<span class="title function_">flat</span>(depth) <span class="comment">//默认拍平一层</span></span><br><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, [<span class="number">2</span>, [<span class="number">3</span>, [<span class="number">4</span>]]]];</span><br><span class="line"><span class="keyword">const</span> result = arr.<span class="title function_">flat</span>(<span class="number">1</span>);<span class="comment">//[1, 2, [3, [4]]]</span></span><br><span class="line">[<span class="number">1</span>, [<span class="number">2</span>, [<span class="number">3</span>, [<span class="number">4</span>]]]].<span class="title function_">flat</span>(<span class="number">2</span>); <span class="comment">// [1, 2, 3, [4]]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> counts=<span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">30</span>).<span class="title function_">fill</span>(<span class="number">0</span>);<span class="comment">//30个0</span></span><br><span class="line"><span class="keyword">const</span> rows = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">9</span>).<span class="title function_">fill</span>(<span class="number">0</span>).<span class="title function_">map</span>(<span class="function">() =&gt;</span> <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">9</span>).<span class="title function_">fill</span>(<span class="number">0</span>));</span><br><span class="line"><span class="comment">//二重数组</span></span><br><span class="line"><span class="keyword">const</span> rows = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">9</span>).<span class="title function_">fill</span>(<span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">9</span>).<span class="title function_">fill</span>(<span class="number">0</span>)); <span class="comment">// ❌</span></span><br><span class="line"><span class="comment">//这种会生成 9 个对同一个数组的引用，导致修改一行所有行都会变！</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Array</span>.<span class="title function_">isArray</span>(list) </span><br><span class="line"></span><br><span class="line">a.<span class="title function_">toString</span>()<span class="comment">//元素连成一串，逗号分隔</span></span><br><span class="line"><span class="comment">//join()把当前Array的每个元素都用指定的字符串连接起来并返回 默认拼接用&#x27;,&#x27;</span></span><br><span class="line"><span class="comment">//如果Array元素不是字符串，将自动转换为字符串后再连接</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">arr.<span class="title function_">join</span>(<span class="string">&#x27;-&#x27;</span>); <span class="comment">// &#x27;A-B-C-1-2-3&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">compare</span>(<span class="params">a,b</span>)&#123;<span class="comment">//反着写可以实现降序 等价于return b-a;</span></span><br><span class="line">	<span class="keyword">if</span>(a&lt;b)<span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (a&gt;b)<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="comment">//等价于 return a-b</span></span><br><span class="line">&#125;</span><br><span class="line">a.<span class="title function_">sort</span>(compare);<span class="comment">//把所有元素先转换为String再排序，返回结果直接修改a</span></span><br><span class="line"><span class="comment">//字符串根据ASCII码进行排序，而小写字母a的ASCII码在大写字母之后.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//当前的Array和另一个Array连接起来，并返回一个新的Array</span></span><br><span class="line"><span class="comment">//并没有修改当前Array，而是返回了一个新的Array</span></span><br><span class="line"><span class="comment">//接收任意个元素的Array，自动把Array包含的括号拆掉，全部添加到新的Array里</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>];</span><br><span class="line">arr.<span class="title function_">concat</span>(<span class="number">1</span>, <span class="number">2</span>, [<span class="number">3</span>, <span class="number">4</span>]); <span class="comment">// [&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, 1, 2, 3, 4]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> arr2 = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>];</span><br><span class="line"><span class="keyword">let</span> result = [...arr1, ...arr2];  <span class="comment">// 使用扩展运算符追加数组</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//slice()对应String的substring()版本 前闭后开</span></span><br><span class="line"><span class="comment">//截取Array部分元素，返回新Array</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;G&#x27;</span>];</span><br><span class="line">arr.<span class="title function_">slice</span>(<span class="number">0</span>, <span class="number">3</span>); <span class="comment">// 从索引0开始，到索引3结束，但不包括索引3: [&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;]</span></span><br><span class="line">arr.<span class="title function_">slice</span>(<span class="number">3</span>); <span class="comment">// 从索引3开始到结束: [&#x27;D&#x27;, &#x27;E&#x27;, &#x27;F&#x27;, &#x27;G&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//splice万能方法:删除、插入、替换</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">index 必需。整数，规定添加/删除项目的位置，使用负数可从数组结尾处规定位置（从1开始）。</span></span><br><span class="line"><span class="comment">howmany必需。要删除的项目数量。如果设置为 0，则不会删除项目。</span></span><br><span class="line"><span class="comment">item1, …, itemX —— 可选。向数组添加的新项目。</span></span><br><span class="line"><span class="comment">1.当不添加只删除时，没有可选参数，则（删除开始索引，删除个数）</span></span><br><span class="line"><span class="comment">2.当不删除只添加时，（添加开始索引，删除个数=0，items...）</span></span><br><span class="line"><span class="comment">3.删除且添加，（删除且添加的开始索引，删除个数，items...）</span></span><br><span class="line"><span class="comment">4.当删除个数等于添加个数时 实现替换功能</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="string">&#x27;Microsoft&#x27;</span>, <span class="string">&#x27;Apple&#x27;</span>, <span class="string">&#x27;Yahoo&#x27;</span>, <span class="string">&#x27;AOL&#x27;</span>, <span class="string">&#x27;Excite&#x27;</span>, <span class="string">&#x27;Oracle&#x27;</span>];</span><br><span class="line"><span class="comment">// 从索引2开始删除3个元素,然后再添加两个元素:</span></span><br><span class="line">arr.<span class="title function_">splice</span>(<span class="number">2</span>, <span class="number">3</span>, <span class="string">&#x27;Google&#x27;</span>, <span class="string">&#x27;Facebook&#x27;</span>); <span class="comment">// 返回删除的元素 [&#x27;Yahoo&#x27;, &#x27;AOL&#x27;, &#x27;Excite&#x27;]</span></span><br><span class="line">arr; <span class="comment">// [&#x27;Microsoft&#x27;, &#x27;Apple&#x27;, &#x27;Google&#x27;, &#x27;Facebook&#x27;, &#x27;Oracle&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 只删除,不添加:</span></span><br><span class="line">arr.<span class="title function_">splice</span>(<span class="number">2</span>, <span class="number">2</span>); <span class="comment">// [&#x27;Google&#x27;, &#x27;Facebook&#x27;]</span></span><br><span class="line">arr; <span class="comment">// [&#x27;Microsoft&#x27;, &#x27;Apple&#x27;, &#x27;Oracle&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 只添加,不删除:</span></span><br><span class="line">arr.<span class="title function_">splice</span>(<span class="number">2</span>, <span class="number">0</span>, <span class="string">&#x27;Google&#x27;</span>, <span class="string">&#x27;Facebook&#x27;</span>); <span class="comment">// 返回[],因为没有删除任何元素</span></span><br><span class="line">arr; <span class="comment">// [&#x27;Microsoft&#x27;, &#x27;Apple&#x27;, &#x27;Google&#x27;, &#x27;Facebook&#x27;, &#x27;Oracle&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//替换</span></span><br><span class="line">arr.<span class="title function_">splice</span>(<span class="number">1</span>,<span class="number">1</span>,<span class="string">&#x27;ok&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//过滤 filter</span></span><br><span class="line"><span class="keyword">var</span> r = arr.<span class="title function_">filter</span>(<span class="keyword">function</span> (<span class="params">element, index, self</span>) &#123;...&#125;)</span><br><span class="line"><span class="keyword">var</span> result=arr.<span class="title function_">filter</span>(<span class="keyword">function</span>(<span class="params">item,index,array</span>)&#123;</span><br><span class="line">	<span class="keyword">return</span> item&gt;<span class="number">10</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="literal">null</span>, <span class="literal">undefined</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;  &#x27;</span>];</span><br><span class="line"><span class="keyword">var</span> r = arr.<span class="title function_">filter</span>(<span class="keyword">function</span> (<span class="params">s</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> s &amp;&amp; s.<span class="title function_">trim</span>(); <span class="comment">//IE9以下的版本没有trim()方法</span></span><br><span class="line">    <span class="comment">//trim()去除字符串两边的空白</span></span><br><span class="line">&#125;);</span><br><span class="line">r; <span class="comment">// [&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;]</span></span><br><span class="line"></span><br><span class="line">arr.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">value, index, array</span>) &#123;<span class="comment">//没有返回值</span></span><br><span class="line">       <span class="comment">//参数一是:当前数组元素值</span></span><br><span class="line">       <span class="comment">//参数二是:当前数组元素的索引</span></span><br><span class="line">       <span class="comment">//参数三是:当前的数组</span></span><br><span class="line">       <span class="comment">//可省略某些参数</span></span><br><span class="line"> &#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">let</span> isBreak = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  arr.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (item === <span class="number">3</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;break&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(item);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="keyword">if</span> (e.<span class="property">message</span> === <span class="string">&#x27;break&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;循环提前结束&#x27;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> e;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">array.<span class="title function_">map</span>(callback)</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">遍历数组的每一项</span></span><br><span class="line"><span class="comment">对每一项执行 callback 函数</span></span><br><span class="line"><span class="comment">返回一个新的数组（不改变原数组）</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//把Array的所有数字转为字符串</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>];</span><br><span class="line">arr.<span class="title function_">map</span>(<span class="title class_">String</span>); <span class="comment">// [&#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;4&#x27;, &#x27;5&#x27;, &#x27;6&#x27;, &#x27;7&#x27;, &#x27;8&#x27;, &#x27;9&#x27;]</span></span><br><span class="line">r=[<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>].<span class="title function_">map</span>(<span class="function"><span class="params">str</span> =&gt;</span> <span class="built_in">parseInt</span>(str));</span><br><span class="line"><span class="keyword">var</span> mapresult=arr.<span class="title function_">map</span>(<span class="keyword">function</span>(<span class="params">item,index,array</span>)&#123;</span><br><span class="line">	<span class="keyword">return</span> item*<span class="number">2</span>;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">array.<span class="property">map</span>（<span class="title class_">Number</span>） <span class="comment">//极简写法！！</span></span><br><span class="line">                                                    </span><br><span class="line"><span class="comment">//arr.map() 是数组专有的循环 非常有用，做数据交互映射，配合return，返回一个新数组，没有return时==foreach</span></span><br><span class="line"><span class="keyword">let</span> newArr = arr.<span class="title function_">map</span>(<span class="function">(<span class="params">item, index, arr</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> json=&#123;&#125;;</span><br><span class="line">    json.<span class="property">t</span> = <span class="string">`^_^<span class="subst">$&#123;item.title&#125;</span>-----`</span>;<span class="comment">//将title内容增加了符号</span></span><br><span class="line">    json.<span class="property">r</span> = item.<span class="property">read</span>+<span class="number">200</span>;<span class="comment">//变更了read人数</span></span><br><span class="line">    json.<span class="property">hot</span> = item.<span class="property">hot</span> == <span class="literal">true</span> &amp;&amp; <span class="string">&#x27;真棒!!!&#x27;</span>;<span class="comment">//将true显示为其他内容</span></span><br><span class="line">    <span class="keyword">return</span> json;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> newArr = arr.<span class="title function_">filter</span>(<span class="keyword">function</span>(<span class="params">value, index,array</span>) &#123;</span><br><span class="line">  	 <span class="comment">//参数一是:数组元素</span></span><br><span class="line">     <span class="comment">//参数二是:数组元素的索引</span></span><br><span class="line">     <span class="comment">//参数三是:当前的数组</span></span><br><span class="line">     <span class="keyword">return</span> value &gt;= <span class="number">20</span>;</span><br><span class="line">  &#125;);<span class="comment">//返回新数组</span></span><br><span class="line"><span class="comment">//arr.filter() 过滤不合格 返回true 留下来</span></span><br><span class="line"><span class="keyword">let</span> newArr = arr.<span class="title function_">filter</span>(<span class="function">(<span class="params">item, index, arr</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> item.<span class="property">hot</span>==<span class="literal">false</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//arr.some() 类似查找  数组里有某元素符合条件返回true</span></span><br><span class="line"><span class="comment">//arr.every() 数组里所有元素满足条件返回true</span></span><br><span class="line"><span class="keyword">let</span> b = arr.<span class="title function_">some</span>(<span class="function">(<span class="params">val, index, arr</span>) =&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> val==<span class="string">&#x27;banana2&#x27;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> b = arr.<span class="title function_">every</span>(<span class="function">(<span class="params">val, index, arr</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> val%<span class="number">2</span>==<span class="number">1</span>;</span><br><span class="line">&#125;);</span><br><span class="line">arr.<span class="title function_">reduce</span>()  <span class="comment">//用来对数组中的所有元素进行累积计算，最终得到一个单一的结果(值/数组/类数组)。</span></span><br><span class="line">arr.<span class="title function_">reduceRight</span>()</span><br><span class="line"><span class="comment">//比如：求数组的和、阶乘</span></span><br><span class="line">array.<span class="title function_">reduce</span>(<span class="function">(<span class="params">a,b</span>)=&gt;</span>a+b);</span><br><span class="line"><span class="keyword">const</span> sum = numbers.<span class="title function_">reduce</span>(<span class="function">(<span class="params">accumulator, currentValue</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> accumulator + currentValue;</span><br><span class="line">&#125;, <span class="number">0</span>); <span class="comment">// 初始值是 0</span></span><br><span class="line"><span class="comment">//找最大值 有很多种写法</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">max</span>(...numbers)</span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">min</span>(...numbers)</span><br><span class="line">                                                    </span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">max</span>(...[<span class="number">0.01</span>, <span class="number">0</span>, <span class="number">0</span>])</span><br><span class="line"><span class="title class_">Math</span>.<span class="property">max</span>.<span class="title function_">apply</span>(<span class="literal">null</span>, [<span class="number">0.01</span>, <span class="number">0</span>, <span class="number">0</span>])</span><br><span class="line"><span class="title class_">Math</span>.<span class="property">max</span>.<span class="title function_">call</span>(<span class="literal">null</span>, ...[<span class="number">0.01</span>, <span class="number">0</span>, <span class="number">0</span>])</span><br><span class="line">                                                    </span><br><span class="line"><span class="keyword">const</span> max = numbers.<span class="title function_">reduce</span>(<span class="function">(<span class="params">accumulator, currentValue</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> accumulator &gt; currentValue ? accumulator : currentValue;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">arr.reduce(callback(accumulator, currentValue[, index, array]), initialValue);</span></span><br><span class="line"><span class="comment">accumulator：保存结果的容器累积器，保存上次函数调用的返回值，或者是初始化的 initialValue。</span></span><br><span class="line"><span class="comment">currentValue：当前正在处理的数组元素。</span></span><br><span class="line"><span class="comment">index（可选）：当前元素的索引。</span></span><br><span class="line"><span class="comment">array（可选）：原数组。</span></span><br><span class="line"><span class="comment">initialValue（可选）：累积器的初始值。</span></span><br><span class="line"><span class="comment">如果没有提供，则数组的第一个元素会被用作初始值，第二个元素会作为 currentValue 开始迭代。</span></span><br><span class="line"><span class="comment">如果数组为空，且没有提供 initialValue，reduce() 会抛出错误。如果提供了 initialValue，则直接返回它。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">arr.<span class="title function_">find</span>()<span class="comment">//查找，找出第一个符合条件的数组成员，如果没有找到，返回undefined</span></span><br><span class="line"><span class="keyword">let</span> res = arr.<span class="title function_">find</span>(<span class="function">(<span class="params">val, index, arr</span>) =&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> val&gt;<span class="number">1000</span>;</span><br><span class="line">&#125;);</span><br><span class="line">arr.<span class="title function_">findIndex</span>()<span class="comment">// 找的是位置， 没找到返回-1</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">arr.reduce(function(prev,cur,index,arr)&#123;</span></span><br><span class="line"><span class="comment">...</span></span><br><span class="line"><span class="comment">&#125;, init);</span></span><br><span class="line"><span class="comment">prev ：上一次调用回调时的返回值，或者初始值 init;</span></span><br><span class="line"><span class="comment">cur ： 当前正在处理的数组元素；</span></span><br><span class="line"><span class="comment">index ：当前正在处理的数组元素的索引，若提供 init 值，则索引为0，否则索引为1；</span></span><br><span class="line"><span class="comment">arr ：原数组；</span></span><br><span class="line"><span class="comment">init ：初始值</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//reduce()从左到右累加数据，直到最后为一个值（也就是最终的结果）</span></span><br><span class="line">[x1, x2, x3, x4].<span class="title function_">reduce</span>(f) = <span class="title function_">f</span>(<span class="title function_">f</span>(<span class="title function_">f</span>(x1, x2), x3), x4)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> min_str=strs.<span class="title function_">reduce</span>(<span class="function">(<span class="params">min,str</span>)=&gt;</span><span class="title class_">Math</span>.<span class="title function_">min</span>(min,str.<span class="property">length</span>),<span class="title class_">Infinity</span>);</span><br><span class="line"><span class="comment">//Infinity是初始值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//array</span></span><br><span class="line">arrayObject.<span class="title function_">splice</span>(index,howmany,item1,.....,itemX)</span><br><span class="line"><span class="comment">//数组中添加或删除项目，然后返回被删除的项目。该方法会改变原始数组。</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">可删除从 index 处开始的零个或多个元素，并且用参数列表中声明的一个或多个值来替换那些被删除的元素。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">参数	描述</span></span><br><span class="line"><span class="comment">index	必需。整数，规定添加/删除项目的位置，使用负数可从数组结尾处规定位置。</span></span><br><span class="line"><span class="comment">howmany	必需。要删除的项目数量。如果设置为 0，则不会删除项目。</span></span><br><span class="line"><span class="comment">item1, ..., itemX	可选。向数组添加的新项目。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">返回值 被删除的项目，如果没有删除元素，就返回一个空数组。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Array.from方法还可以接受第二个参数，</span></span><br><span class="line"><span class="comment">//作用类似于数组的map方法，用来对每个元素进行处理，将处理后的值放入返回的数组</span></span><br><span class="line"><span class="comment">//注意：如果是对象，那么属性需要写对应的索引</span></span><br><span class="line"> <span class="keyword">let</span> arrayLike = &#123; </span><br><span class="line">     <span class="string">&quot;0&quot;</span>: <span class="number">1</span>,</span><br><span class="line">     <span class="string">&quot;1&quot;</span>: <span class="number">2</span>,</span><br><span class="line">     <span class="string">&quot;length&quot;</span>: <span class="number">2</span></span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">let</span> newAry = <span class="title class_">Array</span>.<span class="title function_">from</span>(arrayLike, <span class="function"><span class="params">item</span> =&gt;</span> item *<span class="number">2</span>)<span class="comment">//[2,4]</span></span><br><span class="line"></span><br><span class="line">arr.<span class="title function_">entries</span>() <span class="comment">//返回的是一个包含数组元素索引和对应值的迭代器（Iterator）。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//浅拷贝</span></span><br><span class="line"><span class="keyword">const</span> copy = arr.<span class="title function_">slice</span>();</span><br><span class="line"><span class="keyword">const</span> copy2 = [...arr];</span><br><span class="line"><span class="comment">//去重</span></span><br><span class="line"><span class="keyword">const</span> unique = [...<span class="keyword">new</span> <span class="title class_">Set</span>(arr)];</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>&#x3D;&#x3D;多维数组&#x3D;&#x3D;<br>嵌套Array<br>举例子：<code>var arr = [[1, 2, 3], [400, 500, 600], &#39;-&#39;];</code></li>
</ul>
<table>
<thead>
<tr>
<th>0</th>
<th>1</th>
<th>2</th>
</tr>
</thead>
<tbody><tr>
<td>400</td>
<td>500</td>
<td>600</td>
</tr>
<tr>
<td>-</td>
<td>undefined</td>
<td>undefined</td>
</tr>
</tbody></table>
<h2 id="集合Set"><a href="#集合Set" class="headerlink" title="集合Set"></a>集合Set</h2><p>没有索引index</p>
<table>
<thead>
<tr>
<th>操作</th>
<th>示例代码</th>
</tr>
</thead>
<tbody><tr>
<td>添加元素</td>
<td><code>set.add(value)</code></td>
</tr>
<tr>
<td>删除元素</td>
<td><code>set.delete(value)</code></td>
</tr>
<tr>
<td>是否包含</td>
<td><code>set.has(value)</code></td>
</tr>
<tr>
<td>清空</td>
<td><code>set.clear()</code></td>
</tr>
<tr>
<td>长度</td>
<td><code>set.size</code></td>
</tr>
<tr>
<td>遍历</td>
<td><code>for/of</code>, <code>forEach</code>, <code>[...set]</code></td>
</tr>
<tr>
<td>并集</td>
<td><code>new Set([...a, ...b])</code></td>
</tr>
<tr>
<td>交集</td>
<td><code>new Set([...a].filter(x =&gt; b.has(x)))</code></td>
</tr>
<tr>
<td>差集</td>
<td><code>new Set([...a].filter(x =&gt; !b.has(x)))</code></td>
</tr>
<tr>
<td>对称差</td>
<td><code>new Set([...a, ...b].filter(x =&gt; !(a.has(x) &amp;&amp; b.has(x))))</code></td>
</tr>
<tr>
<td>子集</td>
<td><code>[...a].every(x =&gt; b.has(x))</code></td>
</tr>
<tr>
<td>创建</td>
<td><code>const s = new Set([1, 2, 3]);</code></td>
</tr>
</tbody></table>
<h2 id="字符串对象"><a href="#字符串对象" class="headerlink" title="字符串对象"></a>字符串对象</h2><ul>
<li>内部按 UTF-16 编码（中文占两个字节）</li>
<li>字符串不可变<br>指里面值不可变，虽然看上去可以改变内容，但其实是地址变了，内存中新开辟了一个内存空间。<br>当重新给字符串变量赋值的时候，变量之前保存的字符串不会被修改，依然在内存中重新给字符串赋值，会重新在内存中开辟空间<br>由于字符串不可变，在<strong>大量拼接字符串</strong>会有效率问题<br>字符串是不可变的，如果对字符串的某个索引赋值，不会有任何错误，但是也没有任何效果。<br>JavaScript为字符串提供常用方法，注意，调用方法不会改变原有字符串的内容，而是<strong>返回新字符串</strong>。</li>
</ul>
<blockquote>
<p>到底可变不可变？重新赋值整个字符串-&gt;可变，单独修改其中字符-&gt;不可变</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line">\b 空格blank <span class="comment">//转义字符</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//分割</span></span><br><span class="line"><span class="comment">//正则表达式</span></span><br><span class="line"><span class="string">&#x27;a b   c&#x27;</span>.<span class="title function_">split</span>(<span class="string">&#x27; &#x27;</span>); <span class="comment">// [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;c&#x27;] </span></span><br><span class="line"><span class="comment">//一个空格隔开的字符串</span></span><br><span class="line"></span><br><span class="line">a b   c<span class="string">&#x27;.split(/\s+/); // [&#x27;</span>a<span class="string">&#x27;, &#x27;</span>b<span class="string">&#x27;, &#x27;</span>c<span class="string">&#x27;] //</span></span><br><span class="line"><span class="string">//至少一个空格隔开的</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;</span>a,b, c  d<span class="string">&#x27;.split(/[\s\,]+/); // [&#x27;</span>a<span class="string">&#x27;, &#x27;</span>b<span class="string">&#x27;, &#x27;</span>c<span class="string">&#x27;, &#x27;</span>d<span class="string">&#x27;]</span></span><br><span class="line"><span class="string">//至少一个空格或逗号隔开的</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;</span>a,b;; c  d<span class="string">&#x27;.split(/[\s\,\;]+/); // [&#x27;</span>a<span class="string">&#x27;, &#x27;</span>b<span class="string">&#x27;, &#x27;</span>c<span class="string">&#x27;, &#x27;</span>d<span class="string">&#x27;]</span></span><br><span class="line"><span class="string">//至少一个空格或逗号或分号隔开的</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;</span><span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span><span class="string">&#x27;.split(&#x27;</span>,<span class="string">&#x27;);  // [&#x27;</span><span class="number">1</span><span class="string">&#x27;, &#x27;</span><span class="number">2</span><span class="string">&#x27;, &#x27;</span><span class="number">3</span><span class="string">&#x27;]</span></span><br><span class="line"><span class="string">[&#x27;</span>a<span class="string">&#x27;, &#x27;</span>b<span class="string">&#x27;].join(&#x27;</span>-<span class="string">&#x27;) // &#x27;</span>a-b<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">//创建</span></span><br><span class="line"><span class="string">var str=&#x27;</span>ok<span class="string">&quot;fine&quot;</span>?\n<span class="string">&#x27;//转义字符\</span></span><br><span class="line"><span class="string">var a=&#x27;</span>nihao<span class="string">&#x27;+521;//支持隐式转换</span></span><br><span class="line"><span class="string">//如果&#x27;</span>也在内容中，用<span class="string">&quot;&quot;</span>括起来</span><br><span class="line"><span class="keyword">const</span> str = <span class="string">`第一行 //多行字符串</span></span><br><span class="line"><span class="string">第二行</span></span><br><span class="line"><span class="string">第三行`</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str);</span><br><span class="line"><span class="comment">// 输出：</span></span><br><span class="line"><span class="comment">// 第一行</span></span><br><span class="line"><span class="comment">// 第二行</span></span><br><span class="line"><span class="comment">// 第三行</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//获取字符</span></span><br><span class="line"><span class="string">&#x27;abc&#x27;</span>.<span class="title function_">charAt</span>(<span class="number">1</span>)      <span class="comment">// &#x27;b&#x27;</span></span><br><span class="line"><span class="string">&#x27;abc&#x27;</span>[<span class="number">1</span>]             <span class="comment">// &#x27;b&#x27; ✅ 推荐写法</span></span><br><span class="line"><span class="string">&#x27;abc&#x27;</span>.<span class="title function_">charCodeAt</span>(<span class="number">1</span>)  <span class="comment">// 98（字符编码）</span></span><br><span class="line"><span class="string">&#x27;中&#x27;</span>.<span class="title function_">charCodeAt</span>(<span class="number">0</span>)    <span class="comment">// 返回 UTF-16 编码</span></span><br><span class="line"><span class="string">&#x27;中&#x27;</span>.<span class="title function_">codePointAt</span>(<span class="number">0</span>)   <span class="comment">// 返回完整 Unicode 编码 ✅</span></span><br><span class="line"><span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(<span class="number">20013</span>);  <span class="comment">// &#x27;中&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isAlphaNumeric</span>(<span class="params">c</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> code = c.<span class="title function_">charCodeAt</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    (code &gt;= <span class="number">48</span> &amp;&amp; code &lt;= <span class="number">57</span>) ||  <span class="comment">// 0-9</span></span><br><span class="line">    (code &gt;= <span class="number">65</span> &amp;&amp; code &lt;= <span class="number">90</span>) ||  <span class="comment">// A-Z</span></span><br><span class="line">    (code &gt;= <span class="number">97</span> &amp;&amp; code &lt;= <span class="number">122</span>)    <span class="comment">// a-z</span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//查找子串</span></span><br><span class="line"><span class="string">&#x27;abc&#x27;</span>.<span class="title function_">includes</span>(<span class="string">&#x27;b&#x27;</span>)    <span class="comment">// true ✅</span></span><br><span class="line"><span class="string">&#x27;abc&#x27;</span>.<span class="title function_">indexOf</span>(<span class="string">&#x27;b&#x27;</span>)     <span class="comment">// 1 找不到返回-1</span></span><br><span class="line"><span class="comment">//lastIndexOf</span></span><br><span class="line"><span class="string">&#x27;abc&#x27;</span>.<span class="title function_">startsWith</span>(<span class="string">&#x27;a&#x27;</span>)  <span class="comment">// true ✅</span></span><br><span class="line"><span class="string">&#x27;abc&#x27;</span>.<span class="title function_">endsWith</span>(<span class="string">&#x27;c&#x27;</span>)    <span class="comment">// true ✅</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> s = <span class="string">&#x27;hello, world&#x27;</span>;</span><br><span class="line">s.<span class="title function_">indexOf</span>(<span class="string">&#x27;world&#x27;</span>); <span class="comment">// 返回7</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//截取字符串</span></span><br><span class="line"><span class="string">&#x27;abcdef&#x27;</span>.<span class="title function_">slice</span>(<span class="number">1</span>, <span class="number">4</span>);     <span class="comment">// &#x27;bcd&#x27; 支持负数</span></span><br><span class="line"><span class="string">&#x27;abcdef&#x27;</span>.<span class="title function_">substring</span>(<span class="number">1</span>, <span class="number">4</span>); <span class="comment">// &#x27;bcd&#x27;（不支持负数）</span></span><br><span class="line"><span class="string">&#x27;abcdef&#x27;</span>.<span class="title function_">substr</span>(<span class="number">1</span>, <span class="number">3</span>);    <span class="comment">// &#x27;bcd&#x27;（已废弃 ❌）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 大小写转换</span></span><br><span class="line"><span class="string">&#x27;abc&#x27;</span>.<span class="title function_">toUpperCase</span>(); <span class="comment">// &#x27;ABC&#x27;</span></span><br><span class="line"><span class="string">&#x27;ABC&#x27;</span>.<span class="title function_">toLowerCase</span>(); <span class="comment">// &#x27;abc&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//替换</span></span><br><span class="line"><span class="string">&#x27;abcabc&#x27;</span>.<span class="title function_">replace</span>(<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;x&#x27;</span>);       <span class="comment">// &#x27;xbcabc&#x27;（只替换第一个）</span></span><br><span class="line"><span class="string">&#x27;abcabc&#x27;</span>.<span class="title function_">replaceAll</span>(<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;x&#x27;</span>);    <span class="comment">// &#x27;xbcxbc&#x27; （ES2021）</span></span><br><span class="line"><span class="string">&#x27;abcabc&#x27;</span>.<span class="title function_">replace</span>(<span class="regexp">/a/g</span>, <span class="string">&#x27;x&#x27;</span>);      <span class="comment">// &#x27;xbcxbc&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//去除空格</span></span><br><span class="line"><span class="string">&#x27;  abc  &#x27;</span>.<span class="title function_">trim</span>();       <span class="comment">// &#x27;abc&#x27;</span></span><br><span class="line"><span class="string">&#x27;  abc  &#x27;</span>.<span class="title function_">trimStart</span>();  <span class="comment">// &#x27;abc  &#x27;</span></span><br><span class="line"><span class="string">&#x27;  abc  &#x27;</span>.<span class="title function_">trimEnd</span>();    <span class="comment">// &#x27;  abc&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//遍历</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> char <span class="keyword">of</span> <span class="string">&#x27;hello&#x27;</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(char); <span class="comment">// h e l l o</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//类型转换</span></span><br><span class="line"><span class="title class_">Number</span>(<span class="string">&#x27;123&#x27;</span>)       <span class="comment">// 123</span></span><br><span class="line"><span class="built_in">parseInt</span>(<span class="string">&#x27;12px&#x27;</span>)    <span class="comment">// 12</span></span><br><span class="line"><span class="title class_">String</span>(<span class="number">123</span>)         <span class="comment">// &#x27;123&#x27;</span></span><br><span class="line">(<span class="number">123</span>).<span class="title function_">toString</span>()    <span class="comment">// &#x27;123&#x27;</span></span><br><span class="line"><span class="built_in">parseFloat</span>(str) <span class="comment">//解析一个字符串，并返回一个浮点数;</span></span><br><span class="line"><span class="comment">//parseFloat() 可以正确解析Infinity， 而 parseInt() 无法识别 Infinity ：</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">countChar</span>(<span class="params">str, char</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> str.<span class="title function_">split</span>(char).<span class="property">length</span> - <span class="number">1</span>;<span class="comment">//对字符串中的某个字符计数</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">str.<span class="title function_">concat</span>(str1,str2,..)<span class="comment">//一般用+运算代替str.concat</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> s &amp;&amp; s.<span class="title function_">trim</span>()<span class="comment">//意思是</span></span><br><span class="line"><span class="keyword">if</span> (s) <span class="keyword">return</span> s.<span class="title function_">trim</span>();</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> s;</span><br><span class="line"></span><br><span class="line"><span class="title function_">toLocaleLowerCase</span>()<span class="comment">//根据所在地区 不同大小写的规则</span></span><br><span class="line"><span class="title function_">toLocaleUpperCase</span>()</span><br><span class="line"></span><br><span class="line">str.<span class="title function_">startsWith</span>()</span><br><span class="line">str.<span class="title function_">endsWith</span>()</span><br><span class="line">str.<span class="title function_">repeat</span>(count)</span><br><span class="line">str.<span class="title function_">split</span>(separator, limit);</span><br><span class="line"><span class="comment">//separator（可选）：指定分隔符，可以是一个字符串或正则表达式。用于确定在哪里切分字符串。如果不传递该参数，整个字符串将作为一个单独的元素放入返回的数组。</span></span><br><span class="line"><span class="comment">//limit（可选）：限制返回的数组的最大长度。如果指定了 limit，split() 将最多返回 limit 个元素。</span></span><br><span class="line">str.<span class="title function_">replace</span>(old,<span class="keyword">new</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>substring v.s. substr【废弃】<br>substring() 和 substr() 都是字符串方法，用于截取字符串部分。区别在于参数不同。<br>substring(起始位置，结束位置)<br>substr(起始位置，字符数)</li>
</ul>
<h2 id="Number"><a href="#Number" class="headerlink" title="Number"></a>Number</h2><p>实例方法 <code>toFixed</code> 用于设置保留小数位的长度，注意&#x3D;&#x3D;返回字符串&#x3D;&#x3D;<br>Number 可当做普通函数使用，强制转换成数值数据类型。</p>
<h2 id="BigInt"><a href="#BigInt" class="headerlink" title="BigInt"></a>BigInt</h2><p>只能表示整数</p>
<ul>
<li>使用</li>
</ul>
<p><code>const num=123123213712897n</code>必须带后缀n，代表是bigint</p>
<p>Math库不适合bigint</p>
<p>加减乘除只能作用于两个 bigint，记得做好数值类型转换；小数部分直接舍弃</p>
<p><code>typeof num //bigint</code></p>
<ul>
<li>类型转换</li>
</ul>
<p>bigint-&gt;number Number()超过范围的有精度损失</p>
<p>Number-&gt;bigint BigInt() number小数部分丢失</p>
<p>存储转换成字符串</p>
<ul>
<li>缺点：内存消耗、运算速度慢、转换开销大</li>
</ul>
<h2 id="数学对象Math"><a href="#数学对象Math" class="headerlink" title="数学对象Math"></a>数学对象Math</h2><table>
<thead>
<tr>
<th>属性、方法名</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>Math.PI</td>
<td>圆周率</td>
</tr>
<tr>
<td>Math.floor()</td>
<td>向下取整</td>
</tr>
<tr>
<td>Math.ceil()</td>
<td>向上取整</td>
</tr>
<tr>
<td>Math.round()</td>
<td>四舍五入版 就近取整   注意 -3.5   结果是  -3</td>
</tr>
<tr>
<td>Math.abs()</td>
<td>绝对值</td>
</tr>
<tr>
<td>Math.max()&#x2F;Math.min()</td>
<td>求最大和最小值<br>如果没有传入值，Math.max()返回Infinity，Math.min()返回-Infinity</td>
</tr>
<tr>
<td>Math.random()</td>
<td>获取范围在[0,1)内的随机值</td>
</tr>
</tbody></table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取指定范围内的随机整数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getRandom</span>(<span class="params">min, max</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * (max - min + <span class="number">1</span>)) + min; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Math</span>.<span class="property">E</span> <span class="comment">//e</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="property">LN10</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="property">LN2</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="property">LOG2E</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="property">PI</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="property">SQRT2</span> <span class="comment">//根号2</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="property">SQRT1_2</span> <span class="comment">//0.5的平方根</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">max</span>()</span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">min</span>()</span><br><span class="line"><span class="title class_">Math</span>.<span class="property">max</span>.<span class="title function_">apply</span>(<span class="literal">null</span>,arr);</span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">ceil</span>(num)</span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">floor</span>(num)</span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">round</span>(num)</span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">random</span>() <span class="comment">//0&lt;=random&lt;1</span></span><br><span class="line"><span class="title function_">random</span>(<span class="number">0</span>,<span class="number">36</span>)<span class="comment">//0~36随机</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">num</span>:number=<span class="number">0b1101</span>;<span class="comment">//0o173 0x7b 二八十六进制</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Number</span>.<span class="property">MAX_SAFE_INTEGER</span> <span class="comment">//BigInt解决 数字后+n表示是bigint类型</span></span><br></pre></td></tr></table></figure>

<h2 id="日期对象date"><a href="#日期对象date" class="headerlink" title="日期对象date"></a>日期对象date</h2><p>Date是一个构造函数，需要实例化后才能使用<br>注意：如果创建实例时并未传入参数，则得到的日期对象是当前时间对应的日期对象<br><img src="/images/JS%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0.assets/a845dd86e16c4afb844d9d234e53806d.png" alt="在这里插入图片描述"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>();<span class="comment">//获取系统当前时间；</span></span><br><span class="line"><span class="keyword">let</span> date= <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="string">&#x27;1949-10-01&#x27;</span>)<span class="comment">//指定时间</span></span><br><span class="line"><span class="keyword">var</span> oneday = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="string">&#x27;December 25,1995 13:30:00&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> oneday2=<span class="keyword">new</span> <span class="title class_">Date</span>(<span class="number">1995</span>,<span class="number">11</span>,<span class="number">25</span>);</span><br><span class="line"><span class="keyword">var</span> oneday3=<span class="keyword">new</span> <span class="title class_">Date</span>(<span class="number">1995</span>,<span class="number">11</span>,<span class="number">25</span>,<span class="number">14</span>,<span class="number">30</span>,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">var</span> future = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="string">&#x27;2019/5/1&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(now.<span class="title function_">getDate</span>());<span class="comment">//获取月份的第几天1～31</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(now.<span class="title function_">getMonth</span>());<span class="comment">//获取月份0～11</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(now.<span class="title function_">getFullYear</span>());<span class="comment">//获取年份</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(now.<span class="title function_">getDay</span>());<span class="comment">//获取一星期中第几天0～6</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(now.<span class="title function_">getHours</span>());<span class="comment">//获取小时0～23</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(now.<span class="title function_">getMinutes</span>());<span class="comment">//获取分钟0～59</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(now.<span class="title function_">getSeconds</span>());<span class="comment">//获取秒数0～59</span></span><br><span class="line">now.<span class="title function_">getMilliseconds</span>(); <span class="comment">// 毫秒数</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Date</span>.<span class="title function_">parse</span>()<span class="comment">//传入字符串使用实际月份01~12，转换为Date对象后getMonth()获取的月份值为0~11</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(now.<span class="title function_">toDateString</span>());<span class="comment">//星期几 月 日 年</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(now.<span class="title function_">toTimeString</span>());<span class="comment">//时 分 秒 时区</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//常用</span></span><br><span class="line">now.<span class="title function_">toLocaleDateString</span>()</span><br><span class="line">now.<span class="title function_">toLocaleTimeString</span>()</span><br><span class="line">now.<span class="title function_">toLocaleString</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">//时间戳 1970年头到现在的毫秒数</span></span><br><span class="line"><span class="comment">//获取总毫秒数 4种方法</span></span><br><span class="line"><span class="keyword">var</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>();<span class="comment">//获取系统当前时间；</span></span><br><span class="line">now.<span class="title function_">getTime</span>(); <span class="comment">// [1] 1435146562875, 以number形式表示的时间戳</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(+<span class="keyword">new</span> <span class="title class_">Date</span>())<span class="comment">//[2]</span></span><br><span class="line"><span class="keyword">var</span> now = <span class="title class_">Date</span>.<span class="title function_">now</span>();<span class="comment">//[3] HTML5中提供的方法，有兼容性问题</span></span><br><span class="line"><span class="comment">//无需实例化 但是只能得到当前的时间戳， 而前面两种可以返回指定时间的时间戳</span></span><br><span class="line">date.<span class="title function_">valueOf</span>() <span class="comment">//[4]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//获取当前时间</span></span><br><span class="line"><span class="keyword">var</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line"><span class="keyword">var</span> year = date.<span class="title function_">getFullYear</span>();</span><br><span class="line"><span class="keyword">var</span> month = date.<span class="title function_">getMonth</span>() + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> day = date.<span class="title function_">getDate</span>();</span><br><span class="line"><span class="comment">//这两个是针对小于十的时候，会为个位数</span></span><br><span class="line"><span class="keyword">if</span> (month &lt; <span class="number">10</span>) &#123;</span><br><span class="line">    month = <span class="string">&quot;0&quot;</span> + month;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (day &lt; <span class="number">10</span>) &#123;</span><br><span class="line">    day = <span class="string">&quot;0&quot;</span> + day;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> nowDate = year + <span class="string">&quot;-&quot;</span> + month + <span class="string">&quot;-&quot;</span> + day;</span><br><span class="line"><span class="comment">//输出结果格式：2021-11-08</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//现在距离 今年元旦 还有 X 天 X 小时 X 分钟 X秒</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">timemove</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 获取当前时间</span></span><br><span class="line">    <span class="keyword">let</span> d1 = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">    <span class="comment">//获取下一年</span></span><br><span class="line">    <span class="keyword">let</span> nextYear = d1.<span class="title function_">getFullYear</span>() + <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// 定义目标时间</span></span><br><span class="line">    <span class="keyword">let</span> d2 = <span class="keyword">new</span> <span class="title class_">Date</span>(nextYear + <span class="string">&quot;/1/1 00:00:00&quot;</span>);</span><br><span class="line">    <span class="comment">// 定义剩余时间</span></span><br><span class="line">    <span class="keyword">let</span> d = d2 - d1; <span class="comment">// 是一个时间戳</span></span><br><span class="line">    <span class="comment">// 计算剩余天数</span></span><br><span class="line">    <span class="keyword">let</span> <span class="title class_">Day</span> = <span class="built_in">parseInt</span>(d / <span class="number">1000</span> / <span class="number">60</span> / <span class="number">60</span> / <span class="number">24</span>);</span><br><span class="line">    <span class="comment">// 计算剩余小时</span></span><br><span class="line">    <span class="keyword">let</span> <span class="title class_">Hours</span> = <span class="built_in">parseInt</span>(d / <span class="number">1000</span> / <span class="number">60</span> / <span class="number">60</span> % <span class="number">24</span>);</span><br><span class="line">    <span class="comment">// 计算剩余分钟</span></span><br><span class="line">    <span class="keyword">let</span> <span class="title class_">Minutes</span> = <span class="built_in">parseInt</span>(d / <span class="number">1000</span> / <span class="number">60</span> % <span class="number">60</span>);</span><br><span class="line">    <span class="comment">// 计算剩余秒</span></span><br><span class="line">    <span class="keyword">let</span> <span class="title class_">Seconds</span> = <span class="built_in">parseInt</span>(d / <span class="number">1000</span> % <span class="number">60</span>);</span><br><span class="line">    <span class="comment">//拼接变量</span></span><br><span class="line">    <span class="keyword">let</span> time = <span class="title class_">Day</span> + <span class="string">&quot;天&quot;</span> + <span class="title class_">Hours</span> + <span class="string">&quot;小时&quot;</span> + <span class="title class_">Minutes</span> + <span class="string">&quot;分钟&quot;</span> + <span class="title class_">Seconds</span> + <span class="string">&quot;秒&quot;</span>;</span><br><span class="line">    <span class="comment">// 将拼接好的变量显示在页面</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;距离元旦还有&quot;</span> + time)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="函数进阶"><a href="#函数进阶" class="headerlink" title="函数进阶"></a>函数进阶</h1><h2 id="高阶函数"><a href="#高阶函数" class="headerlink" title="高阶函数"></a>高阶函数</h2><ul>
<li>定义：接受函数作为参数or把函数作为结果值返回。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1 函数表达式：把函数当值赋值给变量</span></span><br><span class="line"><span class="keyword">let</span> counter=<span class="keyword">function</span>(<span class="params">x,y</span>)&#123;<span class="keyword">return</span> x+y&#125;</span><br><span class="line"><span class="comment">//2 回调函数：把函数作为参数传递给另外一个函数 </span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sum</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> arr.<span class="title function_">reduce</span>(<span class="keyword">function</span> (<span class="params">x, y</span>) &#123;<span class="comment">//reduce降维</span></span><br><span class="line">        <span class="keyword">return</span> x + y;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">sum</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]); <span class="comment">// 15</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//3 函数作参数 回调函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params">callback</span>)&#123;</span><br><span class="line">	callback&amp;&amp;<span class="title function_">callback</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">fn</span>(<span class="keyword">function</span> (<span class="params"></span>)&#123;<span class="title function_">alert</span>(<span class="string">&#x27;h1&#x27;</span>)&#125;)</span><br></pre></td></tr></table></figure>

<p>如果不需要立刻求和，而是在后面的代码中，根据需要再计算怎么办？可以不返回求和的结果，而是返回求和的函数.<br>调用lazy_sum()时，返回的并不是求和结果，而是求和函数.调用函数f时，才真正计算求和的结果</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//函数表达式：把函数当值赋值给变量</span></span><br><span class="line"><span class="keyword">var</span> f = <span class="title function_">lazy_sum</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]); <span class="comment">// function sum()</span></span><br><span class="line"><span class="title function_">f</span>(); <span class="comment">// 15</span></span><br></pre></td></tr></table></figure>

<p>在函数lazy_sum中又定义了函数sum，并且内部函数sum可以引用外部函数lazy_sum的参数和局部变量，当lazy_sum返回函数sum时，相关参数和变量都保存在返回的函数中，这种称为“闭包（Closure）”<br>注意：当我们调用lazy_sum()时，每次调用都会返回一个新的函数，即使传入相同的参数</p>
<h2 id="闭包-closure"><a href="#闭包-closure" class="headerlink" title="闭包 (closure)"></a>闭包 (closure)</h2><ul>
<li><p>返回闭包时牢记：返回函数不要引用任何循环变量，或者后续会发生变化的变量。因为闭包会引用外部环境的变量，而这些变量值在循环结束后可能已经发生变化。<br>假设在循环中创建闭包，并将循环变量作为闭包函数的引用，最终所有闭包都会共享同一个变量的引用，并且这个变量在每次迭代时都会更新，导致闭包内部的值不是我们期望的。</p>
<p>如果一定要引用循环变量怎么办？方法是再创建一个函数，用该函数的参数绑定循环变量当前的值，无论该循环变量后续如何更改，已绑定到函数参数的值不变。</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//正确应用</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; lis.<span class="property">length</span>; i++) &#123;</span><br><span class="line"><span class="comment">// 利用for循环创建了4个立即执行函数</span></span><br><span class="line"><span class="comment">// 立即执行函数成为小闭包。因为立即执行函数里任何函数都可以使用它的i这变量</span></span><br><span class="line">(<span class="keyword">function</span>(<span class="params">i</span>) &#123;</span><br><span class="line">    lis[i].<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;)(i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//错误实例</span></span><br><span class="line"><span class="keyword">const</span> funcs = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">  funcs.<span class="title function_">push</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i);  <span class="comment">// 打印 i 的值</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 由于 `i` 是 `var`，它在整个函数作用域内是共享的，循环结束时 i = 3</span></span><br><span class="line">funcs[<span class="number">0</span>]();  <span class="comment">// 输出 3</span></span><br><span class="line">funcs[<span class="number">1</span>]();  <span class="comment">// 输出 3</span></span><br><span class="line">funcs[<span class="number">2</span>]();  <span class="comment">// 输出 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*解决方法</span></span><br><span class="line"><span class="comment">let 替代 var（块级作用域）</span></span><br><span class="line"><span class="comment">let 为每个循环迭代创建一个新的作用域，因此每次循环时，闭包捕获的 i 值是当前的值，不会和后续的值产生冲突。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> funcs = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">  funcs.<span class="title function_">push</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i);  <span class="comment">// 每个闭包捕获到的 `i` 是不同的</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">funcs[<span class="number">0</span>]();  <span class="comment">// 输出 0</span></span><br><span class="line">funcs[<span class="number">1</span>]();  <span class="comment">// 输出 1</span></span><br><span class="line">funcs[<span class="number">2</span>]();  <span class="comment">// 输出 2</span></span><br></pre></td></tr></table></figure>

<ul>
<li>没有class机制，借助闭包，封装私有变量<br>闭包就是携带状态的函数，其状态可以完全对外隐藏<br>工厂函数，因为像工厂一样生产对象。每次调用工厂函数时，都会返回一个新对象，而这个对象可以包含不同的属性和方法。工厂函数用于实现对象创建和封装，工厂函数可以模仿类。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//闭包也可以模拟class</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createCounter</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> count = <span class="number">0</span>;  <span class="comment">// `count` 是私有变量</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">increment</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">      count++;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(count);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">decrement</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">      count--;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(count);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">getCount</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> counter = <span class="title function_">createCounter</span>();</span><br><span class="line">counter.<span class="title function_">increment</span>();  <span class="comment">// 输出 1</span></span><br><span class="line">counter.<span class="title function_">increment</span>();  <span class="comment">// 输出 2</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(counter.<span class="title function_">getCount</span>());  <span class="comment">// 输出 2</span></span><br><span class="line">counter.<span class="title function_">decrement</span>();  <span class="comment">// 输出 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 直接访问 `count` 会出错，因为它是私有的</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(counter.<span class="property">count</span>);  <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>

<ul>
<li>闭包用于实现缓存</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">memorize</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> cache = &#123;&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> args = <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">slice</span>.<span class="title function_">call</span>(<span class="variable language_">arguments</span>)<span class="comment">//转换成array</span></span><br><span class="line">        <span class="keyword">var</span> key = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(args)<span class="comment">//将序列化的作为key</span></span><br><span class="line">        <span class="keyword">return</span> cache[key] || (cache[key] = fn.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">a</span>) &#123;<span class="keyword">return</span> a + <span class="number">1</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> adder = <span class="title function_">memorize</span>(add)</span><br><span class="line"><span class="title function_">adder</span>(<span class="number">1</span>)            <span class="comment">// 输出: 2    当前: cache: &#123; &#x27;[1]&#x27;: 2 &#125;</span></span><br><span class="line"><span class="title function_">adder</span>(<span class="number">1</span>)            <span class="comment">// 输出: 2    当前: cache: &#123; &#x27;[1]&#x27;: 2 &#125;</span></span><br><span class="line"><span class="title function_">adder</span>(<span class="number">2</span>)            <span class="comment">// 输出: 3    当前: cache: &#123; &#x27;[1]&#x27;: 2, &#x27;[2]&#x27;: 3 &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ES6版本</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">memorize</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> cache = &#123;&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">...args</span>) &#123;<span class="comment">//换成扩展运算符</span></span><br><span class="line">        <span class="keyword">const</span> key = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(args)</span><br><span class="line">        <span class="keyword">return</span> cache[key] || (cache[key] = fn.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="异步编程"><a href="#异步编程" class="headerlink" title="异步编程"></a>异步编程</h1><h2 id="async-await"><a href="#async-await" class="headerlink" title="async&#x2F;await"></a>async&#x2F;await</h2><ul>
<li>易错点</li>
</ul>
<table>
<thead>
<tr>
<th>易错点</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>❌ 顶层不能直接用 <code>await</code>（除非在模块环境）</td>
<td>需放在 async 函数中</td>
</tr>
<tr>
<td>❌ <code>await</code> 会阻塞后面代码（串行）</td>
<td>用 <code>Promise.all()</code> 并发</td>
</tr>
<tr>
<td>❌ 忘记 <code>try...catch</code> 会漏掉错误</td>
<td>可能导致异常未捕获</td>
</tr>
</tbody></table>
<h3 id="JS-的-await-与-python-的-await"><a href="#JS-的-await-与-python-的-await" class="headerlink" title="JS 的 await 与 python 的 await"></a>JS 的 await 与 python 的 await</h3><ul>
<li>JS的 await<br>JavaScript 中用于处理异步操作，它只能在 async 函数中使用，用来等待一个 Promise 完成并返回其结果。它的主要作用是让代码看起来像同步操作，但实际上仍然是异步执行。<br>简化了一堆.then()的链式调用<br>await 只会暂停当前的异步函数，而不会阻塞整个程序。<br>如果 await 后的 Promise 被拒绝（rejected），会抛出错误，需要用 try-catch 捕获。</li>
<li>python的await<br>python逻辑同理，await 允许你等待这些操作完成，而不会阻塞事件循环，使得程序可以处理其他任务。异步操作通常涉及 I&#x2F;O 密集型任务，比如：<br>网络请求（HTTP API 调用）<br>文件操作<br>数据库查询<br>计时器</li>
</ul>
<h2 id="回调函数callback"><a href="#回调函数callback" class="headerlink" title="回调函数callback"></a>回调函数callback</h2><ul>
<li>定义：回调函数就是被传入另一个函数中，在其内部“被调用”的函数。</li>
<li>应用：setTimeout&#x2F;Ajax</li>
<li>回调地狱：多个异步操作嵌套执行，导致代码层层缩进，结构混乱、难以维护。<br>解决：promise&#x2F;async&#x2F;await</li>
</ul>
<h1 id="浏览器-API"><a href="#浏览器-API" class="headerlink" title="浏览器 API"></a>浏览器 API</h1><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/API">官方文档MDN点击跳转</a></p>
<h2 id="浏览器渲染原理"><a href="#浏览器渲染原理" class="headerlink" title="浏览器渲染原理"></a>浏览器渲染原理</h2><ul>
<li>回流(重排)<br>当 Render Tree 中部分或者全部元素的尺寸、结构、布局等发生改变时，浏览器就会重新渲染部分或全部文档的过程称为回流。<br>会导致回流（重排）的操作：影响到布局就会有回流<br> 页面的首次刷新<br> 浏览器的窗口大小发生改变<br> 元素的大小或位置发生改变<br> 改变字体的大小<br> 内容的变化（如：input框的输入，图片的大小）<br> 激活css伪类 （如：:hover）<br> 脚本操作DOM（添加或者删除可见的DOM元素）</li>
<li>重绘<br>由于节点(元素)的样式的改变并不影响它在文档流中的位置和文档布局时(比如：color、background-color、outline等), 称为重绘。</li>
<li>重绘不一定引起回流，而回流一定会引起重绘。</li>
</ul>
<h2 id="DOM-（Document-Object-Model）"><a href="#DOM-（Document-Object-Model）" class="headerlink" title="DOM （Document Object Model）"></a>DOM （Document Object Model）</h2><ul>
<li>定义：文档对象模型，是 HTML&#x2F;XML 文档结构化表现，表示页面内容和结构。是浏览器提供的 API，允许 JS 操作网页内容。<br><img src="/images/JS%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0.assets/52415a23fcdf40ef8ac6572a815e93e5.png" alt="在这里插入图片描述"></li>
<li>包括：<br>DOM树：节点树（元素节点、文本节点、属性节点等）<br>常用对象：<br>document  顶层对象 整个文档入口<br>Element、HTMLElement — 页面元素<br>节点操作方法<br>事件相关接口</li>
</ul>
<blockquote>
<p>节点至少拥有nodeType（节点类型，元素节点1&#x2F;属性节点2&#x2F;文本节点3）、nodeName（节点名称）和nodeValue（节点值）这三个基本属性。</p>
</blockquote>
<ul>
<li>使用<ul>
<li>三种动态创建元素的区别</li>
</ul>
</li>
</ul>
<ol>
<li>document.write 是直接将内容写入页面的内容流，但是文档流执行完毕，则它会导致页面全部重绘</li>
<li>innerHTML 是将内容写入某个 DOM 节点，不会导致页面全部重绘； 创建多个元素效率更高（不要拼接字符串，采取数组形式拼接），结构稍微复杂；innerHTML 复制节点的时候，不会复制原先节点的事件，会存在内存泄露问题</li>
<li>createElement() 创建多个元素效率稍低，但是结构更清晰，如果页面创建元素较少，建议使用 createElement()<br>总结：不同浏览器下，innerHTML 效率要比 creatElement 高</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取特殊元素</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span> <span class="comment">//body元素对象</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">documentElement</span> <span class="comment">//html元素对象</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> elem = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;myId&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> elems = <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&#x27;myClass&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> elems = <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> elem = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.myClass&#x27;</span>);<span class="comment">//匹配第一个</span></span><br><span class="line"><span class="keyword">const</span> elems = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.myClass&#x27;</span>);<span class="comment">//匹配所有，数组</span></span><br><span class="line"><span class="keyword">var</span> j_tbs = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;j_tb&#x27;</span>).<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;input&#x27;</span>); </span><br><span class="line"></span><br><span class="line"><span class="comment">//利用节点操作获取元素</span></span><br><span class="line"><span class="comment">// 父(parentNode)、子(children)、兄(previousElementSibling、nextElementSibling) </span></span><br><span class="line"><span class="comment">//父级节点 返回最近的一个父节点或者null</span></span><br><span class="line">node.<span class="property">parentNode</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//返回包含指定节点的子节点的集合，该集合为即时更新的集合。</span></span><br><span class="line"><span class="comment">//包含了所有的子节点，包括元素节点，文本节点等。</span></span><br><span class="line"><span class="comment">//如果只想要获得里面的元素节点，则需要专门处理。所以我们一般不提倡使用childNodes</span></span><br><span class="line">parentNode.<span class="property">childNodes</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//是一个只读属性，返回所有的子元素节点。它只返回子元素节点，其余节点不返回</span></span><br><span class="line"><span class="comment">//是得到了各个浏览器的支持</span></span><br><span class="line">parentNode.<span class="property">children</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//第一个或最后一个 找不到则返回null。同样，也是包含所有的节点。</span></span><br><span class="line"><span class="comment">//子节点 不仅仅是元素节点</span></span><br><span class="line">parentNode.<span class="property">firstChild</span></span><br><span class="line">parentNode.<span class="property">lastChild</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//返回第一个子元素节点，找不到则返回null。</span></span><br><span class="line"><span class="comment">//注意：这两个方法有兼容性问题，IE9 以上才支持。</span></span><br><span class="line">parentNode.<span class="property">firstElementChild</span></span><br><span class="line">parentNode.<span class="property">lastElementChild</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//综上</span></span><br><span class="line"><span class="comment">//firstChild 和 lastChild 包含其他节点，操作不方便</span></span><br><span class="line"><span class="comment">//firstElementChild 和lastElementChild 又有兼容性问题</span></span><br><span class="line"><span class="comment">//如果要第一个子元素节点，使用 parentNode.chilren[0]</span></span><br><span class="line"><span class="comment">//如果是最后一个子元素节点，使用 parentNode.chilren[parentNode.chilren.length - 1]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//兄弟节点 返回当前元素的下一个兄弟节点，找不到则返回null。包含所有的节点。</span></span><br><span class="line">node.<span class="property">nextSibling</span></span><br><span class="line">node.<span class="property">previousSibling</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//兄弟元素节点 注意：这两个方法有兼容性问题， IE9 以上才支持。</span></span><br><span class="line">node.<span class="property">nextElementSibling</span></span><br><span class="line">node.<span class="property">previousElementSibling</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//使用自己封装的获取兄弟节点函数 同时解决兼容性</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getNextElementSibling</span>(<span class="params">element</span>) &#123;</span><br><span class="line">	 <span class="keyword">var</span> el = element;</span><br><span class="line">	 <span class="keyword">while</span> (el = el.<span class="property">nextSibling</span>) &#123;</span><br><span class="line">		 <span class="keyword">if</span> (el.<span class="property">nodeType</span> === <span class="number">1</span>) &#123;</span><br><span class="line">		 	<span class="keyword">return</span> el;</span><br><span class="line">		 &#125;</span><br><span class="line">	 &#125;</span><br><span class="line">	 <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">node.<span class="title function_">cloneNode</span>()<span class="comment">//返回调用该方法的节点的一个副本。</span></span><br><span class="line"><span class="comment">//如果括号参数为空或者为 false ，则是浅拷贝，即只克隆复制节点本身，不克隆里面的子节点。</span></span><br><span class="line"><span class="comment">//如果括号参数为 true ，则是深度拷贝，会复制节点本身以及里面所有的子节点。</span></span><br><span class="line"></span><br><span class="line">parentNode.<span class="title function_">replaceChild</span>(newChild, oldChild);</span><br><span class="line"><span class="comment">//用指定的节点替换当前节点的一个子节点，并返回被替换掉的节点。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//增删改查</span></span><br><span class="line"><span class="keyword">const</span> div = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line"><span class="variable language_">document</span>.<span class="property">write</span></span><br><span class="line">innerHTML</span><br><span class="line"></span><br><span class="line">parentElem.<span class="title function_">appendChild</span>(div);          <span class="comment">// 添加到子元素最后</span></span><br><span class="line">parentElem.<span class="title function_">insertBefore</span>(div, refElem); <span class="comment">// 插入到指定元素之前</span></span><br><span class="line"></span><br><span class="line">parentElem.<span class="title function_">removeChild</span>(childElem);</span><br><span class="line"><span class="comment">//注意到删除后的节点虽然不在文档树中了，但其实它还在内存中，可以随时再次被添加到别的位置。</span></span><br><span class="line"><span class="comment">//当你遍历一个父节点的子节点并进行删除操作时，要注意，children属性是一个只读属性，并且它在子节点变化时会实时更新。</span></span><br><span class="line">parent.<span class="title function_">removeChild</span>(parent.<span class="property">children</span>[<span class="number">0</span>]);</span><br><span class="line">parent.<span class="title function_">removeChild</span>(parent.<span class="property">children</span>[<span class="number">1</span>]); <span class="comment">// &lt;-- 浏览器报错</span></span><br><span class="line"><span class="comment">//因为一共有0，1两号子节点，删掉0号后1号自动变0号</span></span><br><span class="line">childElem.<span class="title function_">remove</span>(); <span class="comment">// 现代浏览器支持</span></span><br><span class="line"></span><br><span class="line">elem.<span class="property">innerHTML</span> = <span class="string">&#x27;&lt;p&gt;新内容&lt;/p&gt;&#x27;</span>; <span class="comment">// 插入HTML内容（支持标签）</span></span><br><span class="line">elem.<span class="property">textContent</span> = <span class="string">&#x27;纯文本内容&#x27;</span>;   <span class="comment">// 插入纯文本（安全）</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">修改元素属性： src、href、title等</span></span><br><span class="line"><span class="comment">修改普通元素内容： innerHTML 、innerText</span></span><br><span class="line"><span class="comment">安全起见，尽量使用innerText</span></span><br><span class="line"><span class="comment">修改表单元素： value、type、disabled、checked,selected等</span></span><br><span class="line"><span class="comment">修改元素样式： style、className</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//样式属性</span></span><br><span class="line"><span class="comment">//样式名字带-的改成驼峰命名 因为在js中会被解析成减法</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">backgroundImage</span> = <span class="string">&#x27;url(&#x27;</span> + <span class="variable language_">this</span>.<span class="property">src</span> + <span class="string">&#x27;)&#x27;</span>;</span><br><span class="line">element.<span class="property">className</span><span class="comment">//覆盖原先类名 class是关键字不能用</span></span><br><span class="line">element.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;class1&quot;</span>, <span class="string">&quot;class2&quot;</span>);</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.tab .active&#x27;</span>).<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;active&#x27;</span>)</span><br><span class="line">.<span class="title function_">remove</span>(class1,class2,..);</span><br><span class="line">.<span class="title function_">toggle</span>(<span class="keyword">class</span>)<span class="comment">//切换（添加或移除）指定的 CSS 类。如果该类已存在，则移除它；如果不存在，则添加它。</span></span><br><span class="line"></span><br><span class="line">elem.<span class="title function_">setAttribute</span>(<span class="string">&#x27;data-id&#x27;</span>, <span class="string">&#x27;123&#x27;</span>);</span><br><span class="line">elem.<span class="title function_">getAttribute</span>(<span class="string">&#x27;data-id&#x27;</span>);</span><br><span class="line">elem.<span class="title function_">removeAttribute</span>(<span class="string">&#x27;data-id&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//操作类名</span></span><br><span class="line">elem.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;active&#x27;</span>);      <span class="comment">// 添加类</span></span><br><span class="line">elem.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;active&#x27;</span>);   <span class="comment">// 移除类</span></span><br><span class="line">elem.<span class="property">classList</span>.<span class="title function_">toggle</span>(<span class="string">&#x27;active&#x27;</span>);   <span class="comment">// 有则移除，无则添加</span></span><br><span class="line">elem.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;active&#x27;</span>); <span class="comment">// 是否包含该类，返回布尔</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//事件绑定</span></span><br><span class="line">elem.<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;<span class="comment">//前面要加on</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;点击了&#x27;</span>);</span><br><span class="line">&#125;;</span><br><span class="line">elem.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;点击了&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handler</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;点击了&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">elem.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, handler);</span><br><span class="line">elem.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;click&#x27;</span>, handler);</span><br></pre></td></tr></table></figure>

<p><img src="/images/JS%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0.assets/99b5e89fe05a40f1ba709be9ee642296.png" alt="在这里插入图片描述"></p>
<ul>
<li>scroll【区分页面&#x2F;元素】<br>⚠️ 注意：只有<code>overflow: scroll|auto</code>才能滚动，才有 scrollTop</li>
</ul>
<ol>
<li>页面被卷去的头部：可以通过window.pageYOffset 获得  如果是被卷去的左侧window.pageXOffset</li>
<li>注意，元素被卷去的头部是element.scrollTop  , 如果是页面被卷去的头部 则是 window.pageYOffset<br><img src="/images/JS%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0.assets/f1931051a36b43ec8bc5f7d08654ec96.png" alt="在这里插入图片描述"></li>
</ol>
<table>
<thead>
<tr>
<th>属性</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>element.scrollTop</code></td>
<td>元素垂直方向滚动的像素值（从顶部开始）</td>
</tr>
<tr>
<td><code>element.scrollLeft</code></td>
<td>元素水平方向滚动的像素值（从左边开始）</td>
</tr>
<tr>
<td><code>element.scrollHeight</code></td>
<td>元素内容实际高度（包括看不见的部分）</td>
</tr>
<tr>
<td><code>element.scrollWidth</code></td>
<td>元素内容实际宽度</td>
</tr>
<tr>
<td><code>window.scrollY</code></td>
<td>垂直方向滚动的距离（别名：<code>pageYOffset</code>）</td>
</tr>
<tr>
<td><code>window.scrollX</code></td>
<td>水平方向滚动的距离</td>
</tr>
<tr>
<td><code>window.scrollTo(x, y)</code></td>
<td>滚动到指定位置</td>
</tr>
<tr>
<td><code>window.scrollBy(x, y)</code></td>
<td>相对当前位置滚动</td>
</tr>
</tbody></table>
<p>区别：</p>
<table>
<thead>
<tr>
<th>属性名</th>
<th>属于谁</th>
<th>用途</th>
<th>是否可写</th>
</tr>
</thead>
<tbody><tr>
<td><code>scrollTop</code></td>
<td>DOM 元素</td>
<td>元素垂直滚动条位置</td>
<td>✅ 可读写</td>
</tr>
<tr>
<td><code>scrollY</code></td>
<td><code>window</code> 对象</td>
<td>页面整体滚动条位置（别名 <code>pageYOffset</code>）</td>
<td>❌ 只读</td>
</tr>
</tbody></table>
<ul>
<li>offset<br>只有元素节点（HTMLElement）才有 offset 系列属性。返回的数值都不带单位，包含padding+border+width，可视宽高，如果盒子隐藏则获取结果为0<ul>
<li>应用：获得元素和其父元素的距离、获得元素自身的大小（宽度高度）</li>
<li>offset 与 与  style . ( left  &#x2F;  top  &#x2F;  width  &#x2F;  height ) 的区别:</li>
</ul>
</li>
</ul>
<ol>
<li>offset系列的是只读属性,而通过style的方式可以读写</li>
<li>style.width 获得不包含padding和border 的值</li>
<li>offset系列返回的数值类型(结果四舍五入),style返回的是带单位的字符串 </li>
<li>style 可以返回没有定位的元素的left值和top值,而 offsetLeft 和 offsetTop 不可以</li>
</ol>
<table>
<thead>
<tr>
<th>属性</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>offsetTop</code></td>
<td>元素相对于其 offsetParent 的顶部偏移</td>
</tr>
<tr>
<td><code>offsetLeft</code></td>
<td>元素相对于其 offsetParent 的左边偏移</td>
</tr>
<tr>
<td><code>offsetParent</code></td>
<td>定位参考容器（离当前元素最近的定位祖先）</td>
</tr>
<tr>
<td><code>offsetWidth</code></td>
<td>元素可见宽度（含 padding + border）</td>
</tr>
<tr>
<td><code>offsetHeight</code></td>
<td>元素可见高度（含 padding + border）</td>
</tr>
</tbody></table>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> el = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.target&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> rect = el.<span class="title function_">getBoundingClientRect</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (rect.<span class="property">top</span> &gt;= <span class="number">0</span> &amp;&amp; rect.<span class="property">top</span> &lt;= <span class="variable language_">window</span>.<span class="property">innerHeight</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;元素出现在可视区域了&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="【offset】【scroll】【client】-对比"><a href="#【offset】【scroll】【client】-对比" class="headerlink" title="【offset】【scroll】【client】 对比"></a>【offset】【scroll】【client】 对比</h3><table>
<thead>
<tr>
<th>属性类别</th>
<th>代表属性</th>
<th>作用&#x2F;含义</th>
<th>所属对象类型</th>
<th>是否只读</th>
<th>常见用途</th>
</tr>
</thead>
<tbody><tr>
<td><code>offset</code></td>
<td><code>offsetTop</code> &#x2F; <code>offsetLeft</code></td>
<td>元素<strong>相对 offsetParent 的偏移</strong>距离（定位用）</td>
<td>DOM 元素</td>
<td>✅ 是</td>
<td>元素定位、吸顶导航等</td>
</tr>
<tr>
<td></td>
<td><code>offsetWidth</code> &#x2F; <code>offsetHeight</code></td>
<td>元素<strong>包括 padding 和 border</strong> 的宽高</td>
<td>DOM 元素</td>
<td>✅ 是</td>
<td>获取元素实际尺寸</td>
</tr>
<tr>
<td><code>scroll</code></td>
<td><code>scrollTop</code> &#x2F; <code>scrollLeft</code></td>
<td>元素<strong>内容被卷起的距离</strong>（滚动了多少）</td>
<td>DOM 元素</td>
<td>❌ 否</td>
<td>获取&#x2F;设置滚动位置</td>
</tr>
<tr>
<td></td>
<td><code>scrollWidth</code> &#x2F; <code>scrollHeight</code></td>
<td>元素<strong>整体内容的宽高</strong>（包括看不见的部分）</td>
<td>DOM 元素</td>
<td>✅ 是</td>
<td>滚动加载、滚动检测等</td>
</tr>
<tr>
<td><code>client</code></td>
<td><code>clientTop</code> &#x2F; <code>clientLeft</code></td>
<td>元素<strong>内容区到边框的距离</strong>（通常是 border 宽度）</td>
<td>DOM 元素</td>
<td>✅ 是</td>
<td>校准滚动位置、精确定位</td>
</tr>
<tr>
<td></td>
<td><code>clientWidth</code> &#x2F; <code>clientHeight</code></td>
<td>元素<strong>可见区域宽高（内容 + padding，不含 border 和滚动条）</strong></td>
<td>DOM 元素</td>
<td>✅ 是</td>
<td>获取可视尺寸、布局控制</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>属性名</th>
<th>包含 padding</th>
<th>包含 border</th>
<th>包含滚动条</th>
<th>用途</th>
</tr>
</thead>
<tbody><tr>
<td><code>clientWidth</code></td>
<td>✅ 是</td>
<td>❌ 否</td>
<td>❌ 否</td>
<td>可见内容区域宽度（不含滚动条）</td>
</tr>
<tr>
<td><code>offsetWidth</code></td>
<td>✅ 是</td>
<td>✅ 是</td>
<td>❌ 否</td>
<td>元素整体宽度（含 border）</td>
</tr>
<tr>
<td><code>scrollWidth</code></td>
<td>✅ 是</td>
<td>❌ 否</td>
<td>❌ 否</td>
<td>内容总宽度（包括溢出部分）</td>
</tr>
<tr>
<td><code>clientHeight</code></td>
<td>✅ 是</td>
<td>❌ 否</td>
<td>❌ 否</td>
<td>可见高度</td>
</tr>
<tr>
<td><code>offsetHeight</code></td>
<td>✅ 是</td>
<td>✅ 是</td>
<td>❌ 否</td>
<td>元素整体高度</td>
</tr>
<tr>
<td><code>scrollHeight</code></td>
<td>✅ 是</td>
<td>❌ 否</td>
<td>❌ 否</td>
<td>总内容高度</td>
</tr>
</tbody></table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">网页可见区域宽： <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">clientWidth</span>; </span><br><span class="line">网页可见区域高： <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">clientHeight</span>; </span><br><span class="line"></span><br><span class="line">网页真实元素宽： <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetWidth</span> (包括边线的宽); </span><br><span class="line">网页真实元素高： <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span> (包括边线的宽); </span><br><span class="line"></span><br><span class="line">网页正文全文宽： <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollWidth</span>; </span><br><span class="line">网页正文全文高： <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollHeight</span>; </span><br><span class="line"></span><br><span class="line">网页被卷去的高： <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollTop</span>; </span><br><span class="line">网页被卷去的左： <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollLeft</span>; </span><br><span class="line"></span><br><span class="line">浏览器窗口的顶部边缘与屏幕的顶部边缘之间的距离： <span class="variable language_">window</span>.<span class="property">screenTop</span>; </span><br><span class="line">浏览器窗口的左边缘与屏幕的左边缘之间的距离： <span class="variable language_">window</span>.<span class="property">screenLeft</span>; </span><br><span class="line"></span><br><span class="line">屏幕分辨率的高： <span class="variable language_">window</span>.<span class="property">screen</span>.<span class="property">height</span>; </span><br><span class="line">屏幕分辨率的宽： <span class="variable language_">window</span>.<span class="property">screen</span>.<span class="property">width</span>; </span><br><span class="line"></span><br><span class="line">屏幕可用工作区高度： <span class="variable language_">window</span>.<span class="property">screen</span>.<span class="property">availHeight</span>; </span><br><span class="line">屏幕可用工作区宽度： <span class="variable language_">window</span>.<span class="property">screen</span>.<span class="property">availWidth</span>;</span><br></pre></td></tr></table></figure>

<h2 id="BOM（Browser-Object-Model）"><a href="#BOM（Browser-Object-Model）" class="headerlink" title="BOM（Browser Object Model）"></a>BOM（Browser Object Model）</h2><ul>
<li>定义浏览器对象模型，浏览器接口集合，用于操作浏览器窗口和浏览器环境。</li>
<li>作用：负责处理浏览器窗口、历史、位置、弹窗等。</li>
<li>包括：</li>
</ul>
<p>window.pageXoffset&#x2F;window.scrollX页面水平方向滚动像素值；Y同理</p>
<p>devicePixelRatio像素比</p>
<table>
<thead>
<tr>
<th>对象</th>
<th>功能描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>window</code></td>
<td>浏览器窗口&#x2F;全局对象，BOM 顶级对象</td>
</tr>
<tr>
<td><code>navigator</code></td>
<td>浏览器信息，如用户代理、平台</td>
</tr>
<tr>
<td><code>screen</code></td>
<td>屏幕信息，如分辨率、颜色深度</td>
</tr>
<tr>
<td><code>location</code></td>
<td>当前文档的 URL 地址，href&#x2F;hash&#x2F;url</td>
</tr>
<tr>
<td><code>history</code></td>
<td>浏览器历史记录,go, forward&#x2F;back</td>
</tr>
<tr>
<td><code>console</code></td>
<td>控制台接口</td>
</tr>
<tr>
<td><code>alert</code>、<code>confirm</code>、<code>prompt</code></td>
<td>弹窗相关</td>
</tr>
<tr>
<td><code>setTimeout</code>、<code>setInterval</code></td>
<td>定时器函数</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>属性&#x2F;方法</th>
<th>说明：window可省</th>
</tr>
</thead>
<tbody><tr>
<td><code>window.document</code></td>
<td>当前网页的 DOM 对象</td>
</tr>
<tr>
<td><code>window.location</code></td>
<td>当前页面的 URL 对象</td>
</tr>
<tr>
<td><code>window.history</code></td>
<td>浏览器历史记录</td>
</tr>
<tr>
<td><code>window.navigator</code></td>
<td>浏览器和操作系统信息</td>
</tr>
<tr>
<td><code>window.alert()</code></td>
<td>弹出警告框</td>
</tr>
<tr>
<td><code>window.confirm()</code></td>
<td>弹出确认框</td>
</tr>
<tr>
<td><code>window.prompt()</code></td>
<td>弹出输入框</td>
</tr>
<tr>
<td><code>window.setTimeout()</code></td>
<td>延时执行函数</td>
</tr>
<tr>
<td><code>window.setInterval()</code></td>
<td>定时重复执行函数</td>
</tr>
<tr>
<td><code>window.open()</code></td>
<td>打开新窗口</td>
</tr>
<tr>
<td><code>window.close()</code></td>
<td>关闭窗口</td>
</tr>
</tbody></table>
<p>window对象有innerWidth和innerHeight属性，获取浏览器窗口中内部页面视口宽度和高度。<br>内部宽高是指除去菜单栏、工具栏、边框等占位元素后，<br>用于显示网页的净宽高。<br>outerWidth和outerHeight属性获取浏览器窗口的整个宽高。</p>
<blockquote>
<p>如一个完整的url:<br><a target="_blank" rel="noopener" href="http://www.example.com:8080/path/index.html?a=1&b=2#TOP">http://www.example.com:8080/path/index.html?a=1&amp;b=2#TOP</a></p>
<p>location.href&#x2F;&#x2F;整个URL</p>
<p>location.origin&#x2F;&#x2F;协议+主机+端口</p>
<p>location.protocol; &#x2F;&#x2F; ‘http’<br>location.host; &#x2F;&#x2F; ‘<a target="_blank" rel="noopener" href="http://www.example.com/">www.example.com</a>‘<br>location.port; &#x2F;&#x2F; ‘8080’<br>location.pathname; &#x2F;&#x2F; ‘&#x2F;path&#x2F;index.html’<br>location.search; &#x2F;&#x2F; ‘?a&#x3D;1&amp;b&#x3D;2’<br>location.hash; &#x2F;&#x2F; ‘TOP’</p>
<p>location.assign()跟href一样可以重定向页面</p>
<p>location.replace()替换，不留历史，故不能后退</p>
<p>location.reload()重新加载，相当于刷新&#x2F;f5，如果参数为true强制刷新，相当于ctrl+f5</p>
</blockquote>
<p>onload是页面内容全部加载完触发(包括图像、脚本文件、CSS 文件等)。唯一，后覆盖前。<br>DOMContentLoaded是仅DOM元素加载完触发，且从IE9开始支持。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> width = <span class="variable language_">window</span>.<span class="property">innerWidth</span> || <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">clientWidth</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">onload</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;load&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;)<span class="comment">//没有唯一性限制</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;)</span><br><span class="line"><span class="comment">//window也可以 不过最好是加在document上</span></span><br><span class="line"><span class="comment">//事件触发时仅DOM加载完成，不包括样式表、图片、flash等</span></span><br><span class="line"><span class="comment">//IE9以上才支持！！！</span></span><br><span class="line"><span class="comment">//如果页面的图片很多的话, 从用户访问到onload触发可能需要较长的时间, </span></span><br><span class="line"><span class="comment">//交互效果就不能实现，必然影响用户的体验，此时用 DOMContentLoaded 事件比较合适</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//调整窗口大小事件 经常利用这个事件完成响应式布局。 </span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">onresize</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//禁止选中</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">getSelection</span> ? <span class="variable language_">window</span>.<span class="title function_">getSelection</span>().<span class="title function_">removeAllRanges</span>() : 				    <span class="variable language_">document</span>.<span class="property">selection</span>.<span class="title function_">empty</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(navigator.<span class="property">userAgent</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(navigator.<span class="property">platform</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(navigator.<span class="property">language</span>);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">navigator.appName：浏览器名称；</span></span><br><span class="line"><span class="comment">navigator.appVersion：浏览器版本；</span></span><br><span class="line"><span class="comment">navigator.language：浏览器设置的语言；</span></span><br><span class="line"><span class="comment">navigator.platform：操作系统类型；</span></span><br><span class="line"><span class="comment">navigator.userAgent：浏览器设定的User-Agent字符串。</span></span><br><span class="line"><span class="comment">navigator的信息可以很容易地被用户修改，所以JavaScript读取的值不一定是正确的。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">if</span>((navigator.<span class="property">userAgent</span>.<span class="title function_">match</span>(<span class="regexp">/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i</span>))) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> = <span class="string">&quot;&quot;</span>;     <span class="comment">//手机</span></span><br><span class="line"> &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> = <span class="string">&quot;&quot;</span>;     <span class="comment">//电脑</span></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检测 userAgent（浏览器信息）</span></span><br><span class="line">!(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">const</span> userAgent = navigator.<span class="property">userAgent</span></span><br><span class="line"><span class="comment">// 验证是否为Android或iPhone</span></span><br><span class="line"><span class="keyword">const</span> android = userAgent.<span class="title function_">match</span>(<span class="regexp">/(Android);?[\s\/]+([\d.]+)?/</span>)</span><br><span class="line"><span class="keyword">const</span> iphone = userAgent.<span class="title function_">match</span>(<span class="regexp">/(iPhone\sOS)\s([\d_]+)/</span>)</span><br><span class="line"><span class="comment">// 如果是Android或iPhone，则跳转至移动站点</span></span><br><span class="line"><span class="keyword">if</span> (android || iphone) &#123;</span><br><span class="line">location.<span class="property">href</span> = <span class="string">&#x27;http://m.itcast.cn&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(location.<span class="property">href</span>);    <span class="comment">// 当前页面完整URL</span></span><br><span class="line">location.<span class="property">href</span> = <span class="string">&#x27;https://www.example.com&#x27;</span>;  <span class="comment">// 跳转到新页面</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(location.<span class="property">protocol</span>); <span class="comment">// 协议部分 http: 或 https:</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(location.<span class="property">host</span>);     <span class="comment">// 主机名和端口port</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(location.<span class="property">pathname</span>); <span class="comment">// 路径部分</span></span><br><span class="line">location.<span class="property">search</span> <span class="comment">//参数</span></span><br><span class="line">location.<span class="property">hash</span></span><br><span class="line">location.<span class="title function_">reload</span>();              <span class="comment">// 刷新当前页面</span></span><br><span class="line"><span class="comment">// 记录浏览历史，所以可以实现后退功能</span></span><br><span class="line">location.<span class="title function_">assign</span>(<span class="string">&#x27;http://www.itcast.cn&#x27;</span>);</span><br><span class="line"><span class="comment">// 不记录浏览历史，所以不可以实现后退功能</span></span><br><span class="line">location.<span class="title function_">replace</span>(<span class="string">&#x27;http://www.itcast.cn&#x27;</span>);</span><br><span class="line">            </span><br><span class="line">history.<span class="title function_">back</span>();   <span class="comment">// 后退</span></span><br><span class="line">history.<span class="title function_">forward</span>(); <span class="comment">// 前进</span></span><br><span class="line">history.<span class="title function_">go</span>(-<span class="number">1</span>);  <span class="comment">// 后退一页，go(1) 前进一页</span></span><br><span class="line"></span><br><span class="line">history.<span class="title function_">pushState</span>(stateObj, title, url); <span class="comment">// 改变历史记录（SPA 常用）不触发页面刷新</span></span><br><span class="line">history.<span class="title function_">replaceState</span>(stateObj, title, url); <span class="comment">// 替换当前历史记录</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(screen.<span class="property">width</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(screen.<span class="property">height</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(screen.<span class="property">colorDepth</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//定时器-间歇函数 使用定时器函数重复执行代码</span></span><br><span class="line"><span class="keyword">let</span> timerId = <span class="built_in">setInterval</span>(回调函数, 间隔时间ms)</span><br><span class="line"><span class="built_in">clearInterval</span>(timerId)</span><br><span class="line"><span class="comment">//定时器需要等待，所以后面的代码先执行 </span></span><br><span class="line"><span class="comment">//每一次调用定时器都会产生一个新定时器</span></span><br><span class="line"><span class="built_in">setInterval</span>(repeat,<span class="number">1000</span>)<span class="comment">//第一次执行也是要间隔这ms数</span></span><br><span class="line"><span class="comment">//注意 即使clear了timeID依然在，所以要timeID=null才行</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">myInterval</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">let</span> d=<span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">	clock.<span class="property">innerText</span>=d.<span class="title function_">toLocaleString</span>();</span><br><span class="line">	<span class="built_in">setTimeout</span>(myInterval,<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>页面加载时执行JavaScript函数</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//js文件中写</span></span><br><span class="line"><span class="comment">//方法1</span></span><br><span class="line"> <span class="keyword">function</span>  <span class="title function_">myfun</span>(<span class="params"></span>) 　　</span><br><span class="line">&#123; 　　 <span class="title function_">alert</span>( <span class="string">&quot;this window.onload&quot;</span> ); 　　</span><br><span class="line">&#125; 　　</span><br><span class="line"><span class="variable language_">window</span>.<span class="property">onload</span> = myfun;  <span class="comment">/*用window.onload调用myfun()*/</span> 　　</span><br><span class="line"><span class="comment">//不要括号</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//方法2</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">onload</span>= <span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line"><span class="title function_">func1</span>();</span><br><span class="line"><span class="title function_">func2</span>();</span><br><span class="line"><span class="title function_">func3</span>(); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="事件专题"><a href="#事件专题" class="headerlink" title="事件专题"></a>事件专题</h2><ul>
<li>mouseover v.s. mouseenter &#x2F; mouseout v.s. mouseleave：是否冒泡、仅在元素触发&#x2F;元素及子元素都触发</li>
</ul>
<table>
<thead>
<tr>
<th>属性</th>
<th>Mouseover-mouseout</th>
<th>Mouseenter-mouseleave</th>
</tr>
</thead>
<tbody><tr>
<td>是否冒泡</td>
<td>会冒泡</td>
<td>❌ 不冒泡</td>
</tr>
<tr>
<td>子元素触发</td>
<td>进入子元素也会触发<br></td>
<td>❌ 进入子元素不会再触发</td>
</tr>
<tr>
<td>使用场景</td>
<td>一般用于处理整块区域的悬停效果</td>
<td>更适合精确处理当前元素悬停</td>
</tr>
</tbody></table>
<p>目标元素与其子元素都可以触发父元素的 mouseover，整个流程举例子：</p>
<p>假设三层嵌套outer-middle-inner，鼠标从外界进入inner，捕获阶段：document → outer → middle → inner，目标阶段inner，冒泡阶段：inner → middle → outer → document，设置mouseover监听器</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">&#x27;outer&#x27;</span>, <span class="string">&#x27;middle&#x27;</span>, <span class="string">&#x27;inner&#x27;</span>].<span class="title function_">forEach</span>(<span class="function"><span class="params">id</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> el = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(id);</span><br><span class="line">  el.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseover&#x27;</span>, <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;bubble&#x27;</span>, id, <span class="string">&#x27;target:&#x27;</span>, e.<span class="property">target</span>.<span class="property">id</span>, <span class="string">&#x27;currentTarget:&#x27;</span>, e.<span class="property">currentTarget</span>.<span class="property">id</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  el.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseover&#x27;</span>, <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;capture&#x27;</span>, id, <span class="string">&#x27;target:&#x27;</span>, e.<span class="property">target</span>.<span class="property">id</span>, <span class="string">&#x27;currentTarget:&#x27;</span>, e.<span class="property">currentTarget</span>.<span class="property">id</span>);</span><br><span class="line">  &#125;, <span class="literal">true</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">/*输出</span></span><br><span class="line"><span class="comment">capture outer</span></span><br><span class="line"><span class="comment">capture middle</span></span><br><span class="line"><span class="comment">capture inner</span></span><br><span class="line"><span class="comment">bubble inner (target)</span></span><br><span class="line"><span class="comment">bubble middle</span></span><br><span class="line"><span class="comment">bubble outer</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>当鼠标移动时，浏览器会<strong>内部计算鼠标进入或离开了哪些元素</strong>，生成<code>mouseover</code>&#x2F;<code>mouseout</code> 事件。<strong>无论你有没有在元素上注册监听器</strong>，浏览器都会做这些计算。事件的“生成”是浏览器内部机制的一部分，但是如果你没有监听器，就不会<strong>回调 JS</strong>，所以 JS 层的性能开销几乎为 0</p>
<p>所谓 <strong>mouseover 性能差</strong>，主要是 <strong>JS 回调执行 + 冒泡层数多</strong>，而不是事件本身消耗</p>
<ul>
<li>常用事件</li>
</ul>
<table>
<thead>
<tr>
<th>分类</th>
<th>说明</th>
<th>常见事件示例</th>
</tr>
</thead>
<tbody><tr>
<td>用户交互事件</td>
<td>用户操作页面引发</td>
<td><code>click</code>, <code>dblclick</code>, <code>mousedown</code>, <code>mouseup</code>, <code>mousemove</code>, <code>mouseover</code>, <code>mouseout</code>, <code>mouseenter</code>, <code>mouseleave</code>, <code>keydown</code>, <code>keyup</code>, <code>keypress</code>, <code>input</code>, <code>change</code>, <code>focus</code>, <code>blur</code></td>
</tr>
<tr>
<td>表单事件</td>
<td>表单元素交互事件</td>
<td><code>submit</code>, <code>reset</code>, <code>input</code>, <code>change</code>, <code>focus</code>, <code>blur</code></td>
</tr>
<tr>
<td>触摸事件</td>
<td>移动设备上的触摸操作</td>
<td><code>touchstart</code>, <code>touchmove</code>, <code>touchend</code>, <code>touchcancel</code></td>
</tr>
<tr>
<td>剪贴板事件</td>
<td>剪切、复制、粘贴操作</td>
<td><code>copy</code>, <code>cut</code>, <code>paste</code></td>
</tr>
<tr>
<td>载入事件</td>
<td>页面或资源加载相关</td>
<td><code>load</code>, <code>DOMContentLoaded</code>, <code>beforeunload</code>, <code>unload</code></td>
</tr>
<tr>
<td>窗口事件</td>
<td>浏览器窗口尺寸、滚动相关</td>
<td><code>resize</code>, <code>scroll</code>, <code>error</code></td>
</tr>
<tr>
<td>拖放事件</td>
<td>拖拽操作相关</td>
<td><code>drag</code>, <code>dragstart</code>, <code>dragenter</code>, <code>dragover</code>, <code>dragleave</code>, <code>drop</code>, <code>dragend</code></td>
</tr>
<tr>
<td>媒体事件</td>
<td>音视频播放、暂停等</td>
<td><code>play</code>, <code>pause</code>, <code>ended</code>, <code>timeupdate</code>, <code>volumechange</code></td>
</tr>
<tr>
<td>其他事件</td>
<td>其他各种特殊事件</td>
<td><code>contextmenu</code>, <code>wheel</code>, <code>select</code></td>
</tr>
</tbody></table>
<p>keydown键盘按下<br>keyup键盘抬起<br>keypress键盘按下并弹起，onkeypress 和前面2个的区别是，它不识别功能键，比如左右箭头，shift，ctrl 等。<br>键盘事件执行顺序：keydown-&gt;keypress-&gt;keyup<br>onkeydown 和 onkeyup 不区分字母大小写，onkeypress 区分字母大小写。<br>e.key 替代keyCode返回改建的ascii码</p>
<table>
<thead>
<tr>
<th>按键</th>
<th><code>e.key</code> 返回值</th>
</tr>
</thead>
<tbody><tr>
<td>A-Z</td>
<td><code>&quot;a&quot;</code> - <code>&quot;z&quot;</code>（小写，和键盘大小写无关）</td>
</tr>
<tr>
<td>数字 0-9</td>
<td><code>&quot;0&quot;</code> - <code>&quot;9&quot;</code></td>
</tr>
<tr>
<td>Enter</td>
<td><code>&quot;Enter&quot;</code></td>
</tr>
<tr>
<td>空格</td>
<td><code>&quot; &quot;</code>（空字符串）</td>
</tr>
<tr>
<td>方向键</td>
<td><code>&quot;ArrowUp&quot;</code>, <code>&quot;ArrowDown&quot;</code>, <code>&quot;ArrowLeft&quot;</code>, <code>&quot;ArrowRight&quot;</code></td>
</tr>
<tr>
<td>Shift</td>
<td><code>&quot;Shift&quot;</code></td>
</tr>
<tr>
<td>Ctrl</td>
<td><code>&quot;Control&quot;</code></td>
</tr>
<tr>
<td>Alt</td>
<td><code>&quot;Alt&quot;</code></td>
</tr>
<tr>
<td>Backspace</td>
<td><code>&quot;Backspace&quot;</code></td>
</tr>
<tr>
<td>Escape</td>
<td><code>&quot;Escape&quot;</code></td>
</tr>
</tbody></table>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//应用场景：防止复制</span></span><br><span class="line"><span class="number">1.</span>禁止鼠标右键菜单</span><br><span class="line">contextmenu主要控制应该何时显示上下文菜单，主要用于程序员取消默认的上下文菜单</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;contextmenu&#x27;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">	e.<span class="title function_">preventDefault</span>();</span><br><span class="line">&#125;)</span><br><span class="line"><span class="number">2.</span>禁止鼠标选中（selectstart 开始选中）</span><br><span class="line"> <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;selectstart&#x27;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line"> e.<span class="title function_">preventDefault</span>();</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">addEventListener</span>(<span class="params">element, eventName, fn</span>) &#123;</span><br><span class="line"> <span class="comment">// 判断当前浏览器是否支持 addEventListener 方法</span></span><br><span class="line"> <span class="keyword">if</span> (element.<span class="property">addEventListener</span>) &#123;</span><br><span class="line"> element.<span class="title function_">addEventListener</span>(eventName, fn); <span class="comment">// 第三个参数 默认是false</span></span><br><span class="line"> &#125; <span class="keyword">else</span> <span class="keyword">if</span> (element.<span class="property">attachEvent</span>) &#123;</span><br><span class="line"> element.<span class="title function_">attachEvent</span>(<span class="string">&#x27;on&#x27;</span> + eventName, fn);</span><br><span class="line"> &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"> <span class="comment">// 相当于 element.onclick = fn;</span></span><br><span class="line"> element[<span class="string">&#x27;on&#x27;</span> + eventName] = fn;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">removeEventListener</span>(<span class="params">element, eventName, fn</span>) &#123;</span><br><span class="line"> <span class="comment">// 判断当前浏览器是否支持 removeEventListener 方法</span></span><br><span class="line"> <span class="keyword">if</span> (element.<span class="property">removeEventListener</span>) &#123;</span><br><span class="line"> element.<span class="title function_">removeEventListener</span>(eventName, fn); <span class="comment">// 第三个参数 默认是false</span></span><br><span class="line"> &#125; <span class="keyword">else</span> <span class="keyword">if</span> (element.<span class="property">detachEvent</span>) &#123;</span><br><span class="line"> element.<span class="title function_">detachEvent</span>(<span class="string">&#x27;on&#x27;</span> + eventName, fn);</span><br><span class="line"> &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"> element[<span class="string">&#x27;on&#x27;</span> + eventName] = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>事件对象（Event）<br>事件触发时会传入一个事件对象，包含事件信息（目标元素、事件类型、坐标等）<ul>
<li>e.target 和 this 的区别：<br>this 是事件绑定的元素， 这个函数的调用者（绑定这个事件的元素）<br>e.target 是事件触发的元素。</li>
<li>常用属性：target, currentTarget, type, bubbles, cancelable</li>
<li>常用方法：preventDefault(), stopPropagation()</li>
<li>补充<br>1.type获取当前的事件类型<br>2.clientX&#x2F;clientY获取光标相对于浏览器可见窗口左上角的位置<br>3.offsetX&#x2F;offsetY获取光标相对于当前DOM元素左上角的位置<br>4.key用户按下的键盘键的值，现在不提倡使用keyCode已废弃（可读性差）<br>5.pageX&#x2F;pageY 鼠标相当于文档页面的X坐标&#x2F;Y坐标 IE9+支持<br>6.screenX&#x2F;screenY 鼠标相对于电脑屏幕的X坐标&#x2F;Y坐标<br><img src="/images/JS%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0.assets/a2c55f6226974fd7b4c05dc8910b706a.png" alt="在这里插入图片描述"></li>
</ul>
</li>
</ul>
<h1 id="ES6-重点"><a href="#ES6-重点" class="headerlink" title="ES6+重点"></a>ES6+重点</h1><table>
<thead>
<tr>
<th>重点</th>
<th>内容</th>
</tr>
</thead>
<tbody><tr>
<td>展开运算符</td>
<td>浅拷贝、合并、扩展、覆盖、rest 参数、转换为数组</td>
</tr>
<tr>
<td>可选链（Optional Chaining）<br>空值合并（Nullish Coalescing Operator）</td>
<td><code>?.</code> 和 <code>??</code><br>可选链遇到null&#x2F;undefined不会抛出错误，短路返回undefined<br>空值合并与&#96;</td>
</tr>
</tbody></table>
<ul>
<li>函数默认参数</li>
<li>对象字面量增强，即简写</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> name = <span class="string">&#x27;Bob&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> person = &#123;</span><br><span class="line">  name,           <span class="comment">// 属性简写</span></span><br><span class="line">  <span class="title function_">greet</span>(<span class="params"></span>) &#123; ... &#125; <span class="comment">// 方法简写</span></span><br><span class="line">  <span class="comment">//只是省略了 function 关键字和冒号 :，更清爽。</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>箭头函数 arrow function</p>
<ul>
<li><p>应用：回调函数，例如 setTimeout，避免 this 绑定错误；类方法，防止 this 绑定丢失；解决匿名函数this指向问题（匿名函数执行环境具有全局性）</p>
</li>
<li><p>作用：解决this执行环境造成的问题</p>
</li>
<li><p>箭头函数 v.s. 普通函数</p>
</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th>特性</th>
<th>普通函数 (<code>function</code>)</th>
<th>箭头函数 (<code>=&gt;</code>)</th>
</tr>
</thead>
<tbody><tr>
<td>函数提升</td>
<td>✅</td>
<td>❌</td>
</tr>
<tr>
<td><code>this</code> 绑定方式</td>
<td>动态，谁调用指向谁</td>
<td>静态，指向定义时外部上下文<br>继承的this不能通过call&#x2F;bind&#x2F;apply改变</td>
</tr>
<tr>
<td>可作为构造函数使用</td>
<td>是</td>
<td>❌ 否<br>没有prototype，自身无this，使用new报错</td>
</tr>
<tr>
<td>是否有 <code>arguments</code></td>
<td>有</td>
<td>❌ 没有，但可用<code>...args</code></td>
</tr>
<tr>
<td>是否有 <code>super</code> &#x2F; <code>new.target</code></td>
<td>有</td>
<td>❌ 没有</td>
</tr>
<tr>
<td>是否有yield和generator</td>
<td>有</td>
<td>❌轻量级设计</td>
</tr>
</tbody></table>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*箭头函数有两种格式。</span></span><br><span class="line"><span class="comment">1. 只包含一个表达式，连&#123; ... &#125;和return都省略掉了。自动作为返回值被返回；</span></span><br><span class="line"><span class="comment">只返回一个对象时注意，单表达式x =&gt; &#123; foo: x &#125;这么写会报错：正确写法：x =&gt; (&#123; foo: x &#125;)</span></span><br><span class="line"><span class="comment">2. 可以包含多条语句，这时候就不能省略&#123; ... &#125;和return。如果参数不是一个，就需要用括号()括起来。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">add</span> = (<span class="params">a, b</span>) =&gt; a + b;</span><br><span class="line"><span class="keyword">let</span> <span class="title function_">show</span>=(<span class="params">...args</span>)=&gt;&#123;</span><br><span class="line">    <span class="comment">//操作</span></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 无参数:</span></span><br><span class="line">() =&gt; <span class="number">3.14</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// 可变参数:</span></span><br><span class="line">(x, y, ...rest) =&gt; &#123;</span><br><span class="line">    <span class="keyword">var</span>  sum = x + y;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>; i&lt;rest.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        sum += [i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>模板字符串和传统字符串拼接的区别？</li>
</ul>
<table>
<thead>
<tr>
<th>项目</th>
<th>传统字符串拼接</th>
<th>模板字符串</th>
</tr>
</thead>
<tbody><tr>
<td>引号</td>
<td>单引号 <code>&#39;</code> 或双引号 <code>&quot;</code></td>
<td>反引号</td>
</tr>
<tr>
<td>拼接方式</td>
<td>使用 <code>+</code> 拼接</td>
<td>使用 <code>$&#123;&#125;</code> 插值</td>
</tr>
<tr>
<td>多行字符串</td>
<td>需要手动加 <code>\n</code> 或 <code>+</code></td>
<td>支持直接换行，即反引号区域内直接回车，无需加回车符号</td>
</tr>
<tr>
<td>支持表达式</td>
<td>不直观</td>
<td>直接写表达式、函数、变量等<code>$&#123;func(a)&#125;</code></td>
</tr>
</tbody></table>
<h2 id="模块化（CJS-ESM）"><a href="#模块化（CJS-ESM）" class="headerlink" title="模块化（CJS-&gt;ESM）"></a>模块化（CJS-&gt;ESM）</h2><ul>
<li>模块化插件化实现机制</li>
</ul>
<ol>
<li>通过对象实现注册</li>
</ol>
<p>特点：集中管理、共享状态</p>
<p><strong>常见场景</strong>：插件注册、事件注册、全局配置。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 插件系统 - 通过对象注册</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">PluginSystem</span> = &#123;</span><br><span class="line">  <span class="attr">plugins</span>: &#123;&#125;,</span><br><span class="line">  <span class="title function_">register</span>(<span class="params">name, plugin</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">plugins</span>[name] = plugin;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">get</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">plugins</span>[name];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title class_">PluginSystem</span>.<span class="title function_">register</span>(<span class="string">&#x27;logger&#x27;</span>, &#123; <span class="attr">log</span>: <span class="function"><span class="params">msg</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(msg) &#125;);</span><br><span class="line"><span class="title class_">PluginSystem</span>.<span class="title function_">get</span>(<span class="string">&#x27;logger&#x27;</span>).<span class="title function_">log</span>(<span class="string">&#x27;hello&#x27;</span>); <span class="comment">// hello</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>通过函数实现隔离：利用 <strong>函数作用域</strong> 或 <strong>闭包</strong> 来避免全局变量污染。</li>
</ol>
<p>特点：隔离作用域、<strong>避免冲突</strong>：不同模块各自有独立作用域。</p>
<p><strong>常见场景</strong>：模块封装、立即执行函数表达式 (IIFE)。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过函数隔离作用域</span></span><br><span class="line"><span class="keyword">const</span> counter = (<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> count = <span class="number">0</span>; <span class="comment">// 私有变量</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="title function_">increment</span>(<span class="params"></span>) &#123; count++; <span class="keyword">return</span> count; &#125;,</span><br><span class="line">    <span class="title function_">decrement</span>(<span class="params"></span>) &#123; count--; <span class="keyword">return</span> count; &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(counter.<span class="title function_">increment</span>()); <span class="comment">// 1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(counter.<span class="title function_">increment</span>()); <span class="comment">// 2</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(counter.<span class="title function_">decrement</span>()); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>

<h3 id="ES-Modules"><a href="#ES-Modules" class="headerlink" title="ES Modules"></a>ES Modules</h3><ul>
<li>模块加载过程</li>
</ul>
<ol>
<li>构建——查找、下载、将所有文件解析放入模块记录。</li>
<li>预处理：链接（link）——分析模块依赖关系，创建执行上下文和初始化变量</li>
<li>求值（evaluate）——运行代码，把内存中的变量赋予真实的值。</li>
</ol>
<ul>
<li><p>规范：每个 js 文件都是独立模块；多次导入视为一次；不能提升，先导入后使用</p>
</li>
<li><p>使用</p>
</li>
</ul>
<ol>
<li>默认导出&#x2F;导入：每个模块只允许一次export default否则报错</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;<span class="comment">//默认导出</span></span><br><span class="line">    n1,</span><br><span class="line">    show</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//a.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">get_data</span>(<span class="params">url</span>)&#123; </span><br><span class="line">    <span class="title function_">fetch</span>(url)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">json</span>())</span><br><span class="line">    .<span class="title function_">then</span>(</span><br><span class="line">        <span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">            <span class="keyword">return</span> data;</span><br><span class="line">        &#125;</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//b.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; get_data &#125; <span class="keyword">from</span> <span class="string">&#x27;./utils.js&#x27;</span>; <span class="comment">//按需导入</span></span><br><span class="line"><span class="comment">//同时要在b.html中模块化的引入b.js</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//html</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>  <span class="attr">type</span>=<span class="string">&quot;module&quot;</span> <span class="attr">src</span>=<span class="string">&quot;./js/b.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>按需导出&#x2F;导入：名字要对应，可用as重命名，可以和默认导入一起</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 按需导出</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">add</span> = (<span class="params">a, b</span>) =&gt; a + b;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> a=<span class="number">12</span>; <span class="comment">//也可以导出变量</span></span><br><span class="line"><span class="keyword">const</span> b=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">const</span> c=<span class="number">2</span>;</span><br><span class="line"><span class="keyword">export</span> &#123;b <span class="keyword">as</span> beta ,c <span class="keyword">as</span> cici&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">say</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 按需导入</span></span><br><span class="line"><span class="keyword">import</span> &#123; add,a,cici &#125; <span class="keyword">from</span> <span class="string">&#x27;./math.js&#x27;</span>;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>单纯执行某个模块代码：不需要export，直接导入自动执行，模块顶层代码总是先于模块内部函数执行</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// c.js</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)<span class="variable language_">console</span>.<span class="title function_">log</span>(i)</span><br><span class="line"> </span><br><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./c.js&#x27;</span> <span class="comment">//直接导入并执行</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>html文件引入：<code>&lt;script type=&quot;module&quot;&gt;&lt;/script&gt;</code>+上述引入方式</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;module&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">import</span> * <span class="keyword">as</span> modTwo <span class="keyword">from</span> <span class="string">&#x27;./modules/2.js&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(modTwo.<span class="property">aaa</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="CommonJS"><a href="#CommonJS" class="headerlink" title="CommonJS"></a>CommonJS</h3><ul>
<li><p>require原理：读取文件为字符串，包裹为一个函数字符串；放到 vm 里去执行变为函数（类似 new Function）；执行函数，传入 <code>require</code>，<code>module</code>，<code>module.exports</code> 等参数</p>
</li>
<li><p>Node 在执行一个 <code>.js</code> 文件时，会把它包装成一个函数，并传入一些参数（类似于“沙箱”），所以你在模块作用域里能直接用到 <code>exports</code>, <code>require</code>, <code>module</code>, <code>__filename</code>, <code>__dirname</code>。</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Module</span> &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="string">&#x27;.&#x27;</span>,                  <span class="comment">// 模块标识符，主入口是 &#x27;.&#x27;</span></span><br><span class="line">  <span class="attr">exports</span>: &#123;&#125;,              <span class="comment">// 模块导出的对象，require() 拿到的就是这个</span></span><br><span class="line">  <span class="attr">parent</span>: [<span class="title class_">Module</span>],         <span class="comment">// 调用当前模块的父模块（require 它的模块）</span></span><br><span class="line">  <span class="attr">filename</span>: <span class="string">&#x27;/path/to/file.js&#x27;</span>, <span class="comment">// 当前模块的绝对路径</span></span><br><span class="line">  <span class="attr">loaded</span>: <span class="literal">true</span>/<span class="literal">false</span>,       <span class="comment">// 是否已经加载完成</span></span><br><span class="line">  <span class="attr">children</span>: [<span class="title class_">Module</span>],       <span class="comment">// 当前模块直接引用的子模块</span></span><br><span class="line">  <span class="attr">paths</span>: [ ... ]            <span class="comment">// require 查找模块的路径数组</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">module</span>);<span class="comment">//输出模块module结构</span></span><br></pre></td></tr></table></figure>

<h2 id="类（封装、多态、继承）"><a href="#类（封装、多态、继承）" class="headerlink" title="类（封装、多态、继承）"></a>类（封装、多态、继承）</h2><ul>
<li>class v.s. 构造函数<br>相同点：都能创建实例对象；实例通过 new 创建；实例属性是构造函数内部 this 定义；共享方法都挂载在 prototype 上；都可以继承（class 更方便）；</li>
</ul>
<table>
<thead>
<tr>
<th>对比点</th>
<th>构造函数（Function）</th>
<th>Class（类）</th>
</tr>
</thead>
<tbody><tr>
<td>原型方法定义</td>
<td>手动挂载在 prototype 上</td>
<td>自动添加到 prototype</td>
</tr>
<tr>
<td>严格模式</td>
<td>默认非严格模式，普通函数形式能提升，函数作用域</td>
<td><strong>自动使用严格模式</strong>，不能被提升，必须在使用前声明，块级作用域</td>
</tr>
<tr>
<td>类体方法枚举性</td>
<td>自定义方法默认可枚举</td>
<td>类中方法默认不可枚举</td>
</tr>
<tr>
<td>静态方法</td>
<td>需要手动挂载</td>
<td>使用 <code>static</code> 定义更方便</td>
</tr>
<tr>
<td>类本质</td>
<td><code>function</code></td>
<td>是语法糖，本质还是函数</td>
</tr>
<tr>
<td>继承</td>
<td><code>call</code> 或 <code>Object.create</code></td>
<td><code>extends</code> 更优雅</td>
</tr>
</tbody></table>
<ul>
<li>构造函数首字母应当大写，而普通函数首字母应当小写，语法检查工具ESlint能检测到漏写的new</li>
<li>ES6 引入面向对象编程的语法糖，使用 class 关键字定义类。class的定义包含构造函数constructor，避免手动继承（操作原型链）<code>Student.prototype.hello = function () &#123;...&#125;</code>分散代码。<br>用关键字new来调用构造函数，并返回一个对象，从原型上获得constructor属性，它指向构造函数，绑定this指向新创建对象，默认返回this，不需要在最后写return this；</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xiaoming.<span class="property">constructor</span> === <span class="title class_">Student</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span>; <span class="comment">// true</span></span><br><span class="line"><span class="title class_">Student</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> === <span class="title class_">Student</span>; <span class="comment">// true</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(xiaoming) === <span class="title class_">Student</span>.<span class="property"><span class="keyword">prototype</span></span>; <span class="comment">// true</span></span><br><span class="line">xiaoming <span class="keyword">instanceof</span> <span class="title class_">Student</span>; <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<ul>
<li>静态方法：方法前面加static，不需要创建实例，直接调用类.类方法，class_name.static_func()</li>
<li>继承：子类extends父类</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">//父类</span></span><br><span class="line">        <span class="keyword">class</span> <span class="title class_">Person</span>&#123;<span class="comment">//注意首字母大写！！</span></span><br><span class="line">            <span class="title function_">constructor</span>(<span class="params">name</span>)&#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="title function_">showName</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">`名字为: <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//子类</span></span><br><span class="line">        <span class="keyword">class</span> <span class="title class_">Student</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Person</span>&#123;</span><br><span class="line">            <span class="title function_">constructor</span>(<span class="params">name,skill</span>)&#123;<span class="comment">//别忘了加上参数</span></span><br><span class="line">                <span class="variable language_">super</span>(name);</span><br><span class="line"><span class="comment">//扩展子类而不是覆盖对应函数时，必须super（）把父类对应函数拉过来 </span></span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">skill</span> = skill;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="title function_">showSkill</span>(<span class="params"></span>)&#123;</span><br><span class="line">            	<span class="variable language_">super</span>.<span class="title function_">showSkill</span>(); <span class="comment">//父级的同名方法执行</span></span><br><span class="line">                <span class="keyword">return</span>  <span class="string">`哥们儿的技能为: <span class="subst">$&#123;<span class="variable language_">this</span>.skill&#125;</span>`</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//调用</span></span><br><span class="line">        <span class="keyword">let</span> stu1 = <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&#x27;Strive&#x27;</span>,<span class="string">&#x27;逃学&#x27;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(stu1.<span class="title function_">showSkill</span>());</span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;<span class="comment">//ES6 class</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">greet</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, I&#x27;m <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">// 计算属性名（computed property names）在 ES6 中动态创建对象的属性或方法名。</span></span><br><span class="line"><span class="comment">//[a + b] 这种语法可以通过表达式来计算属性名或方法名。a,b分别是两个变量</span></span><br><span class="line">  [a + b]() &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;This is a dynamic method!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">get 和 set 用于定义属性访问器（accessor properties）的关键字。自定义属性的获取（getter）和设置（setter）行为。</span></span><br><span class="line"><span class="comment">使用 getter 和 setter 的优点：</span></span><br><span class="line"><span class="comment">你可以在设置属性时，加入额外的逻辑，例如数据验证、格式化等。</span></span><br><span class="line"><span class="comment">获取属性时，你可以动态计算或处理值，而不需要暴露复杂的内部逻辑。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// Getter: 获取_name的值，通过 person.name 的方式访问，实际上调用的是 get name() 方法。</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">name</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_name</span>;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// Setter: 设置_name的值，通过 person.name = &#x27;newName&#x27; 的方式调用，实际上会触发 set name(value) 方法</span></span><br><span class="line">  <span class="keyword">set</span> <span class="title function_">name</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (value.<span class="property">length</span> &lt; <span class="number">3</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Name must be at least 3 characters long.&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">_name</span> = value;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> &lt;script&gt;</span><br><span class="line"><span class="comment">//新版</span></span><br><span class="line">        <span class="title class_">Object</span>.<span class="title function_">assign</span>(<span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>,&#123; <span class="comment">//assign 合并</span></span><br><span class="line">            <span class="title function_">showName</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">`名字为: <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="title function_">showAge</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">`年龄为: <span class="subst">$&#123;<span class="variable language_">this</span>.age&#125;</span>`</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Symbol"><a href="#Symbol" class="headerlink" title="Symbol"></a>Symbol</h2><ul>
<li>作用：独一无二，避免冲突，常用作key&#x2F;属性名</li>
<li>不可以new</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> s=<span class="title class_">Symbol</span>();<span class="comment">//前面不能加new</span></span><br><span class="line"><span class="keyword">const</span> s1=<span class="title class_">Symbol</span>(<span class="string">&quot;666&quot;</span>);<span class="comment">//必须传入字符串，如果不是则使用toString方法转换</span></span><br><span class="line"><span class="keyword">let</span> obj=&#123;<span class="comment">//obj[s1]访问</span></span><br><span class="line">  [s1]:<span class="string">&quot;888&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//for..in/Object.keys()/Object.getOwnPropertyNames()/JSON.stringify()等都不能获取到symbol类型</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">getOwnPropertySymbols</span>(obj)<span class="comment">//获取所有symbol类型的属性名</span></span><br><span class="line"><span class="title class_">Reflect</span>.<span class="property">ownKeys</span><span class="comment">//ES6 返回所有类型的属性名</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Symbol</span>.<span class="title function_">for</span>(str)<span class="comment">//全局注册</span></span><br><span class="line"><span class="title class_">Symbol</span>.<span class="title function_">keyFor</span>(str)<span class="comment">//传入symbol值 返回其全局注册的key名</span></span><br></pre></td></tr></table></figure>

<h2 id="解构赋值Destructuring-Assignment"><a href="#解构赋值Destructuring-Assignment" class="headerlink" title="解构赋值Destructuring Assignment"></a>解构赋值Destructuring Assignment</h2><ul>
<li>作用：数组或对象；可选部分元素，直接对多个变量同时赋值。</li>
<li>规则：</li>
</ul>
<ol>
<li>对象需要指定属性名，如果对应属性不存在，变量将被赋值为undefined；数组解构用中括号包裹，对象解构用花括号包裹</li>
<li>可直接对嵌套属性赋值</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span>  [x, y, z] = [<span class="string">&#x27;hello&#x27;</span>, <span class="string">&#x27;JavaScript&#x27;</span>, <span class="string">&#x27;ES6&#x27;</span>];</span><br><span class="line"><span class="keyword">let</span> [, , z] = [<span class="string">&#x27;hello&#x27;</span>, <span class="string">&#x27;JavaScript&#x27;</span>, <span class="string">&#x27;ES6&#x27;</span>]; <span class="comment">// 忽略前两个元素，只对z赋值第三个元素</span></span><br><span class="line">[x, y] = [y, x]; <span class="comment">// 交换变量</span></span><br><span class="line"><span class="comment">/*数组元素嵌套也可解构赋值，注意嵌套层次和位置要保持一致。*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">20</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;male&#x27;</span>,</span><br><span class="line">    <span class="attr">passport</span>: <span class="string">&#x27;G-12345678&#x27;</span>,</span><br><span class="line">    <span class="attr">school</span>: <span class="string">&#x27;No.4 middle school&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> &#123;name, age, passport&#125; = person;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">20</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;male&#x27;</span>,</span><br><span class="line">    <span class="attr">passport</span>: <span class="string">&#x27;G-12345678&#x27;</span>,</span><br><span class="line">    <span class="attr">school</span>: <span class="string">&#x27;No.4 middle school&#x27;</span>,</span><br><span class="line">    <span class="attr">address</span>: &#123;</span><br><span class="line">        <span class="attr">city</span>: <span class="string">&#x27;Beijing&#x27;</span>,</span><br><span class="line">        <span class="attr">street</span>: <span class="string">&#x27;No.1 Road&#x27;</span>,</span><br><span class="line">        <span class="attr">zipcode</span>: <span class="string">&#x27;100001&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> &#123;name, <span class="attr">address</span>: &#123;city, zip&#125;&#125; = person;</span><br><span class="line">name; <span class="comment">// &#x27;小明&#x27;</span></span><br><span class="line">city; <span class="comment">// &#x27;Beijing&#x27;</span></span><br><span class="line">zip; <span class="comment">// undefined, 因为属性名是zipcode而不是zip</span></span><br><span class="line"><span class="comment">// 注意: address这里并未赋值，而是为了让city和zip获得嵌套对象属性</span></span><br><span class="line">address; <span class="comment">// Uncaught ReferenceError: address is not defined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//起别名</span></span><br><span class="line"> <span class="keyword">let</span> &#123;<span class="attr">name</span>: myName, <span class="attr">age</span>: myAge&#125; = json; <span class="comment">// myName myAge 属于别名，而原name和age都不会被赋值，即未定义。</span></span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(myName); <span class="comment">// &#x27;a&#x27; </span></span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(myAge); <span class="comment">// 18</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//参数中的对象解构</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">show</span>(<span class="params">&#123;x, y&#125;</span>) &#123;<span class="comment">//从传入的对象中提取 x 和 y 属性并将它们作为函数的局部变量使用</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(x, y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置默认值，避免不存在属性返回undefined</span></span><br><span class="line"><span class="keyword">var</span> &#123;name, single=<span class="literal">true</span>&#125; = person;<span class="comment">// 如果person对象没有single属性，默认赋值为true:</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*如果变量已声明，再给其解构赋值时，正确写法也会报语法错误</span></span><br><span class="line"><span class="comment">因为JavaScript引擎把&#123;开头语句当作块处理，所以=不合法。解决方法是用小括号括起来：</span></span><br><span class="line"><span class="comment">`(&#123;x, y&#125; = &#123; name: &#x27;小明&#x27;, x: 100, y: 200&#125;);`</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">var</span> x, y;</span><br><span class="line">&#123;x, y&#125; = &#123; <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>, <span class="attr">x</span>: <span class="number">100</span>, <span class="attr">y</span>: <span class="number">200</span>&#125;;<span class="comment">// 语法错误: Uncaught SyntaxError: Unexpected token =</span></span><br></pre></td></tr></table></figure>

<h2 id="iterable-v-s-iterator"><a href="#iterable-v-s-iterator" class="headerlink" title="iterable v.s. iterator"></a>iterable v.s. iterator</h2><ul>
<li>定义<ul>
<li>Iterable 是可被遍历的对象，只要对象拥有 Symbol.iterator 方法，它就是 Iterable。</li>
<li>迭代器 Iterator 是遍历时生成的“指针对象”，用来逐步访问每个元素，有 next() 方法，每次调用返回一个对象</li>
<li>两者关系<br>Iterable 产生 Iterator<br>可迭代对象调用其 Symbol.iterator() 方法后，返回一个 Iterator 对象。<code>const iter = arr[Symbol.iterator]();</code></li>
</ul>
</li>
<li>注意：普通Object和weapMap不是可迭代对象iterable</li>
<li>作用：懒加载遍历器</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//for ... of循环 只循环集合本身的元素</span></span><br><span class="line"><span class="comment">//Map不能用索引取值，因为是按插入顺序保存键值对</span></span><br></pre></td></tr></table></figure>

<h2 id="生成器generator"><a href="#生成器generator" class="headerlink" title="生成器generator"></a>生成器generator</h2><ul>
<li>定义：可以“暂停执行”的函数，每次调用 next() 执行一步，遇到 yield 暂停。</li>
<li>作用：暂停&#x2F;恢复，异步流程控制、惰性迭代器；看上去是同步的代码，实际执行是异步的。</li>
<li>使用：<code>function*</code>，用return返回&#x2F;yield返回多次</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">fib</span>(<span class="params">max</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> t,</span><br><span class="line">        a = <span class="number">0</span>,</span><br><span class="line">        b = <span class="number">1</span>,</span><br><span class="line">        n = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (n &lt; max) &#123;</span><br><span class="line">        <span class="keyword">yield</span> a;</span><br><span class="line">        [a, b] = [b, a + b];</span><br><span class="line">        n ++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">fib</span>(<span class="number">5</span>); </span><br><span class="line"><span class="comment">//直接调用一个generator和调用函数不一样，fib(5)仅仅是创建了一个generator对象，还没有去执行它。</span></span><br><span class="line"><span class="comment">//调用generator对象有两个方法，一是不断地调用generator对象的next()方法：</span></span><br><span class="line"><span class="keyword">var</span> f = <span class="title function_">fib</span>(<span class="number">5</span>);</span><br><span class="line">f.<span class="title function_">next</span>(); <span class="comment">// &#123;value: 0, done: false&#125;</span></span><br><span class="line">f.<span class="title function_">next</span>(); <span class="comment">// &#123;value: 1, done: false&#125;</span></span><br><span class="line">f.<span class="title function_">next</span>(); <span class="comment">// &#123;value: 1, done: false&#125;</span></span><br><span class="line">f.<span class="title function_">next</span>(); <span class="comment">// &#123;value: 2, done: false&#125;</span></span><br><span class="line">f.<span class="title function_">next</span>(); <span class="comment">// &#123;value: 3, done: false&#125;</span></span><br><span class="line">f.<span class="title function_">next</span>(); <span class="comment">// &#123;value: undefined, done: true&#125;</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">next()方法会执行generator的代码，</span></span><br><span class="line"><span class="comment">每次遇到yield x;就返回一个对象&#123;value: x, done: true/false&#125;，然后“暂停”。</span></span><br><span class="line"><span class="comment">返回的value就是yield的返回值，</span></span><br><span class="line"><span class="comment">done表示这个generator是否已经执行结束了。</span></span><br><span class="line"><span class="comment">如果done为true，则value就是return的返回值。</span></span><br><span class="line"><span class="comment">当执行到done为true时，这个generator对象就已经全部执行完毕，不要再继续调用next()了。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//第二个方法是直接用for ... of循环迭代generator对象，这种方式不需要我们自己判断done</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> x <span class="keyword">of</span> <span class="title function_">fib</span>(<span class="number">10</span>)) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(x); <span class="comment">// 依次输出0, 1, 1, 2, 3, ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//生成器可以解构赋值</span></span><br><span class="line"><span class="keyword">let</span> [a, ...b] = <span class="title function_">gen</span>();<span class="comment">//let[a.b.c]</span></span><br><span class="line"><span class="comment">//扩展运算符</span></span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(...<span class="title function_">gen</span>());</span><br><span class="line"> <span class="comment">//转换为数组</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="title function_">gen</span>()));</span><br><span class="line"></span><br><span class="line"><span class="comment">//改进</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/axios/dist/axios.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	<span class="keyword">function</span>* <span class="title function_">gen</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">let</span> val = <span class="keyword">yield</span> <span class="string">&#x27;aaa&#x27;</span>;  <span class="comment">// This is where we get the username</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">let</span> response = <span class="keyword">yield</span> axios.<span class="title function_">get</span>(<span class="string">`https://api.github.com/users/<span class="subst">$&#123;val&#125;</span>`</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">return</span> response.<span class="property">data</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//返回一个 Promise 对象</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">function</span> <span class="title function_">handleGenerator</span>(<span class="params">gen</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">const</span> iterator = <span class="title function_">gen</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">function</span> <span class="title function_">iterate</span>(<span class="params">result</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="keyword">if</span> (result.<span class="property">done</span>) <span class="keyword">return</span>;  <span class="comment">// If done, stop</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="comment">//配合Promise.then()</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            result.<span class="property">value</span>.<span class="title function_">then</span>(<span class="function"><span class="params">val</span> =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="title function_">iterate</span>(iterator.<span class="title function_">next</span>(val));  <span class="comment">//递归调用</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="title function_">iterate</span>(iterator.<span class="title function_">next</span>());  </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">handleGenerator</span>(gen);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<h2 id="装饰器-decorator"><a href="#装饰器-decorator" class="headerlink" title="装饰器 decorator"></a>装饰器 decorator</h2><ul>
<li>定义：ES2022 装饰器用于修改类&#x2F;方法&#x2F;属性。本质是函数，用来增强、修改或替换功能。目前很多浏览器还不完全支持，但可以通过 Babel 等工具启用和转译。</li>
<li>应用：<br>日志记录：自动记录方法调用的日志。<br>权限控制：在类方法前加上装饰器，进行权限验证。<br>缓存：给方法加上装饰器进行缓存，避免重复计算。<br>观察者模式：通过装饰器观察对象状态的变化。</li>
<li>需要注意的事项：<br>装饰器需要在 class 或方法定义前使用 @ 符号进行标记。<br>装饰器的行为修改是浅拷贝的，无法对类本身的实例进行深度操作。</li>
</ul>
<ol>
<li>类装饰器：用于修改类的构造函数或类本身。它是一个函数，接收类的构造函数作为参数，并返回一个修改后的构造函数。</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">myDecorator</span>(<span class="params">target</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(target); <span class="comment">// 输出类的构造函数</span></span><br><span class="line">  target.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">decorated</span> = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@myDecorator</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> instance = <span class="keyword">new</span> <span class="title class_">MyClass</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(instance.<span class="property">decorated</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>方法装饰器：用于修改类方法的行为。它接收三个参数：<br>类的原型（如果是实例方法）或构造函数（如果是静态方法）<br>方法名<br>方法描述符（descriptor）</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">log 装饰器拦截了 add 方法的调用，打印了传入的参数和返回的结果。</span></span><br><span class="line"><span class="comment">方法装饰器通过 descriptor 对象修改方法的行为。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">log</span>(<span class="params">target, key, descriptor</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> originalMethod = descriptor.<span class="property">value</span>;</span><br><span class="line">  descriptor.<span class="property">value</span> = <span class="keyword">function</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Calling <span class="subst">$&#123;key&#125;</span> with arguments: <span class="subst">$&#123;args&#125;</span>`</span>);</span><br><span class="line">    <span class="keyword">const</span> result = originalMethod.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;key&#125;</span> returned: <span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> descriptor;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line">  @log</span><br><span class="line">  <span class="title function_">add</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> instance = <span class="keyword">new</span> <span class="title class_">MyClass</span>();</span><br><span class="line">instance.<span class="title function_">add</span>(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"><span class="comment">// 输出:</span></span><br><span class="line"><span class="comment">// Calling add with arguments: [1, 2]</span></span><br><span class="line"><span class="comment">// add returned: 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> count = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> oldParseInt = <span class="built_in">parseInt</span>; <span class="comment">// 保存原函数</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">parseInt</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    count += <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> oldParseInt.<span class="title function_">apply</span>(<span class="literal">null</span>, <span class="variable language_">arguments</span>); <span class="comment">// 调用原函数</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>属性装饰器<br>属性装饰器用于修改类实例的属性。它只能作用于类的属性声明，但不能直接修改属性的值。</li>
</ol>
<ul>
<li>属性描述符（Property Descriptor）<br>属性描述符 是 JavaScript 中 用来描述对象属性特性 的对象。它定义了属性的 可写性、可枚举性 和 可配置性 等特性。<br>属性描述符分为两种类型：</li>
</ul>
<ol>
<li>数据属性（Data Descriptor）</li>
<li>访问器属性（Accessor Descriptor）<br>(1) 数据属性<br>数据属性是存储实际值的属性，包含以下四个特性：</li>
</ol>
<table>
<thead>
<tr>
<th>特性</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td><code>value</code></td>
<td>该属性的值</td>
</tr>
<tr>
<td><code>writable</code></td>
<td>是否可以修改该属性的值（<code>true</code> &#x2F; <code>false</code>）</td>
</tr>
<tr>
<td><code>enumerable</code></td>
<td>是否可以在 <code>for...in</code> 或 <code>Object.keys()</code> 里遍历（<code>true</code> &#x2F; <code>false</code>）</td>
</tr>
<tr>
<td><code>configurable</code></td>
<td>是否可以删除或修改该属性的特性（<code>true</code> &#x2F; <code>false</code>）</td>
</tr>
</tbody></table>
<p>(2) 访问器属性<br>访问器属性不存储值，而是通过 getter 和 setter 进行访问和修改。它包含以下四个特性：<br>get	获取属性时调用的函数<br>set	设置属性时调用的函数<br>enumerable	是否可以在 for…in 或 Object.keys() 里遍历<br>configurable	是否可以删除或修改该属性的特性</p>
<blockquote>
<p>getter（获取器）和 setter（设置器）是对象的访问器属性，用于控制属性的获取和赋值行为，而不是直接存储值。<br>getter（获取器）用于 定义当访问属性时执行的函数。<br>通过 get 关键字定义。<br>getter 没有参数，必须返回一个值。</p>
</blockquote>
<blockquote>
<p>setter（设置器）用于 定义当设置属性时执行的函数。<br>通过 set 关键字定义。<br>setter 接受一个参数，表示新赋的值。</p>
</blockquote>
<blockquote>
<p>为什么要用getter ,setter？生成一个独立的属性<br>如果你只定义 getter 而不定义 setter，属性就是只读的</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> person = &#123;</span><br><span class="line">  <span class="attr">firstName</span>: <span class="string">&quot;Alice&quot;</span>,</span><br><span class="line">  <span class="attr">lastName</span>: <span class="string">&quot;Smith&quot;</span>,</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">fullName</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">firstName</span> + <span class="string">&quot; &quot;</span> + <span class="variable language_">this</span>.<span class="property">lastName</span>;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="keyword">set</span> <span class="title function_">fullName</span>(<span class="params">value</span>) &#123;  <span class="comment">// 定义 setter</span></span><br><span class="line">    <span class="keyword">const</span> parts = value.<span class="title function_">split</span>(<span class="string">&quot; &quot;</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">firstName</span> = parts[<span class="number">0</span>];</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">lastName</span> = parts[<span class="number">1</span>];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">person.<span class="property">fullName</span> = <span class="string">&quot;Bob Johnson&quot;</span>; <span class="comment">// 触发 setter</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="property">firstName</span>); <span class="comment">// &quot;Bob&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="property">lastName</span>);  <span class="comment">// &quot;Johnson&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">readonly 装饰器使得 name 属性变为只读。</span></span><br><span class="line"><span class="comment">在尝试修改 name 时会抛出错误。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">readonly 装饰器通过修改对象属性的 属性描述符（descriptor）来实现只读功能</span></span><br><span class="line"><span class="comment">属性描述符（Descriptor）</span></span><br><span class="line"><span class="comment">在 JavaScript 中，每个对象的属性都可以有一个 属性描述符（descriptor），这个描述符包含了该属性的一些特性，例如：</span></span><br><span class="line"><span class="comment">writable：决定属性是否可以被修改。</span></span><br><span class="line"><span class="comment">configurable：决定属性是否可以被删除或修改。</span></span><br><span class="line"><span class="comment">enumerable：决定属性是否可以出现在 for...in 循环和 Object.keys() 中。</span></span><br><span class="line"><span class="comment">get 和 set：用于定义 getter 和 setter 方法。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Object.defineProperty() 和 属性描述符</span></span><br><span class="line"><span class="comment">Object.defineProperty() 是 JavaScript 提供的一个方法，定义或修改对象的属性，同时也能设置这些属性的描述符。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(obj, prop, descriptor)</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(对象，修改或新增的属性名，&#123;</span><br><span class="line">		<span class="attr">value</span>:修改或新增的属性的值,</span><br><span class="line">		<span class="attr">writable</span>:<span class="literal">true</span>/<span class="literal">false</span>,<span class="comment">//如果值为false 不允许修改这个属性值</span></span><br><span class="line">		<span class="attr">enumerable</span>: <span class="literal">false</span>,<span class="comment">//enumerable 如果值为false 则不允许遍历</span></span><br><span class="line">        <span class="attr">configurable</span>: <span class="literal">false</span>  <span class="comment">//configurable 如果为false 则不允许删除这个属性 属性是否可以被删除或是否可以再次修改特性</span></span><br><span class="line">&#125;)	</span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(obj, <span class="string">&quot;name&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">value</span>: <span class="string">&quot;John&quot;</span>,</span><br><span class="line">  <span class="attr">writable</span>: <span class="literal">false</span>,  <span class="comment">// 设置为只读</span></span><br><span class="line">  <span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">configurable</span>: <span class="literal">false</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">readonly</span>(<span class="params">target, key, descriptor</span>) &#123;</span><br><span class="line">  <span class="comment">// 修改属性描述符</span></span><br><span class="line">  descriptor.<span class="property">writable</span> = <span class="literal">false</span>;  <span class="comment">// 设置属性为只读</span></span><br><span class="line">  <span class="keyword">return</span> descriptor;  <span class="comment">// 返回修改后的描述符</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">target：指的是目标对象（类的原型或者实例）</span></span><br><span class="line"><span class="comment">key：指的是属性名或方法名。</span></span><br><span class="line"><span class="comment">descriptor：指的是属性或方法的描述符，其中包含了属性的各种设置（例如 writable、configurable、enumerable 等）。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">readonly</span>(<span class="params">target, key</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> descriptor = &#123;</span><br><span class="line">    <span class="attr">writable</span>: <span class="literal">false</span></span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> descriptor;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line">  @readonly</span><br><span class="line">  name = <span class="string">&quot;John Doe&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> instance = <span class="keyword">new</span> <span class="title class_">MyClass</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(instance.<span class="property">name</span>); <span class="comment">// &quot;John Doe&quot;</span></span><br><span class="line">instance.<span class="property">name</span> = <span class="string">&quot;Jane Doe&quot;</span>; <span class="comment">// TypeError: Cannot assign to read only property &#x27;name&#x27;</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>访问器装饰器（getter&#x2F;setter）<br>访问器装饰器可以应用于类的 getter 或 setter 方法，允许你对这些访问器进行修饰。<br>类的 getter 和 setter 方法是 JavaScript 中的一种特殊方法，用于访问和设置对象的属性。它们提供了对对象属性的封装，允许你在获取或修改属性时执行额外的逻辑。通过 getter 和 setter，你可以控制如何读取和修改对象的属性。</li>
</ol>
<blockquote>
<p>Getter（访问器）<br>getter 是一个方法，它允许你定义对象属性的读取行为。它会在访问该属性时自动调用。<br>Setter（设置器）<br>setter 是一个方法，它允许你定义对象属性的设置行为。它会在给该属性赋值时自动调用。<br>使用 getter 和 setter 的场景<br>数据验证：可以在设置属性值之前进行验证，确保其有效性。<br>懒加载：如果属性值比较复杂，可以在 getter 中做懒加载（延迟计算），避免每次访问都进行计算。<br>属性代理：你可以通过 getter 和 setter 来创建虚拟属性，这些属性并不直接存储在对象中，而是计算得出的。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">firstName, lastName</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">firstName</span> = firstName;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">lastName</span> = lastName;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// Getter：懒加载 fullName</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">fullName</span>() &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Calculating full name...&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.firstName&#125;</span> <span class="subst">$&#123;<span class="variable language_">this</span>.lastName&#125;</span>`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> user = <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;John&quot;</span>, <span class="string">&quot;Doe&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(user.<span class="property">fullName</span>); <span class="comment">// &quot;Calculating full name...&quot; 和 &quot;John Doe&quot; 会输出</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">有时，我们希望类的某些属性不能直接访问，可以通过添加前缀 _ 来表示它们是私有的，但实际还是通过 getter 和 setter 来访问它们。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_value</span> = value;  <span class="comment">// 私有属性，通常以 _ 开头</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Getter 方法</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">value</span>() &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Getting value&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_value</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Setter 方法</span></span><br><span class="line">  <span class="keyword">set</span> <span class="title function_">value</span>(<span class="params">newValue</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Setting value to &quot;</span> + newValue);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_value</span> = newValue;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">log</span>(<span class="params">target, key, descriptor</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> getter = descriptor.<span class="property">get</span>;</span><br><span class="line">  descriptor.<span class="property">get</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Getting <span class="subst">$&#123;key&#125;</span>`</span>);</span><br><span class="line">    <span class="keyword">return</span> getter.<span class="title function_">apply</span>(<span class="variable language_">this</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> descriptor;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_age</span> = <span class="number">30</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  @log</span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">age</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_age</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> instance = <span class="keyword">new</span> <span class="title class_">MyClass</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(instance.<span class="property">age</span>); <span class="comment">// &quot;Getting age&quot; 然后 &quot;30&quot;</span></span><br></pre></td></tr></table></figure>

<ol start="5">
<li>静态方法装饰器<br>静态方法装饰器与实例方法装饰器类似，但它应用于静态方法。</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">staticDecorator</span>(<span class="params">target, key, descriptor</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Static method <span class="subst">$&#123;key&#125;</span> is being decorated`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line">  @staticDecorator</span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">staticMethod</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Static method&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">MyClass</span>.<span class="title function_">staticMethod</span>(); <span class="comment">// Static method staticMethod is being decorated</span></span><br></pre></td></tr></table></figure>

<h2 id="二进制操作"><a href="#二进制操作" class="headerlink" title="二进制操作"></a>二进制操作</h2><p>ArrayBuffer</p>
<p>Buffer</p>
<h2 id="数字相关"><a href="#数字相关" class="headerlink" title="数字相关"></a>数字相关</h2><ul>
<li><p>+一元运算符 快速转换为整数，JS起初就有，同<code>~~</code></p>
</li>
<li><p><code>Number.isNaN(NaN)</code>    -&gt; true</p>
<p><code>Number.isFinite(a)</code>   判断是不是数字</p>
<p><code>Number.isInteger(a)</code> 判断数字是不是整数</p>
<p><code>Number.parseInt()</code> 给定进制数把字符串解析成整数。 <strong>忽略且停止解析于遇到第一个非数字字符及其之后的所有字符。</strong> </p>
<p><code>Number.parseFloat()</code> 把字符串解析成浮点数。也 <strong>忽略（停止解析于）遇到的第一个非浮点数合法字符（小数点除外）及其之后的所有字符。</strong> </p>
</li>
<li><p><strong>​​​​​​​</strong> 安全整数:    -(2^53-1) 到 (2^53-1),   包含-(2^53-1) 和(2^53-1)</p>
</li>
</ul>
<p>Number.isSafeInteger(a);</p>
<p>Number.MAX_SAFE_INTEGER    最大安全整数<br>Number.MIN_SAFE_INTEGER    最小安全整数</p>
<p>超过最大安全整数可能失去精度，变成近似值。因为 <strong>JavaScript 内部表示数字的方式是基于 IEEE 754 标准的 64 位双精度浮点数（double-precision floating-point numbers）</strong> 。</p>
<p>解决方案：ES2020 (ES11) 引入 <strong><code>BigInt</code></strong> 新原始数据类型，能表示 <strong>任意精度整数</strong> ，不受<code>MAX_SAFE_INTEGER</code> 限制，专门处理大整数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>.<span class="property">MAX_SAFE_INTEGER</span>);  <span class="comment">// 输出 9007199254740991</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// 超过最大安全整数时，可能会失去精度</span></span><br><span class="line"><span class="keyword">let</span> num = <span class="title class_">Number</span>.<span class="property">MAX_SAFE_INTEGER</span> + <span class="number">1</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(num);  <span class="comment">// 输出 9007199254740992</span></span><br><span class="line"><span class="keyword">let</span> num2 = <span class="title class_">Number</span>.<span class="property">MAX_SAFE_INTEGER</span> + <span class="number">2</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(num2);  <span class="comment">// 输出 9007199254740992（num 和 num2 值相同，丢失精度）</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// 计算大整数，超出安全范围时会失去精度</span></span><br><span class="line"><span class="keyword">let</span> largeNum = <span class="number">9007199254740992</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(largeNum + <span class="number">1</span> === largeNum + <span class="number">2</span>);  <span class="comment">// 输出 true，失去精度</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//如果需要处理超大整数（大于 MAX_SAFE_INTEGER），使用 BigInt 类型，它支持任意精度的大整数。</span></span><br></pre></td></tr></table></figure>

<h3 id="Math库"><a href="#Math库" class="headerlink" title="Math库"></a>Math库</h3><ul>
<li>一开始就有：</li>
</ul>
<p>Math.ceil()向上取整<br>Math.abs()<br>Math.sqrt()<br>Math.sin()</p>
<ul>
<li><p><strong>指数和对数相关：</strong> </p>
<ul>
<li><p><code>Math.cbrt(x)</code> : 返回 <code>x</code> 的立方根。</p>
</li>
<li><p><code>Math.expm1(x)</code> : 返回 <code>e^x - 1</code> 。在 <code>x</code> 接近 0 时，这比 <code>Math.exp(x) - 1</code> 更精确。</p>
</li>
<li><p><code>Math.log10(x)</code> : 返回 <code>x</code> 的以 10 为底的对数。</p>
</li>
<li><p><code>Math.log2(x)</code> : 返回 <code>x</code> 的以 2 为底的对数。</p>
</li>
<li><p><code>Math.log1p(x)</code> : 返回 <code>ln(1 + x)</code> 。在 <code>x</code> 接近 0 时，这比 <code>Math.log(1 + x)</code> 更精确。</p>
</li>
</ul>
</li>
<li><p><strong>符号和截断相关：</strong> </p>
<ul>
<li><p><code>Math.sign(x)</code> : 返回一个数的符号：1 (正数), -1 (负数), 0 (零), 或 NaN。sign英文名词译为正负号。</p>
</li>
<li><p><code>Math.trunc(x)</code> : 返回一个数的整数部分，移除其小数部分（直接截取，不四舍五入）。</p>
</li>
</ul>
</li>
<li><p><strong>双曲函数及其反函数：</strong> (这些在许多科学计算中非常有用)</p>
<ul>
<li><p><code>Math.sinh(x)</code> : 返回 <code>x</code> 的双曲正弦。</p>
</li>
<li><p><code>Math.cosh(x)</code> : 返回 <code>x</code> 的双曲余弦。</p>
</li>
<li><p><code>Math.tanh(x)</code> : 返回 <code>x</code> 的双曲正切。</p>
</li>
<li><p><code>Math.asinh(x)</code> : 返回 <code>x</code> 的反双曲正弦。</p>
</li>
<li><p><code>Math.acosh(x)</code> : 返回 <code>x</code> 的反双曲余弦。</p>
</li>
<li><p><code>Math.atanh(x)</code> : 返回 <code>x</code> 的反双曲正切。</p>
</li>
</ul>
</li>
<li><p><strong>其他实用函数：</strong> </p>
<ul>
<li><p><code>Math.hypot(...values)</code> : 返回其参数平方和的平方根。例如， <code>Math.hypot(x, y)</code> 可以计算直角三角形的斜边长度，并且比 <code>Math.sqrt(x*x + y*y)</code> 更能避免大数溢出。</p>
</li>
<li><p><code>Math.fround(x)</code> : 返回数字的最接近单精度浮点表示。对于与 WebGL 等需要处理单精度浮点数的 API 交互时很有用。</p>
</li>
<li><p><code>Math.imul(x, y)</code> : 返回两个 32 位整数相乘结果。处理位操作或需要 C 语言风格的 32 位整数乘法时非常有用，因为 JavaScript  <code>Number</code> 类型是 64 位浮点数，直接乘法可能有精度问题。</p>
</li>
<li><p><code>Math.clz32(x)</code> : 返回一个数字 <code>x</code> 的 32 位二进制表示中前导零的数量。在位操作和某些算法优化中很有用。</p>
</li>
</ul>
</li>
</ul>
<h2 id="ES6-7-12"><a href="#ES6-7-12" class="headerlink" title="ES6+(7~12)"></a>ES6+(7~12)</h2><h3 id="ES2016（ES7）"><a href="#ES2016（ES7）" class="headerlink" title="ES2016（ES7）"></a>ES2016（ES7）</h3><p>**幂运算 等同于 Math.pow(x, y)</p>
<p>Array.prototype.includes()： 检查数组是否包含某个元素，比 indexOf 查找 -1 更直观。</p>
<h3 id="ES2017（ES8）"><a href="#ES2017（ES8）" class="headerlink" title="ES2017（ES8）"></a>ES2017（ES8）</h3><p>async&#x2F;await<br>Object.values() &#x2F; Object.entries()<br>字符串填充 (String.prototype.padStart() &#x2F; padEnd()): 在字符串的开头或结尾填充字符。<br>SharedArrayBuffer 和 Atomics： 用于多线程并发编程（在 Web Workers 中），提供共享内存和原子操作的能力。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fetchData</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;https://api.example.com/data&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> data = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line">  <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span> &#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">entries</span>(obj)); <span class="comment">// [[&#x27;a&#x27;, 1], [&#x27;b&#x27;, 2]]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">values</span>(obj));  <span class="comment">// [1, 2]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;5&#x27;</span>.<span class="title function_">padStart</span>(<span class="number">2</span>, <span class="string">&#x27;0&#x27;</span>); <span class="comment">// &#x27;05&#x27;</span></span><br><span class="line"><span class="string">&#x27;5&#x27;</span>.<span class="title function_">padEnd</span>(<span class="number">3</span>, <span class="string">&#x27;0&#x27;</span>);   <span class="comment">// &#x27;500&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="ES2018-ES9"><a href="#ES2018-ES9" class="headerlink" title="ES2018 (ES9)"></a>ES2018 (ES9)</h3><p>异步迭代器（Asynchronous Iteration）和 for await…of： 允许 for…of 循环处理异步可迭代对象。<br>对象剩余属性和展开属性 (Rest&#x2F;Spread Properties for Objects)： 类似于数组展开，但用于对象字面量，方便复制和提取对象属性。<br>Promise.prototype.finally()： 无论 Promise 成功或失败，都会执行的回调。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span>* <span class="title function_">fetchData</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> data = <span class="keyword">await</span> <span class="title function_">getDataFromAPI</span>();</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> item <span class="keyword">of</span> data) &#123;</span><br><span class="line">    <span class="keyword">yield</span> item;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> <span class="title function_">await</span> (<span class="keyword">const</span> item <span class="keyword">of</span> <span class="title function_">fetchData</span>()) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(item);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ES2019-ES10"><a href="#ES2019-ES10" class="headerlink" title="ES2019 (ES10)"></a>ES2019 (ES10)</h3><p>Array.prototype.flat() &#x2F; flatMap()： 展平嵌套数组。<br>Object.fromEntries()： 将键值对列表转换为对象，与 Object.entries() 互补。<br>String.prototype.trimStart() &#x2F; trimEnd()： 移除字符串开头或结尾的空白。<br>Symbol.prototype.description： 获取 Symbol 描述。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>]];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="title function_">flat</span>());    <span class="comment">// [1, 2, 3, 4, 5]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="title function_">flatMap</span>(<span class="function"><span class="params">x</span> =&gt;</span> x * <span class="number">2</span>)); <span class="comment">// [2, 4, 6, 8, 10]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> entries = [[<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>], [<span class="string">&#x27;b&#x27;</span>, <span class="number">2</span>]];</span><br><span class="line"><span class="keyword">const</span> obj = <span class="title class_">Object</span>.<span class="title function_">fromEntries</span>(entries);<span class="comment">//entries条目</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj); <span class="comment">// &#123; a: 1, b: 2 &#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="ES2020-ES11"><a href="#ES2020-ES11" class="headerlink" title="ES2020 (ES11)"></a>ES2020 (ES11)</h3><p>动态导入（Dynamic Import）：允许在代码中动态加载模块。</p>
<p>Promise.allSettled()： 等待所有 Promise 都解决（无论是成功还是失败）。<br>globalThis： 提供标准化方式访问全局对象（在浏览器中是 window，在 Node.js 中是 global 等）。</p>
<p>String.prototype.matchAll() 方法：返回一个迭代器，包含所有匹配正则表达式的结果，适用于全局搜索。</p>
<p>BigInt： 新原始数据类型，支持任意精度整数，解决 Number 类型在大整数时的精度限制。<br>可选链运算符 (?.)： 安全地访问可能为 null 或 undefined 的对象属性或方法，避免运行时错误。<br>空值合并运算符 (??)： 只有当左侧操作数为 null 或 undefined 时才返回右侧操作数。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>(<span class="string">&#x27;./module.js&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">module</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 使用动态导入的模块</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">import</span>(<span class="string">&#x27;./module.js&#x27;</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params"><span class="variable language_">module</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 使用加载的模块</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 处理加载错误</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> promises = [</span><br><span class="line"> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="number">1</span>),</span><br><span class="line"> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="string">&#x27;Error&#x27;</span>),</span><br><span class="line"> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="number">3</span>),</span><br><span class="line">];</span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">allSettled</span>(promises).<span class="title function_">then</span>(<span class="function">(<span class="params">results</span>) =&gt;</span></span><br><span class="line"> results.<span class="title function_">forEach</span>(<span class="function">(<span class="params">result</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(result.<span class="property">status</span>))</span><br><span class="line">);</span><br><span class="line"><span class="comment">// 输出:</span></span><br><span class="line"><span class="comment">// &quot;fulfilled&quot;</span></span><br><span class="line"><span class="comment">// &quot;rejected&quot;</span></span><br><span class="line"><span class="comment">// &quot;fulfilled&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(globalThis); <span class="comment">// 在浏览器中相当于 window，在Node.js中相当于 global</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> regex = <span class="regexp">/\d+/g</span>;</span><br><span class="line"><span class="keyword">const</span> str = <span class="string">&#x27;2025年，JavaScript迎来了新的特性。&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> matches = str.<span class="title function_">matchAll</span>(regex);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">[</span></span><br><span class="line"><span class="comment">  [</span></span><br><span class="line"><span class="comment">    &quot;2025&quot;,</span></span><br><span class="line"><span class="comment">    index: 0,</span></span><br><span class="line"><span class="comment">    input: &quot;2025年，JavaScript迎来了新的特性。&quot;,</span></span><br><span class="line"><span class="comment">    groups: undefined</span></span><br><span class="line"><span class="comment">  ]</span></span><br><span class="line"><span class="comment">]</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> match <span class="keyword">of</span> matches) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(match[<span class="number">0</span>]); <span class="comment">// 输出: &#x27;2025&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> bigIntNumber = <span class="number">1234567890123456789012345678901234567890n</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(bigIntNumber + <span class="number">1n</span>); <span class="comment">// 1234567890123456789012345678901234567891n</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">a</span>: &#123; <span class="attr">b</span>: &#123; <span class="attr">c</span>: <span class="number">1</span> &#125; &#125; &#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">a</span>?.<span class="property">b</span>?.<span class="property">c</span>); <span class="comment">// 1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">a</span>?.<span class="property">b</span>?.<span class="property">d</span>); <span class="comment">// undefined</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> value = <span class="literal">null</span> ?? <span class="string">&#x27;default&#x27;</span>; <span class="comment">// &#x27;default&#x27;</span></span><br><span class="line"><span class="keyword">const</span> anotherValue = <span class="number">0</span> ?? <span class="number">42</span>;    <span class="comment">// 0</span></span><br></pre></td></tr></table></figure>

<h3 id="ES2021-ES12"><a href="#ES2021-ES12" class="headerlink" title="ES2021  (ES12)"></a><strong>ES2021  (ES12)</strong></h3><ul>
<li>逻辑赋值运算符 ( <code>&amp;&amp;=</code> , <code>||=</code> , <code>??=</code> )</li>
<li>String.prototype.replaceAll()： 替换字符串中所有匹配的子串，而无需使用正则表达式。</li>
<li>数字分隔符 (Numeric Separators)： 允许在数字字面量中使用下划线 _ 作为分隔符，提高数字的可读性（如 1_000_000）。会被 JavaScript 引擎直接忽略，不会改变数字的实际值。</li>
<li>Promise.any()： 返回第一个成功的 Promise 的值。如果所有 Promise 都被拒绝，则返回一个聚合错误。<strong>多个失败的 Promise 一起被打包成一个错误对象</strong>。</li>
<li>私有类方法和访问器：使用 # 定义类的私有方法和访问器，限制其访问范围。</li>
<li>WeakRef 和 FinalizationRegistry：提供对对象的弱引用，以及在对象被垃圾回收时执行回调的能力，主要用于高级内存管理。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> budget = <span class="number">1_000_000</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(budget); <span class="comment">// 输出: 1000000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> str = <span class="string">&#x27;apple orange apple&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> newStr = str.<span class="title function_">replaceAll</span>(<span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;banana&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(newStr); <span class="comment">// 输出: &#x27;banana orange banana&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> promises = [</span><br><span class="line">  <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="string">&#x27;Error&#x27;</span>),</span><br><span class="line">  <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="number">2</span>),</span><br><span class="line">  <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="number">3</span>),</span><br><span class="line">];</span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">any</span>(promises).<span class="title function_">then</span>(<span class="function">(<span class="params">value</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(value)); <span class="comment">// 输出: 2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  #name = <span class="string">&#x27;Alice&#x27;</span>;</span><br><span class="line">  #<span class="title function_">getName</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.#name;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">getNamePublic</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.#<span class="title function_">getName</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> person = <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="title function_">getNamePublic</span>()); <span class="comment">// 输出: &#x27;Alice&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> weakRef = <span class="keyword">new</span> <span class="title class_">WeakRef</span>(obj);</span><br><span class="line"><span class="keyword">const</span> registry = <span class="keyword">new</span> <span class="title class_">FinalizationRegistry</span>(<span class="function">(<span class="params">heldValue</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;heldValue&#125;</span> 已被垃圾回收`</span>);</span><br><span class="line">&#125;);</span><br><span class="line">registry.<span class="title function_">register</span>(obj, <span class="string">&#x27;obj&#x27;</span>);</span><br><span class="line">obj = <span class="literal">null</span>; <span class="comment">// 解除对 obj 的引用，允许垃圾回收</span></span><br><span class="line"><span class="comment">// 当垃圾回收发生时，控制台将输出: &quot;obj 已被垃圾回收&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="ES2022-ES13"><a href="#ES2022-ES13" class="headerlink" title="ES2022  (ES13)"></a>ES2022  (ES13)</h3><p><strong><code>at()</code> 方法</strong> (不是运算符，而是索引操作)允许使用负数索引访问元素。Array.prototype.at() &#x2F; String.prototype.at()</p>
<p>顶层 await (Top-level await)： 在 ES 模块的顶层使用 await 关键字，无需包裹在 async 函数中。</p>
<p>类字段 (Class Fields) (public&#x2F;private)： 允许在类中直接定义公共和私有实例字段（默认公共，#私有）。类静态块（Class Static Block）、静态类字段和静态私有方法：允许在类中定义静态字段和静态私有方法(static关键字)。</p>
<p>正则匹配索引 (RegExp Match Indices)： 添加 d 标志，获取匹配结果中捕获组的起始和结束索引。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// module.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> data = <span class="keyword">await</span> <span class="title function_">fetchData</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> regex = <span class="regexp">/world/</span>d;</span><br><span class="line"><span class="keyword">const</span> str = <span class="string">&#x27;hello world&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> match = str.<span class="title function_">match</span>(regex);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(match.<span class="property">indices</span>[<span class="number">0</span>]); <span class="comment">// 输出: [6, 11]</span></span><br></pre></td></tr></table></figure>

<h3 id="ES2023-ES14"><a href="#ES2023-ES14" class="headerlink" title="ES2023 (ES14)"></a>ES2023 (ES14)</h3><p>Array.prototype.toReversed() &#x2F; toSorted() &#x2F; toSpliced() &#x2F; with()： 非破坏性方法，返回新数组，不修改原数组。<br>Hashbang 语法 (Shebang)： 允许 JavaScript 文件以 #! 开头指定脚本解释器路径，方便在类 Unix 系统中作为可执行脚本运行。<br>WeakMap 和 WeakSet 支持 Symbol 作为键： 增强弱引用集合灵活性。</p>
<p>findLast() 和 findLastIndex() ：数组和 TypedArray 上新增 findLast() 和 findLastIndex() 方法，用于从数组末尾开始查找满足条件的元素或其索引。找到符合条件的元素<strong>立刻停止遍历并返回结果</strong>，不继续查完整个数组。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env node</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Hello, world!&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> sym = <span class="title class_">Symbol</span>(<span class="string">&#x27;key&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> weakMap = <span class="keyword">new</span> <span class="title class_">WeakMap</span>();</span><br><span class="line">weakMap.<span class="title function_">set</span>(sym, <span class="string">&#x27;value&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> array = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"><span class="keyword">const</span> found = array.<span class="title function_">findLast</span>(<span class="function">(<span class="params">x</span>) =&gt;</span> x % <span class="number">2</span> === <span class="number">0</span>);<span class="comment">//后面是条件</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(found); <span class="comment">// 输出: 4</span></span><br></pre></td></tr></table></figure>

<h3 id="ES2024-（ES15）"><a href="#ES2024-（ES15）" class="headerlink" title="ES2024 （ES15）"></a>ES2024 （ES15）</h3><ol>
<li>集合操作方法（Set Operations）：​在 Set.prototype 上新增了多个集合操作方法，如交集、并集和差集，方便对集合进行操作。​</li>
<li>正则表达式的 v 标志（RegExp v Flag）：​引入了新的 v 标志，增强了正则表达式的功能，支持集合表示法和字符串属性等特性，提供了更强大的模式匹配能力。​</li>
<li>Promise.withResolvers 方法：提供简洁方式获取 Promise 的 resolve 和 reject 函数，无需在构造函数中手动赋值，简化 Promise 的创建和控制。</li>
<li>Object.groupBy 和 Map.groupBy 方法：引入 Object.groupBy() 和 Map.groupBy() 静态方法，用于根据回调函数返回值对可迭代对象分组，返回一个对象或 Map，键是回调函数的返回值，值是具有相同键的元素数组。</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve, reject, promise &#125; = <span class="title class_">Promise</span>.<span class="title function_">withResolvers</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> array = [</span><br><span class="line">  &#123; <span class="attr">year</span>: <span class="string">&#x27;2024&#x27;</span>, <span class="attr">id</span>: <span class="number">0</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">year</span>: <span class="string">&#x27;2023&#x27;</span>, <span class="attr">id</span>: <span class="number">1</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">year</span>: <span class="string">&#x27;2024&#x27;</span>, <span class="attr">id</span>: <span class="number">2</span> &#125;,</span><br><span class="line">];</span><br><span class="line"><span class="keyword">const</span> grouped = <span class="title class_">Object</span>.<span class="title function_">groupBy</span>(array, <span class="function">(<span class="params">el</span>) =&gt;</span> el.<span class="property">year</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(grouped);</span><br><span class="line"><span class="comment">// 输出:</span></span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//   &#x27;2024&#x27;: [&#123; year: &#x27;2024&#x27;, id: 0 &#125;, &#123; year: &#x27;2024&#x27;, id: 2 &#125;],</span></span><br><span class="line"><span class="comment">//   &#x27;2023&#x27;: [&#123; year: &#x27;2023&#x27;, id: 1 &#125;]</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="异常处理与工具函数"><a href="#异常处理与工具函数" class="headerlink" title="异常处理与工具函数"></a>异常处理与工具函数</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    tryCode - 尝试执行代码块</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(err) &#123;</span><br><span class="line">    catchCode - 捕获错误的代码块</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">finally</span> &#123;</span><br><span class="line">    finallyCode - 无论 <span class="keyword">try</span> / <span class="keyword">catch</span> 结果如何都会执行的代码块</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getRectArea</span>(<span class="params">width, height</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">isNaN</span>(width) || <span class="built_in">isNaN</span>(height)) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="string">&quot;Parameter is not a number!&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="title function_">getRectArea</span>(<span class="number">3</span>, <span class="string">&#x27;A&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(e) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(e);</span><br><span class="line">  <span class="comment">// expected output: &quot;Parameter is not a number!&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>throw<br><code>throw</code> 抛出异常信息，后面跟的是错误提示信息<br> <code>Error</code> 对象配合 <code>throw</code> 使用，能够设置更详细的错误信息<br>当前函数执行停止（throw之后的语句将不会执行），并且控制将被传递到调用堆栈中的第一个catch块。如果调用者函数中没有catch块，程序将会终止。</li>
</ol>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">counter</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span>(!x || !y) &#123;</span><br><span class="line">    <span class="comment">// throw &#x27;参数不能为空!&#x27;;</span></span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;参数不能为空!&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">counter</span>();</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>try…catch<br><code>try...catch</code> 用于捕获错误信息<br> 将预估可能发生错误的代码写在 <code>try</code> 代码段中<br> 如果 <code>try</code> 代码段中出现错误后，会执行 <code>catch</code> 代码段，并截获到错误信息</li>
</ol>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 查找 DOM 节点</span></span><br><span class="line">    <span class="keyword">var</span> p = docunent.<span class="title function_">querySelector</span>(<span class="string">&#x27;p&#x27;</span>);</span><br><span class="line">  &#125; <span class="keyword">catch</span>(error) &#123;</span><br><span class="line">    <span class="comment">// try 代码段中执行有错误时，会执行 catch 代码段</span></span><br><span class="line">    <span class="comment">// 查看错误信息</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(error.<span class="property">message</span>);</span><br><span class="line">    <span class="comment">// 终止代码继续执行</span></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 改变文本样式</span></span><br><span class="line">  p.<span class="property">style</span>.<span class="property">color</span> = <span class="string">&#x27;red&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">foo</span>();</span><br></pre></td></tr></table></figure>

<ul>
<li>自定义错误<br>&#x3D;&#x3D;待更新&#x3D;&#x3D;</li>
</ul>
<h1 id="移动端"><a href="#移动端" class="headerlink" title="移动端"></a>移动端</h1><ul>
<li>触屏事件概述<br>在移动端，touch事件比鼠标事件执行效率高<br>移动端浏览器兼容性较好，我们不需要考虑以前 JS 的兼容性问题，可以放心的使用原生 JS 书写效果，但是移动端也有自己独特的地方。比如触屏事件 touch（也称触摸事件），Android 和 IOS 都有。<br>touch 对象代表一个触摸点。触摸点可能是一根手指，也可能是一根触摸笔。触屏事件可响应用户手指（或触控笔）对屏幕或者触控板操作。<br><img src="/images/JS%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0.assets/16e0352307a44fa78a12420d43782853.png" alt="在这里插入图片描述"><br>如果移动距离小于 某个像素 就回弹原来位置<br>如果移动距离大于某个像素就上一张下一张滑动。<br>滑动也分为左滑动和右滑动 判断的标准是 移动距离正负 如果是负值就是左滑 反之右滑</li>
<li>触摸事件对象（TouchEvent）<br>TouchEvent 是一类描述手指在触摸平面（触摸屏、触摸板等）的状态变化的事件。这类事件用于描述一个或多个触点，使开发者可以检测触点的移动，触点的增加和减少，等等<br>touchstart、touchmove、touchend 三个事件都会各自有事件对象。<br>触摸事件对象重点我们看三个常见对象列表：<br>targetTouches属性和touches在手指按下和移动中都可以获取手指列表<br><img src="/images/JS%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0.assets/b4df40a74e1a46829f4f548d4a214a32.png" alt="在这里插入图片描述"><br>因为平时我们都是给元素注册触摸事件，所以重点记住 targetTouches</li>
<li>移动端拖动元素</li>
</ul>
<ol>
<li>touchstart、touchmove、touchend 可以实现拖动元素</li>
<li>但是拖动元素需要当前手指的坐标值 我们可以使用 targetTouches[0] 里面的pageX 和 pageY </li>
<li>移动端拖动的原理： 手指移动中，计算出手指移动的距离。然后用盒子原来的位置 + 手指移动的距离</li>
<li>手指移动的距离： 手指滑动中的位置 减去 手指刚开始触摸的位置<br>拖动元素三步曲：<br>（1） 触摸元素 touchstart： 获取手指初始坐标，同时获得盒子原来的位置<br>（2） 移动手指 touchmove： 计算手指的滑动距离，并且移动盒子<br>（3） 离开手指 touchend:<br>注意： 手指移动也会触发滚动屏幕所以这里要阻止默认的屏幕滚动 e.preventDefault();</li>
</ol>
<ul>
<li>移动端常用开发插件<br>比如移动端常见插件：iScroll、Swiper、SuperSlider 。<br><a target="_blank" rel="noopener" href="https://www.swiper.com.cn/">https://www.swiper.com.cn/</a><br>superslide： <a target="_blank" rel="noopener" href="http://www.superslide2.com/">http://www.superslide2.com/</a><br>iscroll： <a target="_blank" rel="noopener" href="https://github.com/cubiq/iscrol">https://github.com/cubiq/iscrol</a><br>移动端视频插件 zy.media.js<br>H5 给我们提供了 video 标签，但是浏览器的支持情况不同。在移动端我们可以使用插件方式来制作。</li>
<li>click 延时解决方案<br>移动端 click 事件会有 300ms 的延时，原因是移动端屏幕双击会缩放(double tap to zoom) 页面。<br>fastclick 插件解决 300ms 延迟。 使用延时<br>GitHub官网地址： <a target="_blank" rel="noopener" href="https://github.com/ftlabs/fastclick">https://github.com/ftlabs/fastclick</a></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//解决方案</span></span><br><span class="line"><span class="comment">//1 禁用缩放，浏览器禁用默认的双击缩放行为并且去掉 300ms 的点击延迟。</span></span><br><span class="line">&lt;meta name=<span class="string">&quot;viewport&quot;</span> content=<span class="string">&quot;user-scalable=no&quot;</span>&gt;</span><br><span class="line"><span class="comment">//2 使用插件。 fastclick 插件解决 300ms 延迟。</span></span><br><span class="line"><span class="keyword">if</span> (<span class="string">&#x27;addEventListener&#x27;</span> <span class="keyword">in</span> <span class="variable language_">document</span>) &#123;</span><br><span class="line"> <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="title class_">FastClick</span>.<span class="title function_">attach</span>(<span class="variable language_">document</span>.<span class="property">body</span>);<span class="comment">/*等页面文档加载完成 不需要等所有的资源*/</span></span><br><span class="line"> &#125;, <span class="literal">false</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//3 利用touch事件自己封装这个事件解决 300ms 延迟。</span></span><br><span class="line"><span class="comment">//如果离开屏幕到触摸屏幕时间差值小于150ms，并且没有滑动过屏幕，那么我们就定义为点击</span></span><br><span class="line"><span class="comment">//封装tap，解决click 300ms 延时</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">tap</span> (<span class="params">obj, callback</span>) &#123;</span><br><span class="line"> <span class="keyword">var</span> isMove = <span class="literal">false</span>;</span><br><span class="line"> <span class="keyword">var</span> startTime = <span class="number">0</span>; <span class="comment">// 记录触摸时候的时间变量</span></span><br><span class="line"> obj.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line"> startTime = <span class="title class_">Date</span>.<span class="title function_">now</span>(); <span class="comment">// 记录触摸时间</span></span><br><span class="line"> &#125;);</span><br><span class="line"> obj.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchmove&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line"> isMove = <span class="literal">true</span>; <span class="comment">// 看看是否有滑动，有滑动算拖拽，不算点击</span></span><br><span class="line"> &#125;);</span><br><span class="line"> obj.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchend&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line"> <span class="keyword">if</span> (!isMove &amp;&amp; (<span class="title class_">Date</span>.<span class="title function_">now</span>() - startTime) &lt; <span class="number">150</span>) &#123; <span class="comment">// 如果手指触摸和离开时间小于150ms 算点击</span></span><br><span class="line"> callback &amp;&amp; <span class="title function_">callback</span>(); <span class="comment">// 执行回调函数</span></span><br><span class="line"> &#125;</span><br><span class="line"> isMove = <span class="literal">false</span>; <span class="comment">// 取反 重置</span></span><br><span class="line"> startTime = <span class="number">0</span>;</span><br><span class="line"> &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//调用 </span></span><br><span class="line"> <span class="title function_">tap</span>(div, <span class="keyword">function</span>(<span class="params"></span>)&#123; <span class="comment">// 执行代码 &#125;);</span></span><br></pre></td></tr></table></figure>

<ul>
<li>淘宝 flexible.js 源码分析<br>立即执行函数 (function(){})()  或者 (function(){}())<br>主要作用： 创建一个独立的作用域。 避免了命名冲突问题<br>下面三种情况都会刷新页面都会触发 load 事件。<br>1.a标签的超链接<br>2.F5或者刷新按钮（强制刷新）<br>3.前进后退按钮<br>但是 火狐中，有个特点，有个“往返缓存”，这个缓存中不仅保存着页面数据，还保存了DOM和JavaScript的状态；实际上是将整个页面都保存在了内存里。<br>所以此时后退按钮不能刷新页面。<br>此时可以使用 pageshow事件来触发。这个事件在页面显示时触发，无论页面是否来自缓存。在重新加载页面中，pageshow会在load事件触发后触发；根据事件对象中的persisted来判断是否是缓存中的页面触发的pageshow事件&#96;注意这个事件给window添加。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;pageshow&#x27;</span>, <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (event.<span class="property">persisted</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;页面来自缓存&#x27;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;页面是重新加载的&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span> <span class="title function_">flexible</span>(<span class="params"><span class="variable language_">window</span>, <span class="variable language_">document</span></span>) &#123;</span><br><span class="line">    <span class="comment">// 获取的html 的根元素</span></span><br><span class="line">    <span class="keyword">var</span> docEl = <span class="variable language_">document</span>.<span class="property">documentElement</span></span><br><span class="line">        <span class="comment">// dpr 物理像素比</span></span><br><span class="line">    <span class="keyword">var</span> dpr = <span class="variable language_">window</span>.<span class="property">devicePixelRatio</span> || <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// adjust body font size  设置我们body 的字体大小</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">setBodyFontSize</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 如果页面中有body 这个元素 就设置body的字体大小</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">body</span>) &#123;</span><br><span class="line">            <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">fontSize</span> = (<span class="number">12</span> * dpr) + <span class="string">&#x27;px&#x27;</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 如果页面中没有body 这个元素，则等着 我们页面主要的DOM元素加载完毕再去设置body</span></span><br><span class="line">            <span class="comment">// 的字体大小</span></span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, setBodyFontSize)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">setBodyFontSize</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// set 1rem = viewWidth / 10    设置我们html 元素的文字大小</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">setRemUnit</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> rem = docEl.<span class="property">clientWidth</span> / <span class="number">10</span></span><br><span class="line">        docEl.<span class="property">style</span>.<span class="property">fontSize</span> = rem + <span class="string">&#x27;px&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">setRemUnit</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// reset rem unit on page resize  当我们页面尺寸大小发生变化的时候，要重新设置下rem 的大小</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, setRemUnit)</span><br><span class="line">        <span class="comment">// pageshow 是我们重新加载页面触发的事件</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;pageshow&#x27;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="comment">// e.persisted 返回的是true 就是说如果这个页面是从缓存取过来的页面，也需要从新计算一下rem 的大小</span></span><br><span class="line">        <span class="keyword">if</span> (e.<span class="property">persisted</span>) &#123;</span><br><span class="line">            <span class="title function_">setRemUnit</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// detect 0.5px supports  有些移动端的浏览器不支持0.5像素的写法</span></span><br><span class="line">    <span class="keyword">if</span> (dpr &gt;= <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> fakeBody = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;body&#x27;</span>)</span><br><span class="line">        <span class="keyword">var</span> testElement = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">        testElement.<span class="property">style</span>.<span class="property">border</span> = <span class="string">&#x27;.5px solid transparent&#x27;</span></span><br><span class="line">        fakeBody.<span class="title function_">appendChild</span>(testElement)</span><br><span class="line">        docEl.<span class="title function_">appendChild</span>(fakeBody)</span><br><span class="line">        <span class="keyword">if</span> (testElement.<span class="property">offsetHeight</span> === <span class="number">1</span>) &#123;</span><br><span class="line">            docEl.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;hairlines&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        docEl.<span class="title function_">removeChild</span>(fakeBody)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;(<span class="variable language_">window</span>, <span class="variable language_">document</span>))</span><br></pre></td></tr></table></figure>

<h1 id="includes-v-s-in"><a href="#includes-v-s-in" class="headerlink" title="includes v.s. in"></a>includes v.s. in</h1><ul>
<li>includes() 用于检查集合（或字符串）中是否包含特定元素。在以下几种内置类型上都有定义：<br>Array.prototype.includes() (数组类型)<br>String.prototype.includes() (字符串类型)<br>TypedArray.prototype.includes() (类型化数组，例如 Int8Array, Uint8Array 等)</li>
<li>in 运算符:判断对象是否包含某个属性（对象自身的属性+继承来的属性）。<ul>
<li>与 hasOwnProperty() 的区别<br>in 运算符会检查对象自身及其原型链上是否存在某个属性。<br>而 Object.prototype.hasOwnProperty() 方法只检查对象自身是否拥有某个属性，不包括原型链上的属性。</li>
</ul>
</li>
</ul>
<h1 id="面向对象编程"><a href="#面向对象编程" class="headerlink" title="面向对象编程"></a>面向对象编程</h1><ul>
<li>面向过程v.s. 面向对象<br>面向过程的唯一优点是性能高，一般在单片机中使用。<br>面向对象的优点：封装、继承、多态，易维护、易复用、易扩展，便于设计出低耦合的系统。</li>
<li>基本概念：类、实例；扩展：原型&amp;原型链、构造函数</li>
</ul>
<p>实例成员就是构造函数内部通过this添加的成员，实例成员只能通过实例化的对象来访问。静态成员是在构造函数本身上添加的成员，静态成员只能通过构造函数来访问。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">function</span> <span class="title function_">Star</span>(<span class="params">uname, age</span>) &#123;</span><br><span class="line">     <span class="variable language_">this</span>.<span class="property">uname</span> = uname;</span><br><span class="line">     <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">     <span class="variable language_">this</span>.<span class="property">sing</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;我会唱歌&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> ldh = <span class="keyword">new</span> <span class="title class_">Star</span>(<span class="string">&#x27;刘德华&#x27;</span>, <span class="number">18</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ldh.<span class="property">uname</span>);<span class="comment">//实例成员只能通过实例化的对象来访问</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Star</span>.<span class="property">sex</span> = <span class="string">&#x27;男&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> ldh = <span class="keyword">new</span> <span class="title class_">Star</span>(<span class="string">&#x27;刘德华&#x27;</span>, <span class="number">18</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Star</span>.<span class="property">sex</span>);<span class="comment">//静态成员只能通过构造函数来访问</span></span><br></pre></td></tr></table></figure>

<p>constructor构造函数：构造函数首字母要大写。用new调用的函数就是构造函数，用于实例化，没有参数时可以省略new x(这个括号)，返回值为新创建的对象，构造函数内部的return返回值无效。</p>
<p>new 在执行时会做四件事情：① 在内存中创建一个新的空对象。② 让 this 指向这个新的对象。③ 执行构造函数里面的代码，给这个新对象添加属性和方法。④ 返回这个新对象（所以构造函数里面不需要 return ）。<br>如果修改原来的原型对象,给原型对象赋值一个对象,则必须手动将constructor指回原来的构造函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">function</span> <span class="title function_">Star</span>(<span class="params">uname, age</span>) &#123;</span><br><span class="line">     <span class="variable language_">this</span>.<span class="property">uname</span> = uname;</span><br><span class="line">     <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="title class_">Star</span>.<span class="property"><span class="keyword">prototype</span></span> = &#123;</span><br><span class="line"> <span class="comment">// 如果我们修改原来的原型对象,给原型对象赋值的是一个对象,则必须手动constructor指回原来的构造函数</span></span><br><span class="line">   <span class="attr">constructor</span>: <span class="title class_">Star</span>, </span><br><span class="line">   <span class="attr">sing</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;我会唱歌&#x27;</span>);</span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="attr">movie</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;我会演电影&#x27;</span>);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> zxy = <span class="keyword">new</span> <span class="title class_">Star</span>(<span class="string">&#x27;张学友&#x27;</span>, <span class="number">19</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(zxy)</span><br></pre></td></tr></table></figure>

<ul>
<li>实现</li>
</ul>
<ol>
<li>早期基于构造函数和原型（prototype）实现面向对象编程。</li>
</ol>
<p><strong>对象字面量 (<code>&#123;&#125;</code>)</strong> 本身没有 <code>prototype</code> 属性，只有 <strong>函数（构造函数）</strong> 才有 <code>prototype</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//构造函数创建对象</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Star</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line"> &#125;</span><br><span class="line"><span class="keyword">var</span> ldh = <span class="keyword">new</span> <span class="title class_">Star</span>(<span class="string">&#x27;刘德华&#x27;</span>, <span class="number">18</span>)<span class="comment">//实例化对象</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ldh);</span><br><span class="line"></span><br><span class="line"><span class="comment">//继承写法1:用对象</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">Student</span> = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Robot&#x27;</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">1.2</span>,</span><br><span class="line">    <span class="attr">run</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span> + <span class="string">&#x27; is running...&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> xiaoming = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="title class_">Student</span>); <span class="comment">// 继承 Student</span></span><br><span class="line">xiaoming.<span class="property">name</span> = <span class="string">&#x27;小明&#x27;</span>;</span><br><span class="line">xiaoming.<span class="title function_">run</span>(); <span class="comment">// 小明 is running...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//继承写法2:用函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Student</span>(<span class="params">name, height</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">height</span> = height;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Student</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">run</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span> + <span class="string">&#x27; is running...&#x27;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">XiaoMing</span>(<span class="params">name, height</span>) &#123;</span><br><span class="line">    <span class="title class_">Student</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>, name, height); <span class="comment">// 调用父构造函数</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 继承父类原型</span></span><br><span class="line"><span class="title class_">XiaoMing</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="title class_">Student</span>.<span class="property"><span class="keyword">prototype</span></span>);<span class="comment">//或者new Student();</span></span><br><span class="line"><span class="title class_">XiaoMing</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> = <span class="title class_">XiaoMing</span>;</span><br><span class="line"><span class="keyword">var</span> xm = <span class="keyword">new</span> <span class="title class_">XiaoMing</span>(<span class="string">&#x27;小明&#x27;</span>, <span class="number">1.7</span>);</span><br><span class="line">xm.<span class="title function_">run</span>(); <span class="comment">// 小明 is running...</span></span><br></pre></td></tr></table></figure>

<p>不要直接用<code>obj.__proto__</code>改变对象的原型，并且，低版本的IE也无法使用<code>__proto__</code>。Object.create()方法可以传入一个原型对象，并创建一个基于该原型的新对象。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">createStudent</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="comment">// 基于Student原型创建一个新对象:</span></span><br><span class="line">    <span class="keyword">var</span> s = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="title class_">Student</span>);</span><br><span class="line">    <span class="comment">// 初始化新对象:</span></span><br><span class="line">    s.<span class="property">name</span> = name;</span><br><span class="line">    <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> xiaoming = <span class="title function_">createStudent</span>(<span class="string">&#x27;小明&#x27;</span>);</span><br><span class="line">xiaoming.<span class="title function_">run</span>(); <span class="comment">// 小明 is running...</span></span><br><span class="line">xiaoming.<span class="property">__proto__</span> === <span class="title class_">Student</span>; <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> xiaoming = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1990</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> y = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getFullYear</span>();</span><br><span class="line">        <span class="keyword">return</span> y - <span class="variable language_">this</span>.<span class="property">birth</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">xiaoming.<span class="property">age</span>; <span class="comment">// function xiaoming.age()</span></span><br><span class="line">xiaoming.<span class="title function_">age</span>(); <span class="comment">// 今年调用是25,明年调用就变成26了</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//拆开写也可以</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getAge</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> y = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getFullYear</span>();</span><br><span class="line">    <span class="keyword">return</span> y - <span class="variable language_">this</span>.<span class="property">birth</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> xiaoming = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1990</span>,</span><br><span class="line">    <span class="attr">age</span>: getAge</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">xiaoming.<span class="title function_">age</span>(); <span class="comment">// 25, 正常结果</span></span><br><span class="line"><span class="title function_">getAge</span>(); <span class="comment">// NaN</span></span><br><span class="line">getAge.<span class="title function_">apply</span>(xiaoming, []); <span class="comment">// 25, this指向xiaoming, 参数为空</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>ES6引入class<br>类名常规首字母大写。<br>创建类 类名后面不要加小括号<br>constructor 函数 只要 new 生成实例时,就会自动调用这个函数, 如果我们不写这个函数,类也会自动生成这个函数，构造函数不需要加function<br>多个函数方法之间不需要添加逗号分隔</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//类中封装的并不是变量和函数，因此不能使用关键字let、const、var</span></span><br><span class="line"><span class="comment">// 1. 创建类 class  创建一个 明星类</span></span><br><span class="line"> <span class="keyword">class</span> <span class="title class_">Star</span> &#123;</span><br><span class="line">   <span class="comment">// 类的共有属性放到 constructor 里面，返回实例对象</span></span><br><span class="line">   <span class="title function_">constructor</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">	   <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">	   <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="comment">//static 静态属性或方法</span></span><br><span class="line">   </span><br><span class="line">   <span class="comment">//注意方法与方法之间不需要添加逗号</span></span><br><span class="line">    <span class="title function_">sing</span>(<span class="params">song</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">uname</span> + <span class="string">&#x27;唱&#x27;</span> + song);</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line">   <span class="comment">// 2. 利用类创建对象 new</span></span><br><span class="line">   <span class="keyword">var</span> ldh = <span class="keyword">new</span> <span class="title class_">Star</span>(<span class="string">&#x27;刘德华&#x27;</span>, <span class="number">18</span>);</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(ldh);</span><br></pre></td></tr></table></figure>

<ul>
<li>继承</li>
</ul>
<ol>
<li>继承中,如果实例化子类输出一个方法,先看子类有没有这个方法,如果有就先执行子类的.如果子类里面没有,就去查找父类有没有这个方法,如果有,就执行父类的这个方法(就近原则)</li>
<li>如果子类想要继承父类的方法,同时在自己内部扩展自己的方法,利用super 调用父类的构造函数,super 必须在子类this之前调用</li>
<li>时刻注意this的指向问题,类里面的共有的属性和方法一定要加this。constructor中的this指向的是new出来的实例对象 ,绑定事件之后this指向的就是触发事件的事件源</li>
<li>ES6 之前的代码中，开发者常用 that 作为一个变量名，用来保存 this 的引用，特别在 回调函数 或 闭包 中，避免 this 绑定丢失。</li>
<li>ES6 中类没有变量提升，所以必须先定义类再使用</li>
<li>super关键字 用于访问和调用对象父类上的函数。可以调用父类的构造函数和普通函数。</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Father</span>&#123;   </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">// 子类继承父类</span></span><br><span class="line"><span class="keyword">class</span>  <span class="title class_">Son</span>  <span class="keyword">extends</span> <span class="title class_ inherited__">Father</span> &#123;  </span><br><span class="line">&#125;       </span><br><span class="line"></span><br><span class="line"><span class="comment">//子类使用super关键字访问父类的方法</span></span><br><span class="line"><span class="comment">//super 函数的作用是可以将子类实例化时获得的参数传入父类的构造函数之中。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//定义父类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Father</span> &#123;</span><br><span class="line">   <span class="title function_">constructor</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">	   <span class="variable language_">this</span>.<span class="property">x</span> = x;</span><br><span class="line">	   <span class="variable language_">this</span>.<span class="property">y</span> = y;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="title function_">sum</span>(<span class="params"></span>) &#123;</span><br><span class="line">   	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">x</span> + <span class="variable language_">this</span>.<span class="property">y</span>);</span><br><span class="line">	&#125;</span><br><span class="line"> &#125;</span><br><span class="line"><span class="comment">//子元素继承父类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Son</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Father</span> &#123;</span><br><span class="line">	<span class="title function_">constructor</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">		<span class="variable language_">super</span>(x, y); <span class="comment">//使用super调用父类的构造函数</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> son = <span class="keyword">new</span> <span class="title class_">Son</span>(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">son.<span class="title function_">sum</span>(); <span class="comment">//结果为3</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">// 父类有加法方法</span></span><br><span class="line"> <span class="keyword">class</span> <span class="title class_">Father</span> &#123;</span><br><span class="line">   <span class="title function_">constructor</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">	   <span class="variable language_">this</span>.<span class="property">x</span> = x;</span><br><span class="line">	   <span class="variable language_">this</span>.<span class="property">y</span> = y;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="title function_">sum</span>(<span class="params"></span>) &#123;</span><br><span class="line">   	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">x</span> + <span class="variable language_">this</span>.<span class="property">y</span>);</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">// 子类继承父类加法方法 同时 扩展减法方法</span></span><br><span class="line"> <span class="keyword">class</span> <span class="title class_">Son</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Father</span> &#123;</span><br><span class="line">   <span class="title function_">constructor</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">	   <span class="comment">// 利用super 调用父类的构造函数 super 必须在子类this之前调用,放到this之后会报错</span></span><br><span class="line">	   <span class="variable language_">super</span>(x, y);</span><br><span class="line">	   <span class="variable language_">this</span>.<span class="property">x</span> = x;</span><br><span class="line">	   <span class="variable language_">this</span>.<span class="property">y</span> = y;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">subtract</span>(<span class="params"></span>) &#123;</span><br><span class="line">  	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">x</span> - <span class="variable language_">this</span>.<span class="property">y</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> son = <span class="keyword">new</span> <span class="title class_">Son</span>(<span class="number">5</span>, <span class="number">3</span>);</span><br><span class="line">son.<span class="title function_">subtract</span>(); <span class="comment">//2</span></span><br><span class="line">son.<span class="title function_">sum</span>();<span class="comment">//8</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//super可以调用父类普通函数</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Father</span> &#123;</span><br><span class="line"> <span class="title function_">say</span>(<span class="params"></span>) &#123;</span><br><span class="line"> 	<span class="keyword">return</span> <span class="string">&#x27;我是爸爸&#x27;</span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Son</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Father</span> &#123; <span class="comment">// 这样子类就继承了父类的属性和方法</span></span><br><span class="line"> <span class="title function_">say</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="comment">// super.say() super 调用父类的方法</span></span><br><span class="line"> <span class="keyword">return</span> <span class="variable language_">super</span>.<span class="title function_">say</span>() + <span class="string">&#x27;的儿子&#x27;</span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> damao = <span class="keyword">new</span> <span class="title class_">Son</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(damao.<span class="title function_">say</span>());</span><br></pre></td></tr></table></figure>

<h1 id="存储-自定义属性"><a href="#存储-自定义属性" class="headerlink" title="存储-自定义属性"></a>存储-自定义属性</h1><p>自定义属性: 由程序员自己添加的属性,在DOM对象中找不到</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">getAttribute</span>(<span class="string">&#x27;属性名&#x27;</span>) <span class="comment">// 获取自定义属性</span></span><br><span class="line"><span class="title function_">setAttribute</span>(<span class="string">&#x27;属性名&#x27;</span>, <span class="string">&#x27;属性值&#x27;</span>) <span class="comment">// 设置自定义属性</span></span><br><span class="line"><span class="title function_">removeAttribute</span>(<span class="string">&#x27;属性名&#x27;</span>) <span class="comment">// 删除自定义属性</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//另一种 data-自定义属性</span></span><br><span class="line"><span class="comment">//传统的自定义属性没有专门的定义规则,开发者随意定值,不够规范</span></span><br><span class="line"><span class="comment">//在html5中推出来了专门的data-自定义属性	</span></span><br><span class="line"><span class="comment">//在标签上一律以data-开头</span></span><br><span class="line"><span class="comment">//在DOM对象上一律以dataset对象方式获取</span></span><br><span class="line">&lt;div <span class="keyword">class</span>=<span class="string">&#x27;box&#x27;</span> data-id=<span class="string">&#x27;10&#x27;</span>&gt;&lt;/div&gt;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(box.<span class="property">dataset</span>.<span class="property">id</span>)</span><br></pre></td></tr></table></figure>

<h1 id="TS大全"><a href="#TS大全" class="headerlink" title="TS大全"></a>TS大全</h1><ul>
<li><p>给变量直接赋值undefined报错，需要手动配置tslint规则<code>no-unnecessary-initializer=false</code>。当tsconfig.json的compilerOptions设置为<code>&quot;strictNullChecks&quot;:true</code>严格模式。</p>
</li>
<li><p>TS专有枚举类型：相当于起号码，默认从0开始，也可以手动赋序号</p>
</li>
</ul>
<p>枚举也可以作为类型；枚举合并，声明两个同名的则合并它们的内容；</p>
<p>作用：<strong>业务中有一组固定、有限的值</strong> 时，用 <code>enum</code> 表达会更清晰、可读性更高。</p>
<p>原理：enum是类型，编译到JS后是对象，key-value对应</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">Roles</span>&#123;</span><br><span class="line">  <span class="variable constant_">SUPER_ADMIN</span>,</span><br><span class="line">  <span class="variable constant_">ADMIN</span>,</span><br><span class="line">  <span class="variable constant_">USER</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">Roles</span>&#123;</span><br><span class="line">  <span class="variable constant_">SUPER_ADMIN</span>=<span class="number">0</span>,<span class="comment">//如果设置为1，则后面自动为2，3；不想连续也可以手动设置分开的</span></span><br><span class="line">  <span class="variable constant_">ADMIN</span>=<span class="number">1</span>,</span><br><span class="line">  <span class="variable constant_">USER</span>=<span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Roles</span>.<span class="property">SUPER_ADMIN</span>,<span class="title class_">Roles</span>[<span class="number">1</span>])<span class="comment">//0,ADMIN</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">Day</span> &#123;</span><br><span class="line">  <span class="variable constant_">SUNDAY</span> = <span class="number">0</span>,</span><br><span class="line">  <span class="variable constant_">MONDAY</span> = <span class="number">1</span>,</span><br><span class="line">  <span class="variable constant_">TUESDAY</span> = <span class="number">2</span>,</span><br><span class="line">  <span class="variable constant_">WEDNESDAY</span> = <span class="number">3</span>,</span><br><span class="line">  <span class="variable constant_">THURSDAY</span> = <span class="number">4</span>,</span><br><span class="line">  <span class="variable constant_">FRIDAY</span> = <span class="number">5</span>,</span><br><span class="line">  <span class="variable constant_">SATURDAY</span> = <span class="number">6</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//转换成JS代码</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">Day</span> = <span class="built_in">void</span> <span class="number">0</span>;<span class="comment">/*</span></span><br><span class="line"><span class="comment">void 0：</span></span><br><span class="line"><span class="comment">void 是 JavaScript 的一个运算符</span></span><br><span class="line"><span class="comment">void 表达式 → 永远返回 undefined</span></span><br><span class="line"><span class="comment">void 0、void(0)、void(anything) 都会返回 undefined</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">(<span class="keyword">function</span> (<span class="params"><span class="title class_">Day</span></span>) &#123;</span><br><span class="line">  <span class="title class_">Day</span>[<span class="title class_">Day</span>[<span class="string">&quot;SUNDAY&quot;</span>] = <span class="number">0</span>] = <span class="string">&quot;SUNDAY&quot;</span>;</span><br><span class="line">  <span class="title class_">Day</span>[<span class="title class_">Day</span>[<span class="string">&quot;MONDAY&quot;</span>] = <span class="number">1</span>] = <span class="string">&quot;MONDAY&quot;</span>;</span><br><span class="line">  <span class="title class_">Day</span>[<span class="title class_">Day</span>[<span class="string">&quot;TUESDAY&quot;</span>] = <span class="number">2</span>] = <span class="string">&quot;TUESDAY&quot;</span>;</span><br><span class="line">  <span class="title class_">Day</span>[<span class="title class_">Day</span>[<span class="string">&quot;WEDNESDAY&quot;</span>] = <span class="number">3</span>] = <span class="string">&quot;WEDNESDAY&quot;</span>;</span><br><span class="line">  <span class="title class_">Day</span>[<span class="title class_">Day</span>[<span class="string">&quot;THURSDAY&quot;</span>] = <span class="number">4</span>] = <span class="string">&quot;THURSDAY&quot;</span>;</span><br><span class="line">  <span class="title class_">Day</span>[<span class="title class_">Day</span>[<span class="string">&quot;FRIDAY&quot;</span>] = <span class="number">5</span>] = <span class="string">&quot;FRIDAY&quot;</span>;</span><br><span class="line">  <span class="title class_">Day</span>[<span class="title class_">Day</span>[<span class="string">&quot;SATURDAY&quot;</span>] = <span class="number">6</span>] = <span class="string">&quot;SATURDAY&quot;</span>;</span><br><span class="line">&#125;)(<span class="title class_">Day</span> || (<span class="title class_">Day</span> = &#123;&#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">//字符串枚举</span></span><br><span class="line"><span class="comment">// 使用字符串字面量</span></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">Message</span> &#123;</span><br><span class="line">  <span class="title class_">Error</span> = <span class="string">&quot;Sorry, error&quot;</span>,</span><br><span class="line">  <span class="title class_">Success</span> = <span class="string">&quot;Hoho, success&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Message</span>.<span class="property">Error</span>); <span class="comment">// &#x27;Sorry, error&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用枚举值中其他枚举成员</span></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">Message</span> &#123;</span><br><span class="line">  <span class="title class_">Error</span> = <span class="string">&quot;error message&quot;</span>,</span><br><span class="line">  <span class="title class_">ServerError</span> = <span class="title class_">Error</span>,</span><br><span class="line">  <span class="title class_">ClientError</span> = <span class="title class_">Error</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Message</span>.<span class="property">Error</span>); <span class="comment">// &#x27;error message&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Message</span>.<span class="property">ServerError</span>); <span class="comment">// &#x27;error message&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//反向映射</span></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">Status</span> &#123;</span><br><span class="line">  <span class="title class_">Success</span> = <span class="number">200</span>,</span><br><span class="line">  <span class="title class_">NotFound</span> = <span class="number">404</span>,</span><br><span class="line">  <span class="title class_">Error</span> = <span class="number">500</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Status</span>[<span class="string">&quot;Success&quot;</span>]); <span class="comment">// 200</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Status</span>[<span class="number">200</span>]); <span class="comment">// &#x27;Success&#x27; 反过来只支持数字枚举</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Status</span>[<span class="title class_">Status</span>[<span class="string">&quot;Success&quot;</span>]]); <span class="comment">// &#x27;Success&#x27;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>实用程序</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">UpperCase</span>&lt;stringType&gt;</span><br><span class="line"><span class="title class_">Lowercase</span>&lt;stringType&gt;</span><br><span class="line"><span class="title class_">Capitalize</span>&lt;stringType&gt;</span><br><span class="line"><span class="title class_">Uncapitalize</span>&lt;stringType&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>结合模版字符串</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Message</span> &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">url</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">SuccessMessage</span> <span class="keyword">extends</span> <span class="title class_">Message</span> &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">`<span class="subst">$&#123;<span class="built_in">string</span>&#125;</span>Success`</span>;<span class="comment">//&quot;HttpSuccess&quot;是符合的</span></span><br><span class="line">    <span class="attr">body</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ErrorMessage</span> <span class="keyword">extends</span> <span class="title class_">Message</span> &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">`<span class="subst">$&#123;<span class="built_in">string</span>&#125;</span>Error`</span>;</span><br><span class="line">    <span class="attr">message</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handler</span>(<span class="params"><span class="attr">r</span>: <span class="title class_">SuccessMessage</span> | <span class="title class_">ErrorMessage</span></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (r.<span class="property">type</span> === <span class="string">&quot;HttpSuccess&quot;</span>) &#123; </span><br><span class="line">        <span class="keyword">let</span> token = r.<span class="property">body</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>交叉类型：局部场景才有意义，如多个接口合并为一个；合并多个联合类型；</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Person</span> = &#123;</span><br><span class="line">	<span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125; &amp; &#123;</span><br><span class="line">	<span class="attr">height</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">weight</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125; &amp; &#123;</span><br><span class="line">	<span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">person</span>: <span class="title class_">Person</span> = &#123;</span><br><span class="line">	<span class="attr">name</span>: <span class="string">&quot;zhangsan&quot;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">  <span class="attr">height</span>: <span class="number">180</span>,</span><br><span class="line">  <span class="attr">weight</span>: <span class="number">60</span>,</span><br><span class="line">  <span class="attr">id</span>: <span class="number">123456</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//共有的age:number&amp;string=never </span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Person</span> = &#123;</span><br><span class="line">	<span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125; &amp; &#123;</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">string</span>;</span><br><span class="line">	<span class="attr">height</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">weight</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Never v.s. void</li>
</ul>
<p>不返回任何内容的void函数实际上返回的是undefined，void的值可以是undefined&#x2F;null</p>
<p>类型守卫&#x2F;缩小之外的类型成为never</p>
<ul>
<li>TS调试</li>
</ul>
<p>debugger里创建一个launch.json，文件中添加preLaunchTask</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// Use IntelliSense to learn about possible attributes.</span></span><br><span class="line">  <span class="comment">// Hover to view descriptions of existing attributes.</span></span><br><span class="line">  <span class="comment">// For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387</span></span><br><span class="line">  <span class="string">&quot;version&quot;</span>: <span class="string">&quot;0.2.0&quot;</span>,</span><br><span class="line">  <span class="string">&quot;configurations&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;type&quot;</span>: <span class="string">&quot;node&quot;</span>,</span><br><span class="line">      <span class="string">&quot;request&quot;</span>: <span class="string">&quot;launch&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Launch Program&quot;</span>,</span><br><span class="line">      <span class="string">&quot;skipFiles&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;&lt;node_internals&gt;/**&quot;</span></span><br><span class="line">      ],</span><br><span class="line">      <span class="string">&quot;program&quot;</span>: <span class="string">&quot;$&#123;file&#125;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;preLaunchTask&quot;</span>: <span class="string">&quot;tsc: build - tsconfig.json&quot;</span><span class="comment">//⬅️</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="语法糖实现"><a href="#语法糖实现" class="headerlink" title="语法糖实现"></a>语法糖实现</h1><ul>
<li>原理：<strong>编译</strong> 或 <strong>转译</strong> ，可以通过一些工具，如 <strong>Babel</strong> 或 <strong>TypeScript</strong>，将这些语法糖转换成普通的 JavaScript 代码。</li>
<li>应用：class @decorator等</li>
<li>vue模版使用的模版编译器</li>
</ul>
<p>作用：将 Vue 模板（<code>.vue</code> 文件中的模板部分）转换成 <strong>JavaScript 渲染函数</strong></p>
<p>工作流程：</p>
<p>解析模板：将 HTML 模板解析成 抽象语法树（AST）。<br>生成渲染函数：基于 AST 生成渲染函数，这个函数负责创建虚拟 DOM。<br>渲染更新：在组件的生命周期中，渲染函数会根据数据的变化更新虚拟 DOM，并通过 Vue 的响应式系统来更新真实 DOM。</p>
<p>原理： <strong>Vue 3.x（默认使用 Vite 或 webpack 等现代构建工具）</strong></p>
<p> Vue 3 中，模板编译器是默认包含在开发环境中的 <strong><code>@vue/compiler-sfc</code></strong> 包（也就是 Vue 单文件组件 <code>.vue</code> 文件的编译器）。这个编译器会在构建过程中将 <code>.vue</code> 文件中的模板部分编译成渲染函数。</p>
<p><strong>Vue 3 的模板编译流程</strong>：</p>
<ol>
<li><strong>编译 <code>.vue</code> 文件</strong>：当你运行构建工具（如 Vite 或 webpack）时，构建工具会通过 <strong>Vue 插件</strong> 或 <strong>Vue loader</strong> 对 <code>.vue</code> 文件进行编译。这个过程会调用 <code>@vue/compiler-sfc</code> 包来解析模板、样式和脚本。</li>
<li><strong>生成渲染函数</strong>：编译器会将 <code>.vue</code> 文件中的 <code>&lt;template&gt;</code> 部分转换为 <strong>JavaScript 渲染函数</strong>，这些渲染函数会负责生成虚拟 DOM。</li>
<li><strong>输出最终代码</strong>：最终，构建工具会生成一个包含渲染函数的 JavaScript 文件，这个文件会在浏览器中执行，渲染出实际的页面内容。</li>
</ol>
<p><strong>开发模式</strong>：Vue 会通过模板编译器动态编译模板到渲染函数。这个编译过程通常是 <strong>即时进行的</strong>，即每次修改模板时，Vue 会重新编译模板并更新渲染结果。</p>
<p><strong>生产模式</strong>：Vue 使用 <strong>预编译</strong> 的方式。编译器在构建时会将所有模板编译成渲染函数，并将它们打包成最终的 JavaScript 文件。这样就不需要在生产环境中动态编译模板，提升性能。</p>
<h1 id="垃圾回收机制"><a href="#垃圾回收机制" class="headerlink" title="垃圾回收机制"></a>垃圾回收机制</h1><ul>
<li><p>不同语言：手动回收，如c++；自动回收，如python&#x2F;java，用垃圾回收器，容易内存泄漏。</p>
</li>
<li><p>垃圾回收三大算法：scavenge、标记清除&#x2F;压缩、引用计数</p>
<blockquote>
<p>引用计数：实时统计指向对象的引用数（指针数量）、引用数为 0 时实时回收对象。</p>
<p>缺点：循环引用时不会回收</p>
</blockquote>
</li>
<li><p>分代的依据：对象生存时间两极化现象，要么立刻回收、要么一直不回收</p>
</li>
<li><p>栈中垃圾回收：JavaScript 引擎是通过下移 ESP 来完成栈的垃圾回收</p>
</li>
</ul>
<p>ESP(Extended Stack Pointer): 扩展栈指针寄存器，用于存放函数栈顶指针。</p>
<p>JavaScript 在执行函数时，会将其上下文压入栈中，ESP 上移，而当函数执行完成后，其执行上下文可以销毁了，将 ESP下移到下一个函数执行上下文即可，当下一个函数入栈时，会将 ESP 以上的空间直接覆盖。</p>
<ul>
<li>堆中垃圾回收：分代式GC</li>
</ul>
<h1 id="JIT优化"><a href="#JIT优化" class="headerlink" title="JIT优化"></a>JIT优化</h1><ul>
<li>定义：just-in-time compilation，即时编译，本质是一边编译成机器码，一边执行这些机器码的技术，特别适用于动态解释型语言(javascript)；</li>
<li>原因：js 是一种动态类型语言，因此执行过程中引擎需要不断判断变量类型，确定是否允许执行相关操作，这个过程会非常耗时</li>
<li>工作流程：许多 js 引擎都支持 jit 优化，例如 v8。若推测代码执行次数较多且变量类型较固定时，则调用优化器优化这部分代码，缓存这部分机器码 + 跳过这部分类型判断逻辑，从而实现性能优化</li>
</ul>
<p>所以性能优化措施：减少变量类型变化、使用ts</p>
<ul>
<li>类型推导</li>
</ul>
<p>步骤：</p>
<ol>
<li><p>代码转译成 ast、调用Interpreter Ignition 的 <code>BytecodeGenerator</code> 将 ast 转译成字节码</p>
</li>
<li><p>执行字节码，过程中收集代码执行情况</p>
</li>
<li><p>命中优化策略后，调用 TurboFan，生成优化后的机器码</p>
</li>
<li><p>执行机器码</p>
</li>
</ol>
<blockquote>
<p>字节码：夹在高级语言与机器汇编指令之间的一层抽象，能够被用于实现移植复用，在高级语言如 java、c# 等都有类似设计</p>
</blockquote>

            </div>
        </div>
    </article>

    
    
<nav class="article-nav">
  
    <a href="/2025/07/28/Bootsrap/" id="article-nav-newer" class="article-nav-link-wrap prev">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Bootsrap
        
      </div>
    </a>
  
  
    <a href="/2025/07/09/%E3%80%90%E5%89%8D%E7%AB%AF%E3%80%91htmlcss%E5%A4%A7%E5%85%A8/" id="article-nav-older" class="article-nav-link-wrap next">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">HTML_CSS_Bootstrap_Emmet</div>
    </a>
  
</nav>

    

    
</div>
    </div>
    <footer class="site-footer">
        <div class="global-width">
            <ul class="site-widget">
                
                <li class="widget widget-tag">
                    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget-body">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/English/" rel="tag">English</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/basics/" rel="tag">basics</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/frontend/" rel="tag">frontend</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/projects/" rel="tag">projects</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tags/" rel="tag">tags</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/test/" rel="tag">test</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

                </li>
                
                <li class="widget widget-category">
                    
                </li>
                
                <li class="widget widget-recent_posts">
                    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget-body">
      <ul>
        
          <li>
            <a href="/2026/02/09/python%E5%A4%A7%E5%85%A8/">python大全</a>
          </li>
        
          <li>
            <a href="/2025/07/28/Bootsrap/">Bootsrap</a>
          </li>
        
          <li>
            <a href="/2025/07/20/%E3%80%90%E5%89%8D%E7%AB%AF%E3%80%91JS%E5%A4%A7%E5%85%A8/">JS一本通</a>
          </li>
        
          <li>
            <a href="/2025/07/09/%E3%80%90%E5%89%8D%E7%AB%AF%E3%80%91htmlcss%E5%A4%A7%E5%85%A8/">HTML_CSS_Bootstrap_Emmet</a>
          </li>
        
          <li>
            <a href="/2025/05/28/%E6%8F%92%E4%BB%B6test/">测试目录插件的文章</a>
          </li>
        
      </ul>
    </div>
  </div>

                </li>
                
            </ul>
        </div>
        <div class="site-info">
            <address>
                &copy; 2014 <a href="https://70v-yoyo.github.io">Yoyo&#39;s blog</a> All Right Reserved. <br/>
                Powered by <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a>. Theme by <a target="_blank" rel="noopener" href="http://zzoman.com">ZZOMAN</a>
                <p><a target="_blank" href="https://github.com/70v-Yoyo">My github</a></p>
            </address>
        </div>
    </footer> 
    
    
    <script src="/libs/jquery-1.11.3.min.js" type="text/javascript"></script>
    
    <script src="/libs/fancybox/jquery.fancybox.js" type="text/javascript"></script>
    
    <script src="/js/site_init.js" type="text/javascript"></script>
     
    <noscript>
        <style>
            article {
                position: absolute;
                width: 0;
                height: 0;
                overflow: hidden;
                opacity: 0;
            }

        </style>
        <h1>JS已被禁用</h1>
    </noscript>
<!-- hexo injector body_end start -->
    <script>
      (function() {
        function moveElementIfSmallScreen() {
          const toc = document.getElementById('fixed-toc-container');
          const article = document.querySelector("article");
          const toggleBtn = document.getElementById('toggle_btn');
          if (!toc || !article) return;
          if (window.innerWidth < 1024 && article.firstElementChild !== toc) {
            console.log('small screen!!')
            
            article.insertBefore(toc, article.firstChild);//移动节点，而非复制
            
            toggleBtn.style.display='none';
            // 替换样式：取消 fixed，设置适合正文的样式
            toc.style.position = 'relative';
            toc.style.top = '';
            toc.style.left = '';
            toc.style.width = '100%';
            toc.style.maxHeight = 'none';
            toc.style.overflowY = 'visible';
            toc.style.overflowX = 'visible';
            toc.style.padding = '1em';
            toc.style.borderLeft = 'none';
            toc.style.borderBottom = '1px solid #ddd';
            toc.style.background = '#f9f9f9';
            toc.style.opacity = '1';
            toc.style.zIndex = '9999';
            toc.style.boxShadow = 'none';
            toc.style.margin = '1rem';
            toc.style.paddingTop= '2rem';
          }
        }
        window.addEventListener("DOMContentLoaded", moveElementIfSmallScreen);
        window.addEventListener("resize", moveElementIfSmallScreen);
      })();
    </script>
  <!-- hexo injector body_end end -->
    <div id="fixed-toc-container" style="
      position: fixed;
      top: 0vh;
      left: 0px;
      width: 15rem;
      max-height: 80vh;
      overflow-y: auto;
      overflow-x: auto;
      padding: 10px;
      border-left: 2px solid #ccc;
      font-size: 14px;
      line-height: 1.5;
      background: #fff;
      opacity:0.8;
      z-index: 9999;
      box-shadow:
        0 2px 4px rgba(0, 0, 0, 0.05),  /* 第一层：近处柔和 */
        0 8px 16px rgba(0, 0, 0, 0.08); /* 第二层：远处扩散 */
    ">
      <strong>Contents</strong>
      <div id="toggle_btn" style="
      position:absolute;
      right:1rem;
      display:inline-block;
      width:2rem;
      text-align:center;
      border:1px solid #ccc;
      "><</div>
      <ul id="fixed-toc-list" style="list-style: none; padding-left: 10px;"></ul>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const nav = document.querySelector('nav');
        if (nav) {
          const navBottom = nav.getBoundingClientRect().bottom;//浏览器JS API
          console.log('nav bottom:', navBottom);
          // 设置toc元素 top = nav bottom
          const toc = document.querySelector('#fixed-toc-container');
          if (toc) {
            toc.style.top = navBottom + 'px';
            toc.style.maxHeight=window.innerHeight - navBottom.getBoundingClientRect().bottom;
          }
        }
      });

      const myDiv = document.getElementById('toggle_btn');
      var tocList=document.getElementById("fixed-toc-list");
      var tocContainer=document.getElementById("fixed-toc-container");
      function handleClickBtn() {
        console.log('Div 被点击了！');
        if(myDiv.textContent==='<'){
          myDiv.textContent ='>'
          tocList.style.display='none'
          tocContainer.style.width='11rem'
        }else{
          myDiv.textContent ='<'
          tocList.style.display='block'
          tocContainer.style.width='15rem'
        }
          
      }


      myDiv.addEventListener('click', handleClickBtn);// 绑定点击事件


      (function() {
      const Patternstr = "/*\\d{4}/\\d{2}/\\d{2}/.*"; //本身是字符串插入，所以对符号要转义
      //"^//*"->"/"
      //"/.*"->".*"
      //JS引擎中""转义
      //正则表达式引擎也是""转义
      const dataPattern = new RegExp(Patternstr);
      const path = window.location.pathname;
      console.log(dataPattern.toString(),path,dataPattern.test(path));//控制台在渲染时省略了反斜杠的可视表示。
      if (!dataPattern.test(path)&&(path==='/'||path==='index.html')) {
        console.log('no toc')
        let toc = document.getElementById('fixed-toc-container');
        if (toc) toc.style.display = 'none';
        return;
      }
        var content = document.querySelector('body');
        console.log('content',content)
        //var tocList = document.getElementById('fixed-toc-list');
        if (!content || !tocList) {
          document.getElementById('fixed-toc-container').style.display = 'none';
          return;
        }
        var headings = content.querySelectorAll('h1, h2, h3, h4');
        console.log('headings',headings)
        if(headings){
          const h1Element=headings[0];
          const rect = h1Element.getBoundingClientRect();
          if(rect.left<150){
           tocContainer.style.right='0px';
           tocContainer.style.left = 'auto'; // 移除内联的 left 样式
            //不是设置right:0 就替换left:0 需要移除
            console.log('to right')
          }
          console.log(rect.left,'150')
        }
        
        if (headings.length === 0) {
          document.getElementById('fixed-toc-container').style.display = 'none';
          return;
        }
        headings.forEach(function(heading, i) {
          if (!heading.id) {
            heading.id = 'heading-' + i;
          }
        });
        headings.forEach(function(heading) {
          var level = parseInt(heading.tagName.substring(1));
          var li = document.createElement('li');
          li.style.marginLeft = (level - 1) * 15 + 'px';
          var a = document.createElement('a');
          a.href = '#' + heading.id;
          a.textContent = heading.textContent;
          a.style.color = '#555';
          a.style.textDecoration = 'none';
          a.onmouseover = function() { a.style.textDecoration = 'underline'; };
          a.onmouseout = function() { a.style.textDecoration = 'none'; };
          li.appendChild(a);
          tocList.appendChild(li);
        });
      })();
    </script>
  </body>
</html>
